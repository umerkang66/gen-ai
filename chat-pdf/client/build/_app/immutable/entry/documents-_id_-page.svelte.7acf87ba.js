var tn=Object.defineProperty;var en=(it,c,H)=>c in it?tn(it,c,{enumerable:!0,configurable:!0,writable:!0,value:H}):it[c]=H;var Dt=(it,c,H)=>(en(it,typeof c!="symbol"?c+"":c,H),H),he=(it,c,H)=>{if(!c.has(it))throw TypeError("Cannot "+H)};var m=(it,c,H)=>(he(it,c,"read from private field"),H?H.call(it):c.get(it)),et=(it,c,H)=>{if(c.has(it))throw TypeError("Cannot add the same private member more than once");c instanceof WeakSet?c.add(it):c.set(it,H)},mt=(it,c,H,f)=>(he(it,c,"write to private field"),f?f.call(it,H):c.set(it,H),H),ie=(it,c,H,f)=>({set _(S){mt(it,c,S,H)},get _(){return m(it,c,f)}}),lt=(it,c,H)=>(he(it,c,"access private method"),H);import{S as SvelteComponent,i as init,s as safe_not_equal,k as element,l as claim_element,m as children,h as detach,n as attr,p as set_style,b as insert_hydration,E as append_hydration,C as noop,o as onMount,W as onDestroy,w as binding_callbacks,e as empty,d as transition_out,f as check_outros,g as transition_in,v as group_outros,q as text,a as space,y as create_component,r as claim_text,c as claim_space,z as claim_component,A as mount_component,B as destroy_component,u as set_data}from"../chunks/index.c91aa7e3.js";import{b as beforeNavigate}from"../chunks/navigation.09fff777.js";import{r as resetAll,s as sendMessage,C as ChatPanel}from"../chunks/ChatPanel.eb93501c.js";import{b as getAugmentedNamespace}from"../chunks/axios.3770fabd.js";import{B as Button}from"../chunks/Button.d243b02d.js";function commonjsRequire(it){throw new Error('Could not dynamically require "'+it+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(c,H){module.exports=H()})(globalThis,()=>(()=>{var __webpack_modules__=[,(it,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.VerbosityLevel=c.Util=c.UnknownErrorException=c.UnexpectedResponseException=c.TextRenderingMode=c.RenderingIntentFlag=c.PermissionFlag=c.PasswordResponses=c.PasswordException=c.PageActionEventType=c.OPS=c.MissingPDFException=c.MAX_IMAGE_SIZE_TO_CACHE=c.LINE_FACTOR=c.LINE_DESCENT_FACTOR=c.InvalidPDFException=c.ImageKind=c.IDENTITY_MATRIX=c.FormatError=c.FeatureTest=c.FONT_IDENTITY_MATRIX=c.DocumentActionEventType=c.CMapCompressionType=c.BaseException=c.BASELINE_FACTOR=c.AnnotationType=c.AnnotationStateModelType=c.AnnotationReviewState=c.AnnotationReplyType=c.AnnotationMode=c.AnnotationMarkedState=c.AnnotationFlag=c.AnnotationFieldFlag=c.AnnotationEditorType=c.AnnotationEditorPrefix=c.AnnotationEditorParamsType=c.AnnotationBorderStyleType=c.AnnotationActionEventType=c.AbortException=void 0,c.assert=yt,c.bytesToString=k,c.createPromiseCapability=Tt,c.createValidAbsoluteUrl=h,c.getModificationDate=At,c.getVerbosityLevel=ft,c.info=ot,c.isArrayBuffer=pt,c.isArrayEqual=Et,c.objectFromMap=x,c.objectSize=b,c.setVerbosityLevel=rt,c.shadow=d,c.string32=a,c.stringToBytes=e,c.stringToPDFString=ut,c.stringToUTF8String=ct,c.unreachable=bt,c.utf8StringToString=_t,c.warn=dt;const H=[1,0,0,1,0,0];c.IDENTITY_MATRIX=H;const f=[.001,0,0,.001,0,0];c.FONT_IDENTITY_MATRIX=f;const S=1e7;c.MAX_IMAGE_SIZE_TO_CACHE=S;const G=1.35;c.LINE_FACTOR=G;const V=.35;c.LINE_DESCENT_FACTOR=V;const Q=V/G;c.BASELINE_FACTOR=Q;const M={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};c.RenderingIntentFlag=M;const E={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};c.AnnotationMode=E;const _="pdfjs_internal_editor_";c.AnnotationEditorPrefix=_;const w={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};c.AnnotationEditorType=w;const C={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};c.AnnotationEditorParamsType=C;const A={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};c.PermissionFlag=A;const u={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};c.TextRenderingMode=u;const g={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};c.ImageKind=g;const n={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};c.AnnotationType=n;const i={MARKED:"Marked",REVIEW:"Review"};c.AnnotationStateModelType=i;const P={MARKED:"Marked",UNMARKED:"Unmarked"};c.AnnotationMarkedState=P;const F={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};c.AnnotationReviewState=F;const y={GROUP:"Group",REPLY:"R"};c.AnnotationReplyType=y;const t={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};c.AnnotationFlag=t;const o={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};c.AnnotationFieldFlag=o;const l={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};c.AnnotationBorderStyleType=l;const s={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};c.AnnotationActionEventType=s;const p={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};c.DocumentActionEventType=p;const T={O:"PageOpen",C:"PageClose"};c.PageActionEventType=T;const r={ERRORS:0,WARNINGS:1,INFOS:5};c.VerbosityLevel=r;const O={NONE:0,BINARY:1};c.CMapCompressionType=O;const X={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};c.OPS=X;const Y={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};c.PasswordResponses=Y;let Z=r.WARNINGS;function rt(R){Number.isInteger(R)&&(Z=R)}function ft(){return Z}function ot(R){Z>=r.INFOS&&console.log(`Info: ${R}`)}function dt(R){Z>=r.WARNINGS&&console.log(`Warning: ${R}`)}function bt(R){throw new Error(R)}function yt(R,U){R||bt(U)}function B(R){if(!R)return!1;switch(R.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function h(R,U=null,W=null){if(!R)return null;try{if(W&&typeof R=="string"){if(W.addDefaultProtocol&&R.startsWith("www.")){const Ct=R.match(/\./g);Ct&&Ct.length>=2&&(R=`http://${R}`)}if(W.tryConvertEncoding)try{R=ct(R)}catch{}}const gt=U?new URL(R,U):new URL(R);if(B(gt))return gt}catch{}return null}function d(R,U,W,gt=!1){return Object.defineProperty(R,U,{value:W,enumerable:!gt,configurable:!0,writable:!1}),W}const v=function(){function U(W,gt){this.constructor===U&&bt("Cannot initialize BaseException."),this.message=W,this.name=gt}return U.prototype=new Error,U.constructor=U,U}();c.BaseException=v;class j extends v{constructor(U,W){super(U,"PasswordException"),this.code=W}}c.PasswordException=j;class D extends v{constructor(U,W){super(U,"UnknownErrorException"),this.details=W}}c.UnknownErrorException=D;class $ extends v{constructor(U){super(U,"InvalidPDFException")}}c.InvalidPDFException=$;class q extends v{constructor(U){super(U,"MissingPDFException")}}c.MissingPDFException=q;class K extends v{constructor(U,W){super(U,"UnexpectedResponseException"),this.status=W}}c.UnexpectedResponseException=K;class z extends v{constructor(U){super(U,"FormatError")}}c.FormatError=z;class L extends v{constructor(U){super(U,"AbortException")}}c.AbortException=L;function k(R){(typeof R!="object"||R===null||R.length===void 0)&&bt("Invalid argument for bytesToString");const U=R.length,W=8192;if(U<W)return String.fromCharCode.apply(null,R);const gt=[];for(let Ct=0;Ct<U;Ct+=W){const J=Math.min(Ct+W,U),ht=R.subarray(Ct,J);gt.push(String.fromCharCode.apply(null,ht))}return gt.join("")}function e(R){typeof R!="string"&&bt("Invalid argument for stringToBytes");const U=R.length,W=new Uint8Array(U);for(let gt=0;gt<U;++gt)W[gt]=R.charCodeAt(gt)&255;return W}function a(R){return String.fromCharCode(R>>24&255,R>>16&255,R>>8&255,R&255)}function b(R){return Object.keys(R).length}function x(R){const U=Object.create(null);for(const[W,gt]of R)U[W]=gt;return U}function I(){const R=new Uint8Array(4);return R[0]=1,new Uint32Array(R.buffer,0,1)[0]===1}function N(){try{return new Function(""),!0}catch{return!1}}class nt{static get isLittleEndian(){return d(this,"isLittleEndian",I())}static get isEvalSupported(){return d(this,"isEvalSupported",N())}static get isOffscreenCanvasSupported(){return d(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?d(this,"platform",{isWin:!1,isMac:!1}):d(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}c.FeatureTest=nt;const tt=[...Array(256).keys()].map(R=>R.toString(16).padStart(2,"0"));class st{static makeHexColor(U,W,gt){return`#${tt[U]}${tt[W]}${tt[gt]}`}static scaleMinMax(U,W){let gt;U[0]?(U[0]<0&&(gt=W[0],W[0]=W[1],W[1]=gt),W[0]*=U[0],W[1]*=U[0],U[3]<0&&(gt=W[2],W[2]=W[3],W[3]=gt),W[2]*=U[3],W[3]*=U[3]):(gt=W[0],W[0]=W[2],W[2]=gt,gt=W[1],W[1]=W[3],W[3]=gt,U[1]<0&&(gt=W[2],W[2]=W[3],W[3]=gt),W[2]*=U[1],W[3]*=U[1],U[2]<0&&(gt=W[0],W[0]=W[1],W[1]=gt),W[0]*=U[2],W[1]*=U[2]),W[0]+=U[4],W[1]+=U[4],W[2]+=U[5],W[3]+=U[5]}static transform(U,W){return[U[0]*W[0]+U[2]*W[1],U[1]*W[0]+U[3]*W[1],U[0]*W[2]+U[2]*W[3],U[1]*W[2]+U[3]*W[3],U[0]*W[4]+U[2]*W[5]+U[4],U[1]*W[4]+U[3]*W[5]+U[5]]}static applyTransform(U,W){const gt=U[0]*W[0]+U[1]*W[2]+W[4],Ct=U[0]*W[1]+U[1]*W[3]+W[5];return[gt,Ct]}static applyInverseTransform(U,W){const gt=W[0]*W[3]-W[1]*W[2],Ct=(U[0]*W[3]-U[1]*W[2]+W[2]*W[5]-W[4]*W[3])/gt,J=(-U[0]*W[1]+U[1]*W[0]+W[4]*W[1]-W[5]*W[0])/gt;return[Ct,J]}static getAxialAlignedBoundingBox(U,W){const gt=st.applyTransform(U,W),Ct=st.applyTransform(U.slice(2,4),W),J=st.applyTransform([U[0],U[3]],W),ht=st.applyTransform([U[2],U[1]],W);return[Math.min(gt[0],Ct[0],J[0],ht[0]),Math.min(gt[1],Ct[1],J[1],ht[1]),Math.max(gt[0],Ct[0],J[0],ht[0]),Math.max(gt[1],Ct[1],J[1],ht[1])]}static inverseTransform(U){const W=U[0]*U[3]-U[1]*U[2];return[U[3]/W,-U[1]/W,-U[2]/W,U[0]/W,(U[2]*U[5]-U[4]*U[3])/W,(U[4]*U[1]-U[5]*U[0])/W]}static singularValueDecompose2dScale(U){const W=[U[0],U[2],U[1],U[3]],gt=U[0]*W[0]+U[1]*W[2],Ct=U[0]*W[1]+U[1]*W[3],J=U[2]*W[0]+U[3]*W[2],ht=U[2]*W[1]+U[3]*W[3],vt=(gt+ht)/2,St=Math.sqrt((gt+ht)**2-4*(gt*ht-J*Ct))/2,kt=vt+St||1,Ft=vt-St||1;return[Math.sqrt(kt),Math.sqrt(Ft)]}static normalizeRect(U){const W=U.slice(0);return U[0]>U[2]&&(W[0]=U[2],W[2]=U[0]),U[1]>U[3]&&(W[1]=U[3],W[3]=U[1]),W}static intersect(U,W){const gt=Math.max(Math.min(U[0],U[2]),Math.min(W[0],W[2])),Ct=Math.min(Math.max(U[0],U[2]),Math.max(W[0],W[2]));if(gt>Ct)return null;const J=Math.max(Math.min(U[1],U[3]),Math.min(W[1],W[3])),ht=Math.min(Math.max(U[1],U[3]),Math.max(W[1],W[3]));return J>ht?null:[gt,J,Ct,ht]}static bezierBoundingBox(U,W,gt,Ct,J,ht,vt,St){const kt=[],Ft=[[],[]];let wt,Pt,Rt,xt,Nt,Mt,Ot,Lt;for(let Ht=0;Ht<2;++Ht){if(Ht===0?(Pt=6*U-12*gt+6*J,wt=-3*U+9*gt-9*J+3*vt,Rt=3*gt-3*U):(Pt=6*W-12*Ct+6*ht,wt=-3*W+9*Ct-9*ht+3*St,Rt=3*Ct-3*W),Math.abs(wt)<1e-12){if(Math.abs(Pt)<1e-12)continue;xt=-Rt/Pt,0<xt&&xt<1&&kt.push(xt);continue}Ot=Pt*Pt-4*Rt*wt,Lt=Math.sqrt(Ot),!(Ot<0)&&(Nt=(-Pt+Lt)/(2*wt),0<Nt&&Nt<1&&kt.push(Nt),Mt=(-Pt-Lt)/(2*wt),0<Mt&&Mt<1&&kt.push(Mt))}let jt=kt.length,It;const Bt=jt;for(;jt--;)xt=kt[jt],It=1-xt,Ft[0][jt]=It*It*It*U+3*It*It*xt*gt+3*It*xt*xt*J+xt*xt*xt*vt,Ft[1][jt]=It*It*It*W+3*It*It*xt*Ct+3*It*xt*xt*ht+xt*xt*xt*St;return Ft[0][Bt]=U,Ft[1][Bt]=W,Ft[0][Bt+1]=vt,Ft[1][Bt+1]=St,Ft[0].length=Ft[1].length=Bt+2,[Math.min(...Ft[0]),Math.min(...Ft[1]),Math.max(...Ft[0]),Math.max(...Ft[1])]}}c.Util=st;const at=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function ut(R){if(R[0]>="ï"){let W;if(R[0]==="þ"&&R[1]==="ÿ"?W="utf-16be":R[0]==="ÿ"&&R[1]==="þ"?W="utf-16le":R[0]==="ï"&&R[1]==="»"&&R[2]==="¿"&&(W="utf-8"),W)try{const gt=new TextDecoder(W,{fatal:!0}),Ct=e(R);return gt.decode(Ct)}catch(gt){dt(`stringToPDFString: "${gt}".`)}}const U=[];for(let W=0,gt=R.length;W<gt;W++){const Ct=at[R.charCodeAt(W)];U.push(Ct?String.fromCharCode(Ct):R.charAt(W))}return U.join("")}function ct(R){return decodeURIComponent(escape(R))}function _t(R){return unescape(encodeURIComponent(R))}function pt(R){return typeof R=="object"&&R!==null&&R.byteLength!==void 0}function Et(R,U){if(R.length!==U.length)return!1;for(let W=0,gt=R.length;W<gt;W++)if(R[W]!==U[W])return!1;return!0}function At(R=new Date){return[R.getUTCFullYear().toString(),(R.getUTCMonth()+1).toString().padStart(2,"0"),R.getUTCDate().toString().padStart(2,"0"),R.getUTCHours().toString().padStart(2,"0"),R.getUTCMinutes().toString().padStart(2,"0"),R.getUTCSeconds().toString().padStart(2,"0")].join("")}function Tt(){const R=Object.create(null);let U=!1;return Object.defineProperty(R,"settled",{get(){return U}}),R.promise=new Promise(function(W,gt){R.resolve=function(Ct){U=!0,W(Ct)},R.reject=function(Ct){U=!0,gt(Ct)}}),R}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var it,H,f,S,Xt,V,re,M,E,_,w,C,A,u,g,de,i,P,ue,y,t;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultFilterFactory=_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:l,NodeCMapReaderFactory:s,NodeFilterFactory:p,NodeStandardFontDataFactory:T}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=l,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=s,exports.DefaultFilterFactory=DefaultFilterFactory=p,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=T}let createPDFNetworkStream;if(_is_node.isNodeJS){const{PDFNodeStream:l}=__w_pdfjs_require__(21);createPDFNetworkStream=s=>new l(s)}else{const{PDFNetworkStream:l}=__w_pdfjs_require__(24),{PDFFetchStream:s}=__w_pdfjs_require__(25);createPDFNetworkStream=p=>(0,_display_utils.isValidFetchUrl)(p.url)?new s(p):new l(p)}function getDocument(l){if(typeof l=="string"||l instanceof URL?l={url:l}:(0,_util.isArrayBuffer)(l)&&(l={data:l}),typeof l!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!l.url&&!l.data&&!l.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const s=new PDFDocumentLoadingTask,{docId:p}=s,T=l.url?getUrlProp(l.url):null,r=l.data?getDataProp(l.data):null,O=l.httpHeaders||null,X=l.withCredentials===!0,Y=l.password??null,Z=l.range instanceof PDFDataRangeTransport?l.range:null,rt=Number.isInteger(l.rangeChunkSize)&&l.rangeChunkSize>0?l.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let ft=l.worker instanceof PDFWorker?l.worker:null;const ot=l.verbosity,dt=typeof l.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(l.docBaseUrl)?l.docBaseUrl:null,bt=typeof l.cMapUrl=="string"?l.cMapUrl:null,yt=l.cMapPacked!==!1,B=l.CMapReaderFactory||DefaultCMapReaderFactory,h=typeof l.standardFontDataUrl=="string"?l.standardFontDataUrl:null,d=l.StandardFontDataFactory||DefaultStandardFontDataFactory,v=l.stopAtErrors!==!0,j=Number.isInteger(l.maxImageSize)&&l.maxImageSize>-1?l.maxImageSize:-1,D=l.isEvalSupported!==!1,$=typeof l.isOffscreenCanvasSupported=="boolean"?l.isOffscreenCanvasSupported:!_is_node.isNodeJS,q=Number.isInteger(l.canvasMaxAreaInBytes)?l.canvasMaxAreaInBytes:-1,K=typeof l.disableFontFace=="boolean"?l.disableFontFace:_is_node.isNodeJS,z=l.fontExtraProperties===!0,L=l.enableXfa===!0,k=l.ownerDocument||globalThis.document,e=l.disableRange===!0,a=l.disableStream===!0,b=l.disableAutoFetch===!0,x=l.pdfBug===!0,I=Z?Z.length:l.length??NaN,N=typeof l.useSystemFonts=="boolean"?l.useSystemFonts:!_is_node.isNodeJS&&!K,nt=typeof l.useWorkerFetch=="boolean"?l.useWorkerFetch:B===_display_utils.DOMCMapReaderFactory&&d===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(bt,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(h,document.baseURI),tt=l.canvasFactory||new DefaultCanvasFactory({ownerDocument:k}),st=l.filterFactory||new DefaultFilterFactory({docId:p,ownerDocument:k}),at=null;(0,_util.setVerbosityLevel)(ot);const ut={canvasFactory:tt,filterFactory:st};if(nt||(ut.cMapReaderFactory=new B({baseUrl:bt,isCompressed:yt}),ut.standardFontDataFactory=new d({baseUrl:h})),!ft){const pt={verbosity:ot,port:_worker_options.GlobalWorkerOptions.workerPort};ft=pt.port?PDFWorker.fromPort(pt):new PDFWorker(pt),s._worker=ft}const ct={docId:p,apiVersion:"3.5.141",data:r,password:Y,disableAutoFetch:b,rangeChunkSize:rt,length:I,docBaseUrl:dt,enableXfa:L,evaluatorOptions:{maxImageSize:j,disableFontFace:K,ignoreErrors:v,isEvalSupported:D,isOffscreenCanvasSupported:$,canvasMaxAreaInBytes:q,fontExtraProperties:z,useSystemFonts:N,cMapUrl:nt?bt:null,standardFontDataUrl:nt?h:null}},_t={ignoreErrors:v,isEvalSupported:D,disableFontFace:K,fontExtraProperties:z,enableXfa:L,ownerDocument:k,disableAutoFetch:b,pdfBug:x,styleElement:at};return ft.promise.then(function(){if(s.destroyed)throw new Error("Loading aborted");const pt=_fetchDocument(ft,ct),Et=new Promise(function(At){let Tt;Z?Tt=new _transport_stream.PDFDataTransportStream({length:I,initialData:Z.initialData,progressiveDone:Z.progressiveDone,contentDispositionFilename:Z.contentDispositionFilename,disableRange:e,disableStream:a},Z):r||(Tt=createPDFNetworkStream({url:T,length:I,httpHeaders:O,withCredentials:X,rangeChunkSize:rt,disableRange:e,disableStream:a})),At(Tt)});return Promise.all([pt,Et]).then(function([At,Tt]){if(s.destroyed)throw new Error("Loading aborted");const R=new _message_handler.MessageHandler(p,At,ft.port),U=new WorkerTransport(R,s,Tt,_t,ut);s._transport=U,R.send("Ready",null)})}).catch(s._capability.reject),s}async function _fetchDocument(l,s){if(l.destroyed)throw new Error("Worker was destroyed");const p=await l.messageHandler.sendWithPromise("GetDocRequest",s,s.data?[s.data.buffer]:null);if(l.destroyed)throw new Error("Worker was destroyed");return p}function getUrlProp(l){if(l instanceof URL)return l.href;try{return new URL(l,window.location).href}catch{if(_is_node.isNodeJS&&typeof l=="string")return l}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(l){if(_is_node.isNodeJS&&typeof Buffer<"u"&&l instanceof Buffer)return(0,_display_utils.deprecated)("Please provide binary data as `Uint8Array`, rather than `Buffer`."),new Uint8Array(l);if(l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength)return l;if(typeof l=="string")return(0,_util.stringToBytes)(l);if(typeof l=="object"&&!isNaN(l==null?void 0:l.length)||(0,_util.isArrayBuffer)(l))return new Uint8Array(l);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const c=class{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${ie(c,it)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var s;this.destroyed=!0,await((s=this._transport)==null?void 0:s.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=c;it=new WeakMap,et(PDFDocumentLoadingTask,it,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(s,p,T=!1,r=null){this.length=s,this.initialData=p,this.progressiveDone=T,this.contentDispositionFilename=r,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(s){this._rangeListeners.push(s)}addProgressListener(s){this._progressListeners.push(s)}addProgressiveReadListener(s){this._progressiveReadListeners.push(s)}addProgressiveDoneListener(s){this._progressiveDoneListeners.push(s)}onDataRange(s,p){for(const T of this._rangeListeners)T(s,p)}onDataProgress(s,p){this._readyCapability.promise.then(()=>{for(const T of this._progressListeners)T(s,p)})}onDataProgressiveRead(s){this._readyCapability.promise.then(()=>{for(const p of this._progressiveReadListeners)p(s)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const s of this._progressiveDoneListeners)s()})}transportReady(){this._readyCapability.resolve()}requestDataRange(s,p){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(s,p){this._pdfInfo=s,this._transport=p}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(s){return this._transport.getPage(s)}getPageIndex(s){return this._transport.getPageIndex(s)}getDestinations(){return this._transport.getDestinations()}getDestination(s){return this._transport.getDestination(s)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(s=!1){return this._transport.startCleanup(s||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(s,p,T,r=!1){et(this,S);et(this,V);et(this,H,null);et(this,f,!1);this._pageIndex=s,this._pageInfo=p,this._transport=T,this._stats=r?new _display_utils.StatTimer:null,this._pdfBug=r,this.commonObjs=T.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:s,rotation:p=this.rotate,offsetX:T=0,offsetY:r=0,dontFlip:O=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:s,rotation:p,offsetX:T,offsetY:r,dontFlip:O})}getAnnotations({intent:s="display"}={}){const p=this._transport.getRenderingIntent(s);return this._transport.getAnnotations(this._pageIndex,p.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var s;return((s=this._transport._htmlForXfa)==null?void 0:s.children[this._pageIndex])||null}render({canvasContext:s,viewport:p,intent:T="display",annotationMode:r=_util.AnnotationMode.ENABLE,transform:O=null,background:X=null,optionalContentConfigPromise:Y=null,annotationCanvasMap:Z=null,pageColors:rt=null,printAnnotationStorage:ft=null}){var d,v,j;if((d=arguments[0])!=null&&d.canvasFactory)throw new Error("render no longer accepts the `canvasFactory`-option, please pass it to the `getDocument`-function instead.");(v=this._stats)==null||v.time("Overall");const ot=this._transport.getRenderingIntent(T,r,ft);mt(this,f,!1),lt(this,V,re).call(this),Y||(Y=this._transport.getOptionalContentConfig());let dt=this._intentStates.get(ot.cacheKey);dt||(dt=Object.create(null),this._intentStates.set(ot.cacheKey,dt)),dt.streamReaderCancelTimeout&&(clearTimeout(dt.streamReaderCancelTimeout),dt.streamReaderCancelTimeout=null);const bt=!!(ot.renderingIntent&_util.RenderingIntentFlag.PRINT);dt.displayReadyCapability||(dt.displayReadyCapability=(0,_util.createPromiseCapability)(),dt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(j=this._stats)==null||j.time("Page Request"),this._pumpOperatorList(ot));const yt=D=>{var $,q;dt.renderTasks.delete(B),(this._maybeCleanupAfterRender||bt)&&mt(this,f,!0),lt(this,S,Xt).call(this,!bt),D?(B.capability.reject(D),this._abortOperatorList({intentState:dt,reason:D instanceof Error?D:new Error(D)})):B.capability.resolve(),($=this._stats)==null||$.timeEnd("Rendering"),(q=this._stats)==null||q.timeEnd("Overall")},B=new InternalRenderTask({callback:yt,params:{canvasContext:s,viewport:p,transform:O,background:X},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:Z,operatorList:dt.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!bt,pdfBug:this._pdfBug,pageColors:rt});(dt.renderTasks||(dt.renderTasks=new Set)).add(B);const h=B.task;return Promise.all([dt.displayReadyCapability.promise,Y]).then(([D,$])=>{var q;if(m(this,f)){yt();return}(q=this._stats)==null||q.time("Rendering"),B.initializeGraphics({transparency:D,optionalContentConfig:$}),B.operatorListChanged()}).catch(yt),h}getOperatorList({intent:s="display",annotationMode:p=_util.AnnotationMode.ENABLE,printAnnotationStorage:T=null}={}){var Z;function r(){X.operatorList.lastChunk&&(X.opListReadCapability.resolve(X.operatorList),X.renderTasks.delete(Y))}const O=this._transport.getRenderingIntent(s,p,T,!0);let X=this._intentStates.get(O.cacheKey);X||(X=Object.create(null),this._intentStates.set(O.cacheKey,X));let Y;return X.opListReadCapability||(Y=Object.create(null),Y.operatorListChanged=r,X.opListReadCapability=(0,_util.createPromiseCapability)(),(X.renderTasks||(X.renderTasks=new Set)).add(Y),X.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Z=this._stats)==null||Z.time("Page Request"),this._pumpOperatorList(O)),X.opListReadCapability.promise}streamTextContent({includeMarkedContent:s=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:s===!0},{highWaterMark:100,size(T){return T.items.length}})}getTextContent(s={}){if(this._transport._htmlForXfa)return this.getXfa().then(T=>_xfa_text.XfaText.textContent(T));const p=this.streamTextContent(s);return new Promise(function(T,r){function O(){X.read().then(function({value:Z,done:rt}){if(rt){T(Y);return}Object.assign(Y.styles,Z.styles),Y.items.push(...Z.items),O()},r)}const X=p.getReader(),Y={items:[],styles:Object.create(null)};O()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const s=[];for(const p of this._intentStates.values())if(this._abortOperatorList({intentState:p,reason:new Error("Page was destroyed."),force:!0}),!p.opListReadCapability)for(const T of p.renderTasks)s.push(T.completed),T.cancel();return this.objs.clear(),mt(this,f,!1),lt(this,V,re).call(this),Promise.all(s)}cleanup(s=!1){mt(this,f,!0);const p=lt(this,S,Xt).call(this,!1);return s&&p&&this._stats&&(this._stats=new _display_utils.StatTimer),p}_startRenderPage(s,p){var r,O;const T=this._intentStates.get(p);T&&((r=this._stats)==null||r.timeEnd("Page Request"),(O=T.displayReadyCapability)==null||O.resolve(s))}_renderPageChunk(s,p){for(let T=0,r=s.length;T<r;T++)p.operatorList.fnArray.push(s.fnArray[T]),p.operatorList.argsArray.push(s.argsArray[T]);p.operatorList.lastChunk=s.lastChunk,p.operatorList.separateAnnots=s.separateAnnots;for(const T of p.renderTasks)T.operatorListChanged();s.lastChunk&&lt(this,S,Xt).call(this,!0)}_pumpOperatorList({renderingIntent:s,cacheKey:p,annotationStorageMap:T}){const O=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:s,cacheKey:p,annotationStorage:T}).getReader(),X=this._intentStates.get(p);X.streamReader=O;const Y=()=>{O.read().then(({value:Z,done:rt})=>{if(rt){X.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(Z,X),Y())},Z=>{if(X.streamReader=null,!this._transport.destroyed){if(X.operatorList){X.operatorList.lastChunk=!0;for(const rt of X.renderTasks)rt.operatorListChanged();lt(this,S,Xt).call(this,!0)}if(X.displayReadyCapability)X.displayReadyCapability.reject(Z);else if(X.opListReadCapability)X.opListReadCapability.reject(Z);else throw Z}})};Y()}_abortOperatorList({intentState:s,reason:p,force:T=!1}){if(s.streamReader){if(s.streamReaderCancelTimeout&&(clearTimeout(s.streamReaderCancelTimeout),s.streamReaderCancelTimeout=null),!T){if(s.renderTasks.size>0)return;if(p instanceof _display_utils.RenderingCancelledException){let r=RENDERING_CANCELLED_TIMEOUT;p.extraDelay>0&&p.extraDelay<1e3&&(r+=p.extraDelay),s.streamReaderCancelTimeout=setTimeout(()=>{s.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:s,reason:p,force:!0})},r);return}}if(s.streamReader.cancel(new _util.AbortException(p.message)).catch(()=>{}),s.streamReader=null,!this._transport.destroyed){for(const[r,O]of this._intentStates)if(O===s){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}H=new WeakMap,f=new WeakMap,S=new WeakSet,Xt=function(s=!1){if(lt(this,V,re).call(this),!m(this,f))return!1;if(s)return mt(this,H,setTimeout(()=>{mt(this,H,null),lt(this,S,Xt).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:p,operatorList:T}of this._intentStates.values())if(p.size>0||!T.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),mt(this,f,!1),!0},V=new WeakSet,re=function(){m(this,H)&&(clearTimeout(m(this,H)),mt(this,H,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){et(this,M,new Set);et(this,E,Promise.resolve())}postMessage(s,p){const T={data:structuredClone(s,p?{transfer:p}:null)};m(this,E).then(()=>{for(const r of m(this,M))r.call(this,T)})}addEventListener(s,p){m(this,M).add(p)}removeEventListener(s,p){m(this,M).delete(p)}terminate(){m(this,M).clear()}}M=new WeakMap,E=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const l=(_=document==null?void 0:document.currentScript)==null?void 0:_.src;l&&(PDFWorkerUtil.fallbackWorkerSrc=l.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(l,s){let p;try{if(p=new URL(l),!p.origin||p.origin==="null")return!1}catch{return!1}const T=new URL(s,p);return p.origin===T.origin},PDFWorkerUtil.createCDNWrapper=function(l){const s=`importScripts("${l}");`;return URL.createObjectURL(new Blob([s]))}}const _PDFWorker=class{constructor({name:l=null,port:s=null,verbosity:p=(0,_util.getVerbosityLevel)()}={}){if(s&&m(_PDFWorker,w).has(s))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=l,this.destroyed=!1,this.verbosity=p,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,s){m(_PDFWorker,w).set(s,this),this._initializeFromPort(s);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(l){this._port=l,this._messageHandler=new _message_handler.MessageHandler("main","worker",l),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:l}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,l)||(l=PDFWorkerUtil.createCDNWrapper(new URL(l,window.location).href));const s=new Worker(l),p=new _message_handler.MessageHandler("main","worker",s),T=()=>{s.removeEventListener("error",r),p.destroy(),s.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=()=>{this._webWorker||T()};s.addEventListener("error",r),p.on("test",X=>{if(s.removeEventListener("error",r),this.destroyed){T();return}X?(this._messageHandler=p,this._port=s,this._webWorker=s,this._readyCapability.resolve(),p.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),p.destroy(),s.terminate())}),p.on("ready",X=>{if(s.removeEventListener("error",r),this.destroyed){T();return}try{O()}catch{this._setupFakeWorker()}});const O=()=>{const X=new Uint8Array;p.send("test",X,[X.buffer])};O();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(l=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const s=new LoopbackPort;this._port=s;const p=`fake${PDFWorkerUtil.fakeWorkerId++}`,T=new _message_handler.MessageHandler(p+"_worker",p,s);l.setup(T,s);const r=new _message_handler.MessageHandler(p,p+"_worker",s);this._messageHandler=r,this._readyCapability.resolve(),r.send("configure",{verbosity:this.verbosity})}).catch(l=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${l.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),m(_PDFWorker,w).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(l){if(!(l!=null&&l.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return m(this,w).has(l.port)?m(this,w).get(l.port):new _PDFWorker(l)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var l;try{return((l=globalThis.pdfjsWorker)==null?void 0:l.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;w=new WeakMap,et(PDFWorker,w,new WeakMap),exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(s,p,T,r,O){et(this,g);et(this,C,new Map);et(this,A,new Map);et(this,u,new Map);this.messageHandler=s,this.loadingTask=p,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this._params=r,this.canvasFactory=O.canvasFactory,this.filterFactory=O.filterFactory,this.cMapReaderFactory=O.cMapReaderFactory,this.standardFontDataFactory=O.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=T,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(s,p=_util.AnnotationMode.ENABLE,T=null,r=!1){let O=_util.RenderingIntentFlag.DISPLAY,X=null;switch(s){case"any":O=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":O=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${s}`)}switch(p){case _util.AnnotationMode.DISABLE:O+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:O+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:O+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,X=(O&_util.RenderingIntentFlag.PRINT&&T instanceof _annotation_storage.PrintAnnotationStorage?T:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${p}`)}return r&&(O+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:O,cacheKey:`${O}_${_annotation_storage.AnnotationStorage.getHash(X)}`,annotationStorageMap:X}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const s=[];for(const T of m(this,A).values())s.push(T._destroy());m(this,A).clear(),m(this,u).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const p=this.messageHandler.sendWithPromise("Terminate",null);return s.push(p),Promise.all(s).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),m(this,C).clear(),this.filterFactory.destroy(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:s,loadingTask:p}=this;s.on("GetReader",(T,r)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=O=>{this._lastProgress={loaded:O.loaded,total:O.total}},r.onPull=()=>{this._fullReader.read().then(function({value:O,done:X}){if(X){r.close();return}(0,_util.assert)(O instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(O),1,[O])}).catch(O=>{r.error(O)})},r.onCancel=O=>{this._fullReader.cancel(O),r.ready.catch(X=>{if(!this.destroyed)throw X})}}),s.on("ReaderHeadersReady",T=>{const r=(0,_util.createPromiseCapability)(),O=this._fullReader;return O.headersReady.then(()=>{var X;(!O.isStreamingSupported||!O.isRangeSupported)&&(this._lastProgress&&((X=p.onProgress)==null||X.call(p,this._lastProgress)),O.onProgress=Y=>{var Z;(Z=p.onProgress)==null||Z.call(p,{loaded:Y.loaded,total:Y.total})}),r.resolve({isStreamingSupported:O.isStreamingSupported,isRangeSupported:O.isRangeSupported,contentLength:O.contentLength})},r.reject),r.promise}),s.on("GetRangeReader",(T,r)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const O=this._networkStream.getRangeReader(T.begin,T.end);if(!O){r.close();return}r.onPull=()=>{O.read().then(function({value:X,done:Y}){if(Y){r.close();return}(0,_util.assert)(X instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(X),1,[X])}).catch(X=>{r.error(X)})},r.onCancel=X=>{O.cancel(X),r.ready.catch(Y=>{if(!this.destroyed)throw Y})}}),s.on("GetDoc",({pdfInfo:T})=>{this._numPages=T.numPages,this._htmlForXfa=T.htmlForXfa,delete T.htmlForXfa,p._capability.resolve(new PDFDocumentProxy(T,this))}),s.on("DocException",function(T){let r;switch(T.name){case"PasswordException":r=new _util.PasswordException(T.message,T.code);break;case"InvalidPDFException":r=new _util.InvalidPDFException(T.message);break;case"MissingPDFException":r=new _util.MissingPDFException(T.message);break;case"UnexpectedResponseException":r=new _util.UnexpectedResponseException(T.message,T.status);break;case"UnknownErrorException":r=new _util.UnknownErrorException(T.message,T.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}p._capability.reject(r)}),s.on("PasswordRequest",T=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),p.onPassword){const r=O=>{O instanceof Error?this._passwordCapability.reject(O):this._passwordCapability.resolve({password:O})};try{p.onPassword(r,T.code)}catch(O){this._passwordCapability.reject(O)}}else this._passwordCapability.reject(new _util.PasswordException(T.message,T.code));return this._passwordCapability.promise}),s.on("DataLoaded",T=>{var r;(r=p.onProgress)==null||r.call(p,{loaded:T.length,total:T.length}),this.downloadInfoCapability.resolve(T)}),s.on("StartRenderPage",T=>{if(this.destroyed)return;m(this,A).get(T.pageIndex)._startRenderPage(T.transparency,T.cacheKey)}),s.on("commonobj",([T,r,O])=>{var X;if(!this.destroyed&&!this.commonObjs.has(T))switch(r){case"Font":const Y=this._params;if("error"in O){const ft=O.error;(0,_util.warn)(`Error during font loading: ${ft}`),this.commonObjs.resolve(T,ft);break}const Z=Y.pdfBug&&((X=globalThis.FontInspector)!=null&&X.enabled)?(ft,ot)=>globalThis.FontInspector.fontAdded(ft,ot):null,rt=new _font_loader.FontFaceObject(O,{isEvalSupported:Y.isEvalSupported,disableFontFace:Y.disableFontFace,ignoreErrors:Y.ignoreErrors,inspectFont:Z});this.fontLoader.bind(rt).catch(ft=>s.sendWithPromise("FontFallback",{id:T})).finally(()=>{!Y.fontExtraProperties&&rt.data&&(rt.data=null),this.commonObjs.resolve(T,rt)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(T,O);break;default:throw new Error(`Got unknown common object type ${r}`)}}),s.on("obj",([T,r,O,X])=>{var Z;if(this.destroyed)return;const Y=m(this,A).get(r);if(!Y.objs.has(T))switch(O){case"Image":if(Y.objs.resolve(T,X),X){let rt;if(X.bitmap){const{width:ft,height:ot}=X;rt=ft*ot*4}else rt=((Z=X.data)==null?void 0:Z.length)||0;rt>_util.MAX_IMAGE_SIZE_TO_CACHE&&(Y._maybeCleanupAfterRender=!0)}break;case"Pattern":Y.objs.resolve(T,X);break;default:throw new Error(`Got unknown object type ${O}`)}}),s.on("DocProgress",T=>{var r;this.destroyed||(r=p.onProgress)==null||r.call(p,{loaded:T.loaded,total:T.total})}),s.on("FetchBuiltInCMap",T=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(T):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),s.on("FetchStandardFontData",T=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(T):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((s=this._fullReader)==null?void 0:s.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(s){if(!Number.isInteger(s)||s<=0||s>this._numPages)return Promise.reject(new Error("Invalid page request."));const p=s-1,T=m(this,u).get(p);if(T)return T;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:p}).then(O=>{if(this.destroyed)throw new Error("Transport destroyed");const X=new PDFPageProxy(p,O,this,this._params.pdfBug);return m(this,A).set(p,X),X});return m(this,u).set(p,r),r}getPageIndex(s){return typeof s!="object"||s===null||!Number.isInteger(s.num)||s.num<0||!Number.isInteger(s.gen)||s.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:s.num,gen:s.gen})}getAnnotations(s,p){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:s,intent:p})}getFieldObjects(){return lt(this,g,de).call(this,"GetFieldObjects")}hasJSActions(){return lt(this,g,de).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(s){return typeof s!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:s})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(s){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:s})}getStructTree(s){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:s})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(s=>new _optional_content_config.OptionalContentConfig(s))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const s="GetMetadata",p=m(this,C).get(s);if(p)return p;const T=this.messageHandler.sendWithPromise(s,null).then(r=>{var O,X;return{info:r[0],metadata:r[1]?new _metadata.Metadata(r[1]):null,contentDispositionFilename:((O=this._fullReader)==null?void 0:O.filename)??null,contentLength:((X=this._fullReader)==null?void 0:X.contentLength)??null}});return m(this,C).set(s,T),T}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(s=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const p of m(this,A).values())if(!p.cleanup())throw new Error(`startCleanup: Page ${p.pageNumber} is currently rendering.`);this.commonObjs.clear(),s||this.fontLoader.clear(),m(this,C).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:s,enableXfa:p}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:s,enableXfa:p})}}C=new WeakMap,A=new WeakMap,u=new WeakMap,g=new WeakSet,de=function(s,p=null){const T=m(this,C).get(s);if(T)return T;const r=this.messageHandler.sendWithPromise(s,p);return m(this,C).set(s,r),r};class PDFObjects{constructor(){et(this,P);et(this,i,Object.create(null))}get(s,p=null){if(p){const r=lt(this,P,ue).call(this,s);return r.capability.promise.then(()=>p(r.data)),null}const T=m(this,i)[s];if(!(T!=null&&T.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${s}.`);return T.data}has(s){const p=m(this,i)[s];return(p==null?void 0:p.capability.settled)||!1}resolve(s,p=null){const T=lt(this,P,ue).call(this,s);T.data=p,T.capability.resolve()}clear(){var s;for(const p in m(this,i)){const{data:T}=m(this,i)[p];(s=T==null?void 0:T.bitmap)==null||s.close()}mt(this,i,Object.create(null))}}i=new WeakMap,P=new WeakSet,ue=function(s){const p=m(this,i)[s];return p||(m(this,i)[s]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(s){et(this,y,null);mt(this,y,s),this.onContinue=null}get promise(){return m(this,y).capability.promise}cancel(s=0){m(this,y).cancel(null,s)}get separateAnnots(){const{separateAnnots:s}=m(this,y).operatorList;if(!s)return!1;const{annotationCanvasMap:p}=m(this,y);return s.form||s.canvas&&(p==null?void 0:p.size)>0}}y=new WeakMap,exports.RenderTask=RenderTask;const o=class{constructor({callback:s,params:p,objs:T,commonObjs:r,annotationCanvasMap:O,operatorList:X,pageIndex:Y,canvasFactory:Z,filterFactory:rt,useRequestAnimationFrame:ft=!1,pdfBug:ot=!1,pageColors:dt=null}){this.callback=s,this.params=p,this.objs=T,this.commonObjs=r,this.annotationCanvasMap=O,this.operatorListIdx=null,this.operatorList=X,this._pageIndex=Y,this.canvasFactory=Z,this.filterFactory=rt,this._pdfBug=ot,this.pageColors=dt,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=ft===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=p.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:s=!1,optionalContentConfig:p}){var Y,Z;if(this.cancelled)return;if(this._canvas){if(m(o,t).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");m(o,t).add(this._canvas)}this._pdfBug&&((Y=globalThis.StepperManager)!=null&&Y.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:T,viewport:r,transform:O,background:X}=this.params;this.gfx=new _canvas.CanvasGraphics(T,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:p},this.annotationCanvasMap),this.gfx.beginDrawing({transform:O,viewport:r,transparency:s,background:X}),this.operatorListIdx=0,this.graphicsReady=!0,(Z=this.graphicsReadyCallback)==null||Z.call(this)}cancel(s=null,p=0){var T;this.running=!1,this.cancelled=!0,(T=this.gfx)==null||T.endDrawing(this.pageColors),this._canvas&&m(o,t).delete(this._canvas),this.callback(s||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas",p))}operatorListChanged(){var s;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(s=this.stepper)==null||s.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&m(o,t).delete(this._canvas),this.callback())))}};let InternalRenderTask=o;t=new WeakMap,et(InternalRenderTask,t,new WeakSet);const version="3.5.141";exports.version=version;const build="be0f6ee08";exports.build=build},(it,c,H)=>{var M,E,_,Me,C;Object.defineProperty(c,"__esModule",{value:!0}),c.PrintAnnotationStorage=c.AnnotationStorage=void 0;var f=H(1),S=H(4),G=H(8);class V{constructor(){et(this,_);et(this,M,!1);et(this,E,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(u,g){const n=m(this,E).get(u);return n===void 0?g:Object.assign(g,n)}getRawValue(u){return m(this,E).get(u)}remove(u){if(m(this,E).delete(u),m(this,E).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const g of m(this,E).values())if(g instanceof S.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(u,g){const n=m(this,E).get(u);let i=!1;if(n!==void 0)for(const[P,F]of Object.entries(g))n[P]!==F&&(i=!0,n[P]=F);else i=!0,m(this,E).set(u,g);i&&lt(this,_,Me).call(this),g instanceof S.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(g.constructor._type)}has(u){return m(this,E).has(u)}getAll(){return m(this,E).size>0?(0,f.objectFromMap)(m(this,E)):null}setAll(u){for(const[g,n]of Object.entries(u))this.setValue(g,n)}get size(){return m(this,E).size}resetModified(){m(this,M)&&(mt(this,M,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Q(this)}get serializable(){if(m(this,E).size===0)return null;const u=new Map;for(const[g,n]of m(this,E)){const i=n instanceof S.AnnotationEditor?n.serialize():n;i&&u.set(g,i)}return u}static getHash(u){if(!u)return"";const g=new G.MurmurHash3_64;for(const[n,i]of u)g.update(`${n}:${JSON.stringify(i)}`);return g.hexdigest()}}M=new WeakMap,E=new WeakMap,_=new WeakSet,Me=function(){m(this,M)||(mt(this,M,!0),typeof this.onSetModified=="function"&&this.onSetModified())},c.AnnotationStorage=V;class Q extends V{constructor(g){super();et(this,C,null);mt(this,C,structuredClone(g.serializable))}get print(){(0,f.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return m(this,C)}}C=new WeakMap,c.PrintAnnotationStorage=Q},(it,c,H)=>{var V,Q,M,E,_,w;Object.defineProperty(c,"__esModule",{value:!0}),c.AnnotationEditor=void 0;var f=H(5),S=H(1);const C=class{constructor(u){et(this,V,this.focusin.bind(this));et(this,Q,this.focusout.bind(this));et(this,M,!1);et(this,E,!1);et(this,_,!1);Dt(this,"_uiManager",null);et(this,w,C._zIndex++);this.constructor===C&&(0,S.unreachable)("Cannot initialize AnnotationEditor."),this.parent=u.parent,this.id=u.id,this.width=this.height=null,this.pageIndex=u.parent.pageIndex,this.name=u.name,this.div=null,this._uiManager=u.uiManager;const{rotation:g,rawDims:{pageWidth:n,pageHeight:i,pageX:P,pageY:F}}=this.parent.viewport;this.rotation=g,this.pageDimensions=[n,i],this.pageTranslation=[P,F];const[y,t]=this.parentDimensions;this.x=u.x/y,this.y=u.y/t,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,S.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}addCommands(u){this._uiManager.addCommands(u)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=m(this,w)}setParent(u){u!==null&&(this.pageIndex=u.pageIndex,this.pageDimensions=u.pageDimensions),this.parent=u}focusin(u){m(this,M)?mt(this,M,!1):this.parent.setSelected(this)}focusout(u){var n;if(!this.isAttachedToDOM)return;const g=u.relatedTarget;g!=null&&g.closest(`#${this.id}`)||(u.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(u){const g=this.parent.div.getBoundingClientRect();this.startX=u.clientX-g.x,this.startY=u.clientY-g.y,u.dataTransfer.setData("text/plain",this.id),u.dataTransfer.effectAllowed="move"}setAt(u,g,n,i){const[P,F]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(u+n)/P,this.y=(g+i)/F,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(u,g){const[n,i]=this.parentDimensions;[u,g]=this.screenToPageTranslation(u,g),this.x+=u/n,this.y+=g/i,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(u,g){switch(this.parentRotation){case 90:return[g,-u];case 180:return[-u,-g];case 270:return[-g,u];default:return[u,g]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return this._uiManager.viewParameters.rotation}get parentDimensions(){const{realScale:u}=this._uiManager.viewParameters,[g,n]=this.pageDimensions;return[g*u,n*u]}setDims(u,g){const[n,i]=this.parentDimensions;this.div.style.width=`${100*u/n}%`,this.div.style.height=`${100*g/i}%`}fixDims(){const{style:u}=this.div,{height:g,width:n}=u,i=n.endsWith("%"),P=g.endsWith("%");if(i&&P)return;const[F,y]=this.parentDimensions;i||(u.width=`${100*parseFloat(n)/F}%`),P||(u.height=`${100*parseFloat(g)/y}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",m(this,V)),this.div.addEventListener("focusout",m(this,Q));const[u,g]=this.getInitialTranslation();return this.translate(u,g),(0,f.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(u){const{isMac:g}=S.FeatureTest.platform;if(u.button!==0||u.ctrlKey&&g){u.preventDefault();return}u.ctrlKey&&!g||u.shiftKey||u.metaKey&&g?this.parent.toggleSelected(this):this.parent.setSelected(this),mt(this,M,!0)}getRect(u,g){const n=this.parentScale,[i,P]=this.pageDimensions,[F,y]=this.pageTranslation,t=u/n,o=g/n,l=this.x*i,s=this.y*P,p=this.width*i,T=this.height*P;switch(this.rotation){case 0:return[l+t+F,P-s-o-T+y,l+t+p+F,P-s-o+y];case 90:return[l+o+F,P-s+t+y,l+o+T+F,P-s+t+p+y];case 180:return[l-t-p+F,P-s+o+y,l-t+F,P-s+o+T+y];case 270:return[l-o-T+F,P-s-t-p+y,l-o+F,P-s-t+y];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(u,g){const[n,i,P,F]=u,y=P-n,t=F-i;switch(this.rotation){case 0:return[n,g-F,y,t];case 90:return[n,g-i,t,y];case 180:return[P,g-i,y,t];case 270:return[P,g-F,t,y];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){mt(this,_,!0)}disableEditMode(){mt(this,_,!1)}isInEditMode(){return m(this,_)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var u;(u=this.div)==null||u.addEventListener("focusin",m(this,V))}serialize(){(0,S.unreachable)("An editor must be serializable")}static deserialize(u,g,n){const i=new this.prototype.constructor({parent:g,id:g.getNextId(),uiManager:n});i.rotation=u.rotation;const[P,F]=i.pageDimensions,[y,t,o,l]=i.getRectInCurrentCoords(u.rect,F);return i.x=y/P,i.y=t/F,i.width=o/P,i.height=l/F,i}remove(){this.div.removeEventListener("focusin",m(this,V)),this.div.removeEventListener("focusout",m(this,Q)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var u;(u=this.div)==null||u.classList.add("selectedEditor")}unselect(){var u;(u=this.div)==null||u.classList.remove("selectedEditor")}updateParams(u,g){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return m(this,E)}set isEditing(u){mt(this,E,u),u?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};let G=C;V=new WeakMap,Q=new WeakMap,M=new WeakMap,E=new WeakMap,_=new WeakMap,w=new WeakMap,Dt(G,"_colorManager",new f.ColorManager),Dt(G,"_zIndex",1),c.AnnotationEditor=G},(it,c,H)=>{var C,A,u,g,n,i,De,y,t,o,l,s,p,T,r,O,X,Y,Z,rt,ft,ot,dt,bt,yt,B,h,d,v,j,D,Oe,q,fe,z,Ie,k,Le,a,Wt,x,Jt,N,Ne,tt,je,at,pe,ct,Qt,pt,ge;Object.defineProperty(c,"__esModule",{value:!0}),c.KeyboardManager=c.CommandManager=c.ColorManager=c.AnnotationEditorUIManager=void 0,c.bindEvents=G,c.opacityToHex=V;var f=H(1),S=H(6);function G(Tt,R,U){for(const W of U)R.addEventListener(W,Tt[W].bind(Tt))}function V(Tt){return Math.round(Math.min(255,Math.max(1,255*Tt))).toString(16).padStart(2,"0")}class Q{constructor(){et(this,C,0)}getId(){return`${f.AnnotationEditorPrefix}${ie(this,C)._++}`}}C=new WeakMap;class M{constructor(R=128){et(this,A,[]);et(this,u,!1);et(this,g,void 0);et(this,n,-1);mt(this,g,R)}add({cmd:R,undo:U,mustExec:W,type:gt=NaN,overwriteIfSameType:Ct=!1,keepUndo:J=!1}){if(W&&R(),m(this,u))return;const ht={cmd:R,undo:U,type:gt};if(m(this,n)===-1){m(this,A).length>0&&(m(this,A).length=0),mt(this,n,0),m(this,A).push(ht);return}if(Ct&&m(this,A)[m(this,n)].type===gt){J&&(ht.undo=m(this,A)[m(this,n)].undo),m(this,A)[m(this,n)]=ht;return}const vt=m(this,n)+1;vt===m(this,g)?m(this,A).splice(0,1):(mt(this,n,vt),vt<m(this,A).length&&m(this,A).splice(vt)),m(this,A).push(ht)}undo(){m(this,n)!==-1&&(mt(this,u,!0),m(this,A)[m(this,n)].undo(),mt(this,u,!1),mt(this,n,m(this,n)-1))}redo(){m(this,n)<m(this,A).length-1&&(mt(this,n,m(this,n)+1),mt(this,u,!0),m(this,A)[m(this,n)].cmd(),mt(this,u,!1))}hasSomethingToUndo(){return m(this,n)!==-1}hasSomethingToRedo(){return m(this,n)<m(this,A).length-1}destroy(){mt(this,A,null)}}A=new WeakMap,u=new WeakMap,g=new WeakMap,n=new WeakMap,c.CommandManager=M;class E{constructor(R){et(this,i);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:U}=f.FeatureTest.platform;for(const[W,gt]of R)for(const Ct of W){const J=Ct.startsWith("mac+");U&&J?(this.callbacks.set(Ct.slice(4),gt),this.allKeys.add(Ct.split("+").at(-1))):!U&&!J&&(this.callbacks.set(Ct,gt),this.allKeys.add(Ct.split("+").at(-1)))}}exec(R,U){if(!this.allKeys.has(U.key))return;const W=this.callbacks.get(lt(this,i,De).call(this,U));W&&(W.bind(R)(),U.stopPropagation(),U.preventDefault())}}i=new WeakSet,De=function(R){R.altKey&&this.buffer.push("alt"),R.ctrlKey&&this.buffer.push("ctrl"),R.metaKey&&this.buffer.push("meta"),R.shiftKey&&this.buffer.push("shift"),this.buffer.push(R.key);const U=this.buffer.join("+");return this.buffer.length=0,U},c.KeyboardManager=E;const F=class{get _colors(){const R=new Map([["CanvasText",null],["Canvas",null]]);return(0,S.getColorValues)(R),(0,f.shadow)(this,"_colors",R)}convert(R){const U=(0,S.getRGB)(R);if(!window.matchMedia("(forced-colors: active)").matches)return U;for(const[W,gt]of this._colors)if(gt.every((Ct,J)=>Ct===U[J]))return F._colorsMapping.get(W);return U}getHexCode(R){const U=this._colors.get(R);return U?f.Util.makeHexColor(...U):R}};let _=F;Dt(_,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),c.ColorManager=_;const At=class{constructor(R,U,W){et(this,D);et(this,q);et(this,z);et(this,k);et(this,a);et(this,x);et(this,N);et(this,tt);et(this,at);et(this,ct);et(this,pt);et(this,y,null);et(this,t,new Map);et(this,o,new Map);et(this,l,null);et(this,s,new M);et(this,p,0);et(this,T,null);et(this,r,new Set);et(this,O,null);et(this,X,new Q);et(this,Y,!1);et(this,Z,f.AnnotationEditorType.NONE);et(this,rt,new Set);et(this,ft,this.copy.bind(this));et(this,ot,this.cut.bind(this));et(this,dt,this.paste.bind(this));et(this,bt,this.keydown.bind(this));et(this,yt,this.onEditingAction.bind(this));et(this,B,this.onPageChanging.bind(this));et(this,h,this.onScaleChanging.bind(this));et(this,d,this.onRotationChanging.bind(this));et(this,v,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});et(this,j,null);mt(this,j,R),mt(this,O,U),m(this,O)._on("editingaction",m(this,yt)),m(this,O)._on("pagechanging",m(this,B)),m(this,O)._on("scalechanging",m(this,h)),m(this,O)._on("rotationchanging",m(this,d)),mt(this,l,W),this.viewParameters={realScale:S.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){lt(this,q,fe).call(this),m(this,O)._off("editingaction",m(this,yt)),m(this,O)._off("pagechanging",m(this,B)),m(this,O)._off("scalechanging",m(this,h)),m(this,O)._off("rotationchanging",m(this,d));for(const R of m(this,o).values())R.destroy();m(this,o).clear(),m(this,t).clear(),m(this,r).clear(),mt(this,y,null),m(this,rt).clear(),m(this,s).destroy()}onPageChanging({pageNumber:R}){mt(this,p,R-1)}focusMainContainer(){m(this,j).focus()}addShouldRescale(R){m(this,r).add(R)}removeShouldRescale(R){m(this,r).delete(R)}onScaleChanging({scale:R}){this.commitOrRemove(),this.viewParameters.realScale=R*S.PixelsPerInch.PDF_TO_CSS_UNITS;for(const U of m(this,r))U.onScaleChanging()}onRotationChanging({pagesRotation:R}){this.commitOrRemove(),this.viewParameters.rotation=R}addToAnnotationStorage(R){!R.isEmpty()&&m(this,l)&&!m(this,l).has(R.id)&&m(this,l).setValue(R.id,R)}copy(R){if(R.preventDefault(),m(this,y)&&m(this,y).commitOrRemove(),!this.hasSelection)return;const U=[];for(const W of m(this,rt))W.isEmpty()||U.push(W.serialize());U.length!==0&&R.clipboardData.setData("application/pdfjs",JSON.stringify(U))}cut(R){this.copy(R),this.delete()}paste(R){R.preventDefault();let U=R.clipboardData.getData("application/pdfjs");if(!U)return;try{U=JSON.parse(U)}catch(gt){(0,f.warn)(`paste: "${gt.message}".`);return}if(!Array.isArray(U))return;this.unselectAll();const W=m(this,o).get(m(this,p));try{const gt=[];for(const ht of U){const vt=W.deserialize(ht);if(!vt)return;gt.push(vt)}const Ct=()=>{for(const ht of gt)lt(this,at,pe).call(this,ht);lt(this,pt,ge).call(this,gt)},J=()=>{for(const ht of gt)ht.remove()};this.addCommands({cmd:Ct,undo:J,mustExec:!0})}catch(gt){(0,f.warn)(`paste: "${gt.message}".`)}}keydown(R){var U;(U=this.getActive())!=null&&U.shouldGetKeyboardEvents()||At._keyboardManager.exec(this,R)}onEditingAction(R){["undo","redo","delete","selectAll"].includes(R.name)&&this[R.name]()}setEditingState(R){R?(lt(this,D,Oe).call(this),lt(this,z,Ie).call(this),lt(this,a,Wt).call(this,{isEditing:m(this,Z)!==f.AnnotationEditorType.NONE,isEmpty:lt(this,ct,Qt).call(this),hasSomethingToUndo:m(this,s).hasSomethingToUndo(),hasSomethingToRedo:m(this,s).hasSomethingToRedo(),hasSelectedEditor:!1})):(lt(this,q,fe).call(this),lt(this,k,Le).call(this),lt(this,a,Wt).call(this,{isEditing:!1}))}registerEditorTypes(R){if(!m(this,T)){mt(this,T,R);for(const U of m(this,T))lt(this,x,Jt).call(this,U.defaultPropertiesToUpdate)}}getId(){return m(this,X).getId()}get currentLayer(){return m(this,o).get(m(this,p))}get currentPageIndex(){return m(this,p)}addLayer(R){m(this,o).set(R.pageIndex,R),m(this,Y)?R.enable():R.disable()}removeLayer(R){m(this,o).delete(R.pageIndex)}updateMode(R){if(mt(this,Z,R),R===f.AnnotationEditorType.NONE)this.setEditingState(!1),lt(this,tt,je).call(this);else{this.setEditingState(!0),lt(this,N,Ne).call(this);for(const U of m(this,o).values())U.updateMode(R)}}updateToolbar(R){R!==m(this,Z)&&m(this,O).dispatch("switchannotationeditormode",{source:this,mode:R})}updateParams(R,U){if(m(this,T)){for(const W of m(this,rt))W.updateParams(R,U);for(const W of m(this,T))W.updateDefaultParams(R,U)}}getEditors(R){const U=[];for(const W of m(this,t).values())W.pageIndex===R&&U.push(W);return U}getEditor(R){return m(this,t).get(R)}addEditor(R){m(this,t).set(R.id,R)}removeEditor(R){var U;m(this,t).delete(R.id),this.unselect(R),(U=m(this,l))==null||U.remove(R.id)}setActiveEditor(R){m(this,y)!==R&&(mt(this,y,R),R&&lt(this,x,Jt).call(this,R.propertiesToUpdate))}toggleSelected(R){if(m(this,rt).has(R)){m(this,rt).delete(R),R.unselect(),lt(this,a,Wt).call(this,{hasSelectedEditor:this.hasSelection});return}m(this,rt).add(R),R.select(),lt(this,x,Jt).call(this,R.propertiesToUpdate),lt(this,a,Wt).call(this,{hasSelectedEditor:!0})}setSelected(R){for(const U of m(this,rt))U!==R&&U.unselect();m(this,rt).clear(),m(this,rt).add(R),R.select(),lt(this,x,Jt).call(this,R.propertiesToUpdate),lt(this,a,Wt).call(this,{hasSelectedEditor:!0})}isSelected(R){return m(this,rt).has(R)}unselect(R){R.unselect(),m(this,rt).delete(R),lt(this,a,Wt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return m(this,rt).size!==0}undo(){m(this,s).undo(),lt(this,a,Wt).call(this,{hasSomethingToUndo:m(this,s).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:lt(this,ct,Qt).call(this)})}redo(){m(this,s).redo(),lt(this,a,Wt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:m(this,s).hasSomethingToRedo(),isEmpty:lt(this,ct,Qt).call(this)})}addCommands(R){m(this,s).add(R),lt(this,a,Wt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:lt(this,ct,Qt).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const R=[...m(this,rt)],U=()=>{for(const gt of R)gt.remove()},W=()=>{for(const gt of R)lt(this,at,pe).call(this,gt)};this.addCommands({cmd:U,undo:W,mustExec:!0})}commitOrRemove(){var R;(R=m(this,y))==null||R.commitOrRemove()}selectAll(){for(const R of m(this,rt))R.commit();lt(this,pt,ge).call(this,m(this,t).values())}unselectAll(){if(m(this,y)){m(this,y).commitOrRemove();return}if(m(this,rt).size!==0){for(const R of m(this,rt))R.unselect();m(this,rt).clear(),lt(this,a,Wt).call(this,{hasSelectedEditor:!1})}}isActive(R){return m(this,y)===R}getActive(){return m(this,y)}getMode(){return m(this,Z)}};let w=At;y=new WeakMap,t=new WeakMap,o=new WeakMap,l=new WeakMap,s=new WeakMap,p=new WeakMap,T=new WeakMap,r=new WeakMap,O=new WeakMap,X=new WeakMap,Y=new WeakMap,Z=new WeakMap,rt=new WeakMap,ft=new WeakMap,ot=new WeakMap,dt=new WeakMap,bt=new WeakMap,yt=new WeakMap,B=new WeakMap,h=new WeakMap,d=new WeakMap,v=new WeakMap,j=new WeakMap,D=new WeakSet,Oe=function(){m(this,j).addEventListener("keydown",m(this,bt))},q=new WeakSet,fe=function(){m(this,j).removeEventListener("keydown",m(this,bt))},z=new WeakSet,Ie=function(){document.addEventListener("copy",m(this,ft)),document.addEventListener("cut",m(this,ot)),document.addEventListener("paste",m(this,dt))},k=new WeakSet,Le=function(){document.removeEventListener("copy",m(this,ft)),document.removeEventListener("cut",m(this,ot)),document.removeEventListener("paste",m(this,dt))},a=new WeakSet,Wt=function(R){Object.entries(R).some(([W,gt])=>m(this,v)[W]!==gt)&&m(this,O).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(m(this,v),R)})},x=new WeakSet,Jt=function(R){m(this,O).dispatch("annotationeditorparamschanged",{source:this,details:R})},N=new WeakSet,Ne=function(){if(!m(this,Y)){mt(this,Y,!0);for(const R of m(this,o).values())R.enable()}},tt=new WeakSet,je=function(){if(this.unselectAll(),m(this,Y)){mt(this,Y,!1);for(const R of m(this,o).values())R.disable()}},at=new WeakSet,pe=function(R){const U=m(this,o).get(R.pageIndex);U?U.addOrRebuild(R):this.addEditor(R)},ct=new WeakSet,Qt=function(){if(m(this,t).size===0)return!0;if(m(this,t).size===1)for(const R of m(this,t).values())return R.isEmpty();return!1},pt=new WeakSet,ge=function(R){m(this,rt).clear();for(const U of R)U.isEmpty()||(m(this,rt).add(U),U.select());lt(this,a,Wt).call(this,{hasSelectedEditor:!0})},Dt(w,"_keyboardManager",new E([[["ctrl+a","mac+meta+a"],At.prototype.selectAll],[["ctrl+z","mac+meta+z"],At.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],At.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],At.prototype.delete],[["Escape","mac+Escape"],At.prototype.unselectAll]])),c.AnnotationEditorUIManager=w},(it,c,H)=>{var ft,ot,dt,bt,yt,B,h,d,v,zt,D,$t,q,qt;Object.defineProperty(c,"__esModule",{value:!0}),c.StatTimer=c.RenderingCancelledException=c.PixelsPerInch=c.PageViewport=c.PDFDateString=c.DOMStandardFontDataFactory=c.DOMSVGFactory=c.DOMFilterFactory=c.DOMCanvasFactory=c.DOMCMapReaderFactory=c.AnnotationPrefix=void 0,c.deprecated=l,c.getColorValues=O,c.getCurrentTransform=X,c.getCurrentTransformInverse=Y,c.getFilenameFromUrl=P,c.getPdfFilenameFromUrl=F,c.getRGB=r,c.getXfaPageViewport=T,c.isDataScheme=n,c.isPdfFile=i,c.isValidFetchUrl=t,c.loadScript=o,c.setLayerDimensions=Z;var f=H(7),S=H(1);const G="http://www.w3.org/2000/svg",V="pdfjs_internal_id_";c.AnnotationPrefix=V;const rt=class{};let Q=rt;Dt(Q,"CSS",96),Dt(Q,"PDF",72),Dt(Q,"PDF_TO_CSS_UNITS",rt.CSS/rt.PDF),c.PixelsPerInch=Q;class M extends f.BaseFilterFactory{constructor({docId:k,ownerDocument:e=globalThis.document}={}){super();et(this,v);et(this,D);et(this,q);et(this,ft,void 0);et(this,ot,void 0);et(this,dt,void 0);et(this,bt,void 0);et(this,yt,void 0);et(this,B,void 0);et(this,h,void 0);et(this,d,0);mt(this,dt,k),mt(this,bt,e)}addFilter(k){if(!k)return"none";let e=m(this,v,zt).get(k);if(e)return e;let a,b,x,I;if(k.length===1){const at=k[0],ut=new Array(256);for(let ct=0;ct<256;ct++)ut[ct]=at[ct]/255;I=a=b=x=ut.join(",")}else{const[at,ut,ct]=k,_t=new Array(256),pt=new Array(256),Et=new Array(256);for(let At=0;At<256;At++)_t[At]=at[At]/255,pt[At]=ut[At]/255,Et[At]=ct[At]/255;a=_t.join(","),b=pt.join(","),x=Et.join(","),I=`${a}${b}${x}`}if(e=m(this,v,zt).get(I),e)return m(this,v,zt).set(k,e),e;const N=`g_${m(this,dt)}_transfer_map_${ie(this,d)._++}`,nt=`url(#${N})`;m(this,v,zt).set(k,nt),m(this,v,zt).set(I,nt);const tt=m(this,bt).createElementNS(G,"filter",G);tt.setAttribute("id",N),tt.setAttribute("color-interpolation-filters","sRGB");const st=m(this,bt).createElementNS(G,"feComponentTransfer");return tt.append(st),lt(this,q,qt).call(this,st,"feFuncR",a),lt(this,q,qt).call(this,st,"feFuncG",b),lt(this,q,qt).call(this,st,"feFuncB",x),m(this,D,$t).append(tt),nt}addHCMFilter(k,e){var ct;const a=`${k}-${e}`;if(m(this,B)===a)return m(this,h);if(mt(this,B,a),mt(this,h,"none"),(ct=m(this,yt))==null||ct.remove(),!k||!e)return m(this,h);m(this,D,$t).style.color=k,k=getComputedStyle(m(this,D,$t)).getPropertyValue("color");const b=r(k);k=S.Util.makeHexColor(...b),m(this,D,$t).style.color=e,e=getComputedStyle(m(this,D,$t)).getPropertyValue("color");const x=r(e);if(e=S.Util.makeHexColor(...x),m(this,D,$t).style.color="",k==="#000000"&&e==="#ffffff"||k===e)return m(this,h);const I=new Array(256);for(let _t=0;_t<=255;_t++){const pt=_t/255;I[_t]=pt<=.03928?pt/12.92:((pt+.055)/1.055)**2.4}const N=I.join(","),nt=`g_${m(this,dt)}_hcm_filter`,tt=mt(this,yt,m(this,bt).createElementNS(G,"filter",G));tt.setAttribute("id",nt),tt.setAttribute("color-interpolation-filters","sRGB");let st=m(this,bt).createElementNS(G,"feComponentTransfer");tt.append(st),lt(this,q,qt).call(this,st,"feFuncR",N),lt(this,q,qt).call(this,st,"feFuncG",N),lt(this,q,qt).call(this,st,"feFuncB",N);const at=m(this,bt).createElementNS(G,"feColorMatrix");at.setAttribute("type","matrix"),at.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),tt.append(at),st=m(this,bt).createElementNS(G,"feComponentTransfer"),tt.append(st);const ut=(_t,pt)=>{const Et=b[_t]/255,At=x[_t]/255,Tt=new Array(pt+1);for(let R=0;R<=pt;R++)Tt[R]=Et+R/pt*(At-Et);return Tt.join(",")};return lt(this,q,qt).call(this,st,"feFuncR",ut(0,5)),lt(this,q,qt).call(this,st,"feFuncG",ut(1,5)),lt(this,q,qt).call(this,st,"feFuncB",ut(2,5)),m(this,D,$t).append(tt),mt(this,h,`url(#${nt})`),m(this,h)}destroy(k=!1){k&&m(this,h)||(m(this,ot)&&(m(this,ot).parentNode.parentNode.remove(),mt(this,ot,null)),m(this,ft)&&(m(this,ft).clear(),mt(this,ft,null)),mt(this,d,0))}}ft=new WeakMap,ot=new WeakMap,dt=new WeakMap,bt=new WeakMap,yt=new WeakMap,B=new WeakMap,h=new WeakMap,d=new WeakMap,v=new WeakSet,zt=function(){return m(this,ft)||mt(this,ft,new Map)},D=new WeakSet,$t=function(){if(!m(this,ot)){const k=m(this,bt).createElement("div"),{style:e}=k;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const a=m(this,bt).createElementNS(G,"svg");a.setAttribute("width",0),a.setAttribute("height",0),mt(this,ot,m(this,bt).createElementNS(G,"defs")),k.append(a),a.append(m(this,ot)),m(this,bt).body.append(k)}return m(this,ot)},q=new WeakSet,qt=function(k,e,a){const b=m(this,bt).createElementNS(G,e);b.setAttribute("type","discrete"),b.setAttribute("tableValues",a),k.append(b)},c.DOMFilterFactory=M;class E extends f.BaseCanvasFactory{constructor({ownerDocument:L=globalThis.document}={}){super(),this._document=L}_createCanvas(L,k){const e=this._document.createElement("canvas");return e.width=L,e.height=k,e}}c.DOMCanvasFactory=E;async function _(z,L=!1){if(t(z,document.baseURI)){const k=await fetch(z);if(!k.ok)throw new Error(k.statusText);return L?new Uint8Array(await k.arrayBuffer()):(0,S.stringToBytes)(await k.text())}return new Promise((k,e)=>{const a=new XMLHttpRequest;a.open("GET",z,!0),L&&(a.responseType="arraybuffer"),a.onreadystatechange=()=>{if(a.readyState===XMLHttpRequest.DONE){if(a.status===200||a.status===0){let b;if(L&&a.response?b=new Uint8Array(a.response):!L&&a.responseText&&(b=(0,S.stringToBytes)(a.responseText)),b){k(b);return}}e(new Error(a.statusText))}},a.send(null)})}class w extends f.BaseCMapReaderFactory{_fetchData(L,k){return _(L,this.isCompressed).then(e=>({cMapData:e,compressionType:k}))}}c.DOMCMapReaderFactory=w;class C extends f.BaseStandardFontDataFactory{_fetchData(L){return _(L,!0)}}c.DOMStandardFontDataFactory=C;class A extends f.BaseSVGFactory{_createSVG(L){return document.createElementNS(G,L)}}c.DOMSVGFactory=A;class u{constructor({viewBox:L,scale:k,rotation:e,offsetX:a=0,offsetY:b=0,dontFlip:x=!1}){this.viewBox=L,this.scale=k,this.rotation=e,this.offsetX=a,this.offsetY=b;const I=(L[2]+L[0])/2,N=(L[3]+L[1])/2;let nt,tt,st,at;switch(e%=360,e<0&&(e+=360),e){case 180:nt=-1,tt=0,st=0,at=1;break;case 90:nt=0,tt=1,st=1,at=0;break;case 270:nt=0,tt=-1,st=-1,at=0;break;case 0:nt=1,tt=0,st=0,at=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}x&&(st=-st,at=-at);let ut,ct,_t,pt;nt===0?(ut=Math.abs(N-L[1])*k+a,ct=Math.abs(I-L[0])*k+b,_t=(L[3]-L[1])*k,pt=(L[2]-L[0])*k):(ut=Math.abs(I-L[0])*k+a,ct=Math.abs(N-L[1])*k+b,_t=(L[2]-L[0])*k,pt=(L[3]-L[1])*k),this.transform=[nt*k,tt*k,st*k,at*k,ut-nt*k*I-st*k*N,ct-tt*k*I-at*k*N],this.width=_t,this.height=pt}get rawDims(){const{viewBox:L}=this;return(0,S.shadow)(this,"rawDims",{pageWidth:L[2]-L[0],pageHeight:L[3]-L[1],pageX:L[0],pageY:L[1]})}clone({scale:L=this.scale,rotation:k=this.rotation,offsetX:e=this.offsetX,offsetY:a=this.offsetY,dontFlip:b=!1}={}){return new u({viewBox:this.viewBox.slice(),scale:L,rotation:k,offsetX:e,offsetY:a,dontFlip:b})}convertToViewportPoint(L,k){return S.Util.applyTransform([L,k],this.transform)}convertToViewportRectangle(L){const k=S.Util.applyTransform([L[0],L[1]],this.transform),e=S.Util.applyTransform([L[2],L[3]],this.transform);return[k[0],k[1],e[0],e[1]]}convertToPdfPoint(L,k){return S.Util.applyInverseTransform([L,k],this.transform)}}c.PageViewport=u;class g extends S.BaseException{constructor(L,k,e=0){super(L,"RenderingCancelledException"),this.type=k,this.extraDelay=e}}c.RenderingCancelledException=g;function n(z){const L=z.length;let k=0;for(;k<L&&z[k].trim()==="";)k++;return z.substring(k,k+5).toLowerCase()==="data:"}function i(z){return typeof z=="string"&&/\.pdf$/i.test(z)}function P(z,L=!1){return L||([z]=z.split(/[#?]/,1)),z.substring(z.lastIndexOf("/")+1)}function F(z,L="document.pdf"){if(typeof z!="string")return L;if(n(z))return(0,S.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),L;const k=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,e=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,a=k.exec(z);let b=e.exec(a[1])||e.exec(a[2])||e.exec(a[3]);if(b&&(b=b[0],b.includes("%")))try{b=e.exec(decodeURIComponent(b))[0]}catch{}return b||L}class y{constructor(){Dt(this,"started",Object.create(null));Dt(this,"times",[])}time(L){L in this.started&&(0,S.warn)(`Timer is already running for ${L}`),this.started[L]=Date.now()}timeEnd(L){L in this.started||(0,S.warn)(`Timer has not been started for ${L}`),this.times.push({name:L,start:this.started[L],end:Date.now()}),delete this.started[L]}toString(){const L=[];let k=0;for(const{name:e}of this.times)k=Math.max(e.length,k);for(const{name:e,start:a,end:b}of this.times)L.push(`${e.padEnd(k)} ${b-a}ms
`);return L.join("")}}c.StatTimer=y;function t(z,L){try{const{protocol:k}=L?new URL(z,L):new URL(z);return k==="http:"||k==="https:"}catch{return!1}}function o(z,L=!1){return new Promise((k,e)=>{const a=document.createElement("script");a.src=z,a.onload=function(b){L&&a.remove(),k(b)},a.onerror=function(){e(new Error(`Cannot load script at: ${a.src}`))},(document.head||document.documentElement).append(a)})}function l(z){console.log("Deprecated API usage: "+z)}let s;class p{static toDateObject(L){if(!L||typeof L!="string")return null;s||(s=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const k=s.exec(L);if(!k)return null;const e=parseInt(k[1],10);let a=parseInt(k[2],10);a=a>=1&&a<=12?a-1:0;let b=parseInt(k[3],10);b=b>=1&&b<=31?b:1;let x=parseInt(k[4],10);x=x>=0&&x<=23?x:0;let I=parseInt(k[5],10);I=I>=0&&I<=59?I:0;let N=parseInt(k[6],10);N=N>=0&&N<=59?N:0;const nt=k[7]||"Z";let tt=parseInt(k[8],10);tt=tt>=0&&tt<=23?tt:0;let st=parseInt(k[9],10)||0;return st=st>=0&&st<=59?st:0,nt==="-"?(x+=tt,I+=st):nt==="+"&&(x-=tt,I-=st),new Date(Date.UTC(e,a,b,x,I,N))}}c.PDFDateString=p;function T(z,{scale:L=1,rotation:k=0}){const{width:e,height:a}=z.attributes.style,b=[0,0,parseInt(e),parseInt(a)];return new u({viewBox:b,scale:L,rotation:k})}function r(z){if(z.startsWith("#")){const L=parseInt(z.slice(1),16);return[(L&16711680)>>16,(L&65280)>>8,L&255]}return z.startsWith("rgb(")?z.slice(4,-1).split(",").map(L=>parseInt(L)):z.startsWith("rgba(")?z.slice(5,-1).split(",").map(L=>parseInt(L)).slice(0,3):((0,S.warn)(`Not a valid color format: "${z}"`),[0,0,0])}function O(z){const L=document.createElement("span");L.style.visibility="hidden",document.body.append(L);for(const k of z.keys()){L.style.color=k;const e=window.getComputedStyle(L).color;z.set(k,r(e))}L.remove()}function X(z){const{a:L,b:k,c:e,d:a,e:b,f:x}=z.getTransform();return[L,k,e,a,b,x]}function Y(z){const{a:L,b:k,c:e,d:a,e:b,f:x}=z.getTransform().invertSelf();return[L,k,e,a,b,x]}function Z(z,L,k=!1,e=!0){if(L instanceof u){const{pageWidth:a,pageHeight:b}=L.rawDims,{style:x}=z,I=`calc(var(--scale-factor) * ${a}px)`,N=`calc(var(--scale-factor) * ${b}px)`;!k||L.rotation%180===0?(x.width=I,x.height=N):(x.width=N,x.height=I)}e&&z.setAttribute("data-main-rotation",L.rotation)}},(it,c,H)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BaseStandardFontDataFactory=c.BaseSVGFactory=c.BaseFilterFactory=c.BaseCanvasFactory=c.BaseCMapReaderFactory=void 0;var f=H(1);class S{constructor(){this.constructor===S&&(0,f.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(_){return"none"}addHCMFilter(_,w){return"none"}destroy(_=!1){}}c.BaseFilterFactory=S;class G{constructor(){this.constructor===G&&(0,f.unreachable)("Cannot initialize BaseCanvasFactory.")}create(_,w){if(_<=0||w<=0)throw new Error("Invalid canvas size");const C=this._createCanvas(_,w);return{canvas:C,context:C.getContext("2d")}}reset(_,w,C){if(!_.canvas)throw new Error("Canvas is not specified");if(w<=0||C<=0)throw new Error("Invalid canvas size");_.canvas.width=w,_.canvas.height=C}destroy(_){if(!_.canvas)throw new Error("Canvas is not specified");_.canvas.width=0,_.canvas.height=0,_.canvas=null,_.context=null}_createCanvas(_,w){(0,f.unreachable)("Abstract method `_createCanvas` called.")}}c.BaseCanvasFactory=G;class V{constructor({baseUrl:_=null,isCompressed:w=!0}){this.constructor===V&&(0,f.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=_,this.isCompressed=w}async fetch({name:_}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!_)throw new Error("CMap name must be specified.");const w=this.baseUrl+_+(this.isCompressed?".bcmap":""),C=this.isCompressed?f.CMapCompressionType.BINARY:f.CMapCompressionType.NONE;return this._fetchData(w,C).catch(A=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${w}`)})}_fetchData(_,w){(0,f.unreachable)("Abstract method `_fetchData` called.")}}c.BaseCMapReaderFactory=V;class Q{constructor({baseUrl:_=null}){this.constructor===Q&&(0,f.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=_}async fetch({filename:_}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!_)throw new Error("Font filename must be specified.");const w=`${this.baseUrl}${_}`;return this._fetchData(w).catch(C=>{throw new Error(`Unable to load font data at: ${w}`)})}_fetchData(_){(0,f.unreachable)("Abstract method `_fetchData` called.")}}c.BaseStandardFontDataFactory=Q;class M{constructor(){this.constructor===M&&(0,f.unreachable)("Cannot initialize BaseSVGFactory.")}create(_,w,C=!1){if(_<=0||w<=0)throw new Error("Invalid SVG dimensions");const A=this._createSVG("svg:svg");return A.setAttribute("version","1.1"),C||(A.setAttribute("width",`${_}px`),A.setAttribute("height",`${w}px`)),A.setAttribute("preserveAspectRatio","none"),A.setAttribute("viewBox",`0 0 ${_} ${w}`),A}createElement(_){if(typeof _!="string")throw new Error("Invalid SVG element type");return this._createSVG(_)}_createSVG(_){(0,f.unreachable)("Abstract method `_createSVG` called.")}}c.BaseSVGFactory=M},(it,c,H)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.MurmurHash3_64=void 0;var f=H(1);const S=3285377520,G=4294901760,V=65535;class Q{constructor(E){this.h1=E?E&4294967295:S,this.h2=E?E&4294967295:S}update(E){let _,w;if(typeof E=="string"){_=new Uint8Array(E.length*2),w=0;for(let l=0,s=E.length;l<s;l++){const p=E.charCodeAt(l);p<=255?_[w++]=p:(_[w++]=p>>>8,_[w++]=p&255)}}else if((0,f.isArrayBuffer)(E))_=E.slice(),w=_.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const C=w>>2,A=w-C*4,u=new Uint32Array(_.buffer,0,C);let g=0,n=0,i=this.h1,P=this.h2;const F=3432918353,y=461845907,t=F&V,o=y&V;for(let l=0;l<C;l++)l&1?(g=u[l],g=g*F&G|g*t&V,g=g<<15|g>>>17,g=g*y&G|g*o&V,i^=g,i=i<<13|i>>>19,i=i*5+3864292196):(n=u[l],n=n*F&G|n*t&V,n=n<<15|n>>>17,n=n*y&G|n*o&V,P^=n,P=P<<13|P>>>19,P=P*5+3864292196);switch(g=0,A){case 3:g^=_[C*4+2]<<16;case 2:g^=_[C*4+1]<<8;case 1:g^=_[C*4],g=g*F&G|g*t&V,g=g<<15|g>>>17,g=g*y&G|g*o&V,C&1?i^=g:P^=g}this.h1=i,this.h2=P}hexdigest(){let E=this.h1,_=this.h2;return E^=_>>>1,E=E*3981806797&G|E*36045&V,_=_*4283543511&G|((_<<16|E>>>16)*2950163797&G)>>>16,E^=_>>>1,E=E*444984403&G|E*60499&V,_=_*3301882366&G|((_<<16|E>>>16)*3120437893&G)>>>16,E^=_>>>1,(E>>>0).toString(16).padStart(8,"0")+(_>>>0).toString(16).padStart(8,"0")}}c.MurmurHash3_64=Q},(it,c,H)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.FontLoader=c.FontFaceObject=void 0;var f=H(1),S=H(10);class G{constructor({ownerDocument:M=globalThis.document,styleElement:E=null}){this._document=M,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(M){this.nativeFontFaces.push(M),this._document.fonts.add(M)}insertRule(M){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const E=this.styleElement.sheet;E.insertRule(M,E.cssRules.length)}clear(){for(const M of this.nativeFontFaces)this._document.fonts.delete(M);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(M){if(M.attached||M.missingFile)return;if(M.attached=!0,this.isFontLoadingAPISupported){const _=M.createNativeFontFace();if(_){this.addNativeFontFace(_);try{await _.loaded}catch(w){throw(0,f.warn)(`Failed to load font '${_.family}': '${w}'.`),M.disableFontFace=!0,w}}return}const E=M.createFontFaceRule();if(E){if(this.insertRule(E),this.isSyncFontLoadingSupported)return;await new Promise(_=>{const w=this._queueLoadingCallback(_);this._prepareFontLoadEvent(M,w)})}}get isFontLoadingAPISupported(){var E;const M=!!((E=this._document)!=null&&E.fonts);return(0,f.shadow)(this,"isFontLoadingAPISupported",M)}get isSyncFontLoadingSupported(){let M=!1;return(S.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(M=!0),(0,f.shadow)(this,"isSyncFontLoadingSupported",M)}_queueLoadingCallback(M){function E(){for((0,f.assert)(!w.done,"completeRequest() cannot be called twice."),w.done=!0;_.length>0&&_[0].done;){const C=_.shift();setTimeout(C.callback,0)}}const{loadingRequests:_}=this,w={done:!1,complete:E,callback:M};return _.push(w),w}get _loadTestFont(){const M=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,f.shadow)(this,"_loadTestFont",M)}_prepareFontLoadEvent(M,E){function _(r,O){return r.charCodeAt(O)<<24|r.charCodeAt(O+1)<<16|r.charCodeAt(O+2)<<8|r.charCodeAt(O+3)&255}function w(r,O,X,Y){const Z=r.substring(0,O),rt=r.substring(O+X);return Z+Y+rt}let C,A;const u=this._document.createElement("canvas");u.width=1,u.height=1;const g=u.getContext("2d");let n=0;function i(r,O){if(++n>30){(0,f.warn)("Load test font never loaded."),O();return}if(g.font="30px "+r,g.fillText(".",0,20),g.getImageData(0,0,1,1).data[3]>0){O();return}setTimeout(i.bind(null,r,O))}const P=`lt${Date.now()}${this.loadTestFontId++}`;let F=this._loadTestFont;F=w(F,976,P.length,P);const t=16,o=1482184792;let l=_(F,t);for(C=0,A=P.length-3;C<A;C+=4)l=l-o+_(P,C)|0;C<P.length&&(l=l-o+_(P+"XXX",C)|0),F=w(F,t,4,(0,f.string32)(l));const s=`url(data:font/opentype;base64,${btoa(F)});`,p=`@font-face {font-family:"${P}";src:${s}}`;this.insertRule(p);const T=this._document.createElement("div");T.style.visibility="hidden",T.style.width=T.style.height="10px",T.style.position="absolute",T.style.top=T.style.left="0px";for(const r of[M.loadedName,P]){const O=this._document.createElement("span");O.textContent="Hi",O.style.fontFamily=r,T.append(O)}this._document.body.append(T),i(P,()=>{T.remove(),E.complete()})}}c.FontLoader=G;class V{constructor(M,{isEvalSupported:E=!0,disableFontFace:_=!1,ignoreErrors:w=!1,inspectFont:C=null}){this.compiledGlyphs=Object.create(null);for(const A in M)this[A]=M[A];this.isEvalSupported=E!==!1,this.disableFontFace=_===!0,this.ignoreErrors=w===!0,this._inspectFont=C}createNativeFontFace(){var E;if(!this.data||this.disableFontFace)return null;let M;if(!this.cssFontInfo)M=new FontFace(this.loadedName,this.data,{});else{const _={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(_.style=`oblique ${this.cssFontInfo.italicAngle}deg`),M=new FontFace(this.cssFontInfo.fontFamily,this.data,_)}return(E=this._inspectFont)==null||E.call(this,this),M}createFontFaceRule(){var w;if(!this.data||this.disableFontFace)return null;const M=(0,f.bytesToString)(this.data),E=`url(data:${this.mimetype};base64,${btoa(M)});`;let _;if(!this.cssFontInfo)_=`@font-face {font-family:"${this.loadedName}";src:${E}}`;else{let C=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(C+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),_=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${C}src:${E}}`}return(w=this._inspectFont)==null||w.call(this,this,E),_}getPathGenerator(M,E){if(this.compiledGlyphs[E]!==void 0)return this.compiledGlyphs[E];let _;try{_=M.get(this.loadedName+"_path_"+E)}catch(w){if(!this.ignoreErrors)throw w;return(0,f.warn)(`getPathGenerator - ignoring character: "${w}".`),this.compiledGlyphs[E]=function(C,A){}}if(this.isEvalSupported&&f.FeatureTest.isEvalSupported){const w=[];for(const C of _){const A=C.args!==void 0?C.args.join(","):"";w.push("c.",C.cmd,"(",A,`);
`)}return this.compiledGlyphs[E]=new Function("c","size",w.join(""))}return this.compiledGlyphs[E]=function(w,C){for(const A of _)A.cmd==="scale"&&(A.args=[C,-C]),w[A.cmd].apply(w,A.args)}}}c.FontFaceObject=V},(it,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.isNodeJS=void 0;const H=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");c.isNodeJS=H},(it,c,H)=>{var dt,me;Object.defineProperty(c,"__esModule",{value:!0}),c.CanvasGraphics=void 0;var f=H(1),S=H(6),G=H(12),V=H(13),Q=H(10);const M=16,E=100,_=4096,w=15,C=10,A=1e3,u=16;function g(B,h){if(B._removeMirroring)throw new Error("Context is already forwarding operations.");B.__originalSave=B.save,B.__originalRestore=B.restore,B.__originalRotate=B.rotate,B.__originalScale=B.scale,B.__originalTranslate=B.translate,B.__originalTransform=B.transform,B.__originalSetTransform=B.setTransform,B.__originalResetTransform=B.resetTransform,B.__originalClip=B.clip,B.__originalMoveTo=B.moveTo,B.__originalLineTo=B.lineTo,B.__originalBezierCurveTo=B.bezierCurveTo,B.__originalRect=B.rect,B.__originalClosePath=B.closePath,B.__originalBeginPath=B.beginPath,B._removeMirroring=()=>{B.save=B.__originalSave,B.restore=B.__originalRestore,B.rotate=B.__originalRotate,B.scale=B.__originalScale,B.translate=B.__originalTranslate,B.transform=B.__originalTransform,B.setTransform=B.__originalSetTransform,B.resetTransform=B.__originalResetTransform,B.clip=B.__originalClip,B.moveTo=B.__originalMoveTo,B.lineTo=B.__originalLineTo,B.bezierCurveTo=B.__originalBezierCurveTo,B.rect=B.__originalRect,B.closePath=B.__originalClosePath,B.beginPath=B.__originalBeginPath,delete B._removeMirroring},B.save=function(){h.save(),this.__originalSave()},B.restore=function(){h.restore(),this.__originalRestore()},B.translate=function(v,j){h.translate(v,j),this.__originalTranslate(v,j)},B.scale=function(v,j){h.scale(v,j),this.__originalScale(v,j)},B.transform=function(v,j,D,$,q,K){h.transform(v,j,D,$,q,K),this.__originalTransform(v,j,D,$,q,K)},B.setTransform=function(v,j,D,$,q,K){h.setTransform(v,j,D,$,q,K),this.__originalSetTransform(v,j,D,$,q,K)},B.resetTransform=function(){h.resetTransform(),this.__originalResetTransform()},B.rotate=function(v){h.rotate(v),this.__originalRotate(v)},B.clip=function(v){h.clip(v),this.__originalClip(v)},B.moveTo=function(d,v){h.moveTo(d,v),this.__originalMoveTo(d,v)},B.lineTo=function(d,v){h.lineTo(d,v),this.__originalLineTo(d,v)},B.bezierCurveTo=function(d,v,j,D,$,q){h.bezierCurveTo(d,v,j,D,$,q),this.__originalBezierCurveTo(d,v,j,D,$,q)},B.rect=function(d,v,j,D){h.rect(d,v,j,D),this.__originalRect(d,v,j,D)},B.closePath=function(){h.closePath(),this.__originalClosePath()},B.beginPath=function(){h.beginPath(),this.__originalBeginPath()}}class n{constructor(h){this.canvasFactory=h,this.cache=Object.create(null)}getCanvas(h,d,v){let j;return this.cache[h]!==void 0?(j=this.cache[h],this.canvasFactory.reset(j,d,v)):(j=this.canvasFactory.create(d,v),this.cache[h]=j),j}delete(h){delete this.cache[h]}clear(){for(const h in this.cache){const d=this.cache[h];this.canvasFactory.destroy(d),delete this.cache[h]}}}function i(B,h,d,v,j,D,$,q,K,z){const[L,k,e,a,b,x]=(0,S.getCurrentTransform)(B);if(k===0&&e===0){const nt=$*L+b,tt=Math.round(nt),st=q*a+x,at=Math.round(st),ut=($+K)*L+b,ct=Math.abs(Math.round(ut)-tt)||1,_t=(q+z)*a+x,pt=Math.abs(Math.round(_t)-at)||1;return B.setTransform(Math.sign(L),0,0,Math.sign(a),tt,at),B.drawImage(h,d,v,j,D,0,0,ct,pt),B.setTransform(L,k,e,a,b,x),[ct,pt]}if(L===0&&a===0){const nt=q*e+b,tt=Math.round(nt),st=$*k+x,at=Math.round(st),ut=(q+z)*e+b,ct=Math.abs(Math.round(ut)-tt)||1,_t=($+K)*k+x,pt=Math.abs(Math.round(_t)-at)||1;return B.setTransform(0,Math.sign(k),Math.sign(e),0,tt,at),B.drawImage(h,d,v,j,D,0,0,pt,ct),B.setTransform(L,k,e,a,b,x),[pt,ct]}B.drawImage(h,d,v,j,D,$,q,K,z);const I=Math.hypot(L,k),N=Math.hypot(e,a);return[I*K,N*z]}function P(B){const{width:h,height:d}=B;if(h>A||d>A)return null;const v=1e3,j=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),D=h+1;let $=new Uint8Array(D*(d+1)),q,K,z;const L=h+7&-8;let k=new Uint8Array(L*d),e=0;for(const N of B.data){let nt=128;for(;nt>0;)k[e++]=N&nt?0:255,nt>>=1}let a=0;for(e=0,k[e]!==0&&($[0]=1,++a),K=1;K<h;K++)k[e]!==k[e+1]&&($[K]=k[e]?2:1,++a),e++;for(k[e]!==0&&($[K]=2,++a),q=1;q<d;q++){e=q*L,z=q*D,k[e-L]!==k[e]&&($[z]=k[e]?1:8,++a);let N=(k[e]?4:0)+(k[e-L]?8:0);for(K=1;K<h;K++)N=(N>>2)+(k[e+1]?4:0)+(k[e-L+1]?8:0),j[N]&&($[z+K]=j[N],++a),e++;if(k[e-L]!==k[e]&&($[z+K]=k[e]?2:4,++a),a>v)return null}for(e=L*(d-1),z=q*D,k[e]!==0&&($[z]=8,++a),K=1;K<h;K++)k[e]!==k[e+1]&&($[z+K]=k[e]?4:8,++a),e++;if(k[e]!==0&&($[z+K]=4,++a),a>v)return null;const b=new Int32Array([0,D,-1,0,-D,0,0,0,1]),x=new Path2D;for(q=0;a&&q<=d;q++){let N=q*D;const nt=N+h;for(;N<nt&&!$[N];)N++;if(N===nt)continue;x.moveTo(N%D,q);const tt=N;let st=$[N];do{const at=b[st];do N+=at;while(!$[N]);const ut=$[N];ut!==5&&ut!==10?(st=ut,$[N]=0):(st=ut&51*st>>4,$[N]&=st>>2|st<<2),x.lineTo(N%D,N/D|0),$[N]||--a}while(tt!==N);--q}return k=null,$=null,function(N){N.save(),N.scale(1/h,-1/d),N.translate(0,-d),N.fill(x),N.beginPath(),N.restore()}}class F{constructor(h,d){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=f.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=f.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=f.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,h,d])}clone(){const h=Object.create(this);return h.clipBox=this.clipBox.slice(),h}setCurrentPoint(h,d){this.x=h,this.y=d}updatePathMinMax(h,d,v){[d,v]=f.Util.applyTransform([d,v],h),this.minX=Math.min(this.minX,d),this.minY=Math.min(this.minY,v),this.maxX=Math.max(this.maxX,d),this.maxY=Math.max(this.maxY,v)}updateRectMinMax(h,d){const v=f.Util.applyTransform(d,h),j=f.Util.applyTransform(d.slice(2),h);this.minX=Math.min(this.minX,v[0],j[0]),this.minY=Math.min(this.minY,v[1],j[1]),this.maxX=Math.max(this.maxX,v[0],j[0]),this.maxY=Math.max(this.maxY,v[1],j[1])}updateScalingPathMinMax(h,d){f.Util.scaleMinMax(h,d),this.minX=Math.min(this.minX,d[0]),this.maxX=Math.max(this.maxX,d[1]),this.minY=Math.min(this.minY,d[2]),this.maxY=Math.max(this.maxY,d[3])}updateCurvePathMinMax(h,d,v,j,D,$,q,K,z,L){const k=f.Util.bezierBoundingBox(d,v,j,D,$,q,K,z);if(L){L[0]=Math.min(L[0],k[0],k[2]),L[1]=Math.max(L[1],k[0],k[2]),L[2]=Math.min(L[2],k[1],k[3]),L[3]=Math.max(L[3],k[1],k[3]);return}this.updateRectMinMax(h,k)}getPathBoundingBox(h=G.PathType.FILL,d=null){const v=[this.minX,this.minY,this.maxX,this.maxY];if(h===G.PathType.STROKE){d||(0,f.unreachable)("Stroke bounding box must include transform.");const j=f.Util.singularValueDecompose2dScale(d),D=j[0]*this.lineWidth/2,$=j[1]*this.lineWidth/2;v[0]-=D,v[1]-=$,v[2]+=D,v[3]+=$}return v}updateClipFromPath(){const h=f.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(h||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(h){this.clipBox=h,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(h=G.PathType.FILL,d=null){return f.Util.intersect(this.clipBox,this.getPathBoundingBox(h,d))}}function y(B,h){if(typeof ImageData<"u"&&h instanceof ImageData){B.putImageData(h,0,0);return}const d=h.height,v=h.width,j=d%u,D=(d-j)/u,$=j===0?D:D+1,q=B.createImageData(v,u);let K=0,z;const L=h.data,k=q.data;let e,a,b,x;if(h.kind===f.ImageKind.GRAYSCALE_1BPP){const I=L.byteLength,N=new Uint32Array(k.buffer,0,k.byteLength>>2),nt=N.length,tt=v+7>>3,st=4294967295,at=f.FeatureTest.isLittleEndian?4278190080:255;for(e=0;e<$;e++){for(b=e<D?u:j,z=0,a=0;a<b;a++){const ut=I-K;let ct=0;const _t=ut>tt?v:ut*8-7,pt=_t&-8;let Et=0,At=0;for(;ct<pt;ct+=8)At=L[K++],N[z++]=At&128?st:at,N[z++]=At&64?st:at,N[z++]=At&32?st:at,N[z++]=At&16?st:at,N[z++]=At&8?st:at,N[z++]=At&4?st:at,N[z++]=At&2?st:at,N[z++]=At&1?st:at;for(;ct<_t;ct++)Et===0&&(At=L[K++],Et=128),N[z++]=At&Et?st:at,Et>>=1}for(;z<nt;)N[z++]=0;B.putImageData(q,0,e*u)}}else if(h.kind===f.ImageKind.RGBA_32BPP){for(a=0,x=v*u*4,e=0;e<D;e++)k.set(L.subarray(K,K+x)),K+=x,B.putImageData(q,0,a),a+=u;e<$&&(x=v*j*4,k.set(L.subarray(K,K+x)),B.putImageData(q,0,a))}else if(h.kind===f.ImageKind.RGB_24BPP)for(b=u,x=v*b,e=0;e<$;e++){for(e>=D&&(b=j,x=v*b),z=0,a=x;a--;)k[z++]=L[K++],k[z++]=L[K++],k[z++]=L[K++],k[z++]=255;B.putImageData(q,0,e*u)}else throw new Error(`bad image kind: ${h.kind}`)}function t(B,h){if(h.bitmap){B.drawImage(h.bitmap,0,0);return}const d=h.height,v=h.width,j=d%u,D=(d-j)/u,$=j===0?D:D+1,q=B.createImageData(v,u);let K=0;const z=h.data,L=q.data;for(let k=0;k<$;k++){const e=k<D?u:j;({srcPos:K}=(0,V.convertBlackAndWhiteToRGBA)({src:z,srcPos:K,dest:L,width:v,height:e,nonBlackColor:0})),B.putImageData(q,0,k*u)}}function o(B,h){const d=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const v of d)B[v]!==void 0&&(h[v]=B[v]);B.setLineDash!==void 0&&(h.setLineDash(B.getLineDash()),h.lineDashOffset=B.lineDashOffset)}function l(B){B.strokeStyle=B.fillStyle="#000000",B.fillRule="nonzero",B.globalAlpha=1,B.lineWidth=1,B.lineCap="butt",B.lineJoin="miter",B.miterLimit=10,B.globalCompositeOperation="source-over",B.font="10px sans-serif",B.setLineDash!==void 0&&(B.setLineDash([]),B.lineDashOffset=0),Q.isNodeJS||(B.filter="none")}function s(B,h,d,v){const j=B.length;for(let D=3;D<j;D+=4){const $=B[D];if($===0)B[D-3]=h,B[D-2]=d,B[D-1]=v;else if($<255){const q=255-$;B[D-3]=B[D-3]*$+h*q>>8,B[D-2]=B[D-2]*$+d*q>>8,B[D-1]=B[D-1]*$+v*q>>8}}}function p(B,h,d){const v=B.length,j=1/255;for(let D=3;D<v;D+=4){const $=d?d[B[D]]:B[D];h[D]=h[D]*$*j|0}}function T(B,h,d){const v=B.length;for(let j=3;j<v;j+=4){const D=B[j-3]*77+B[j-2]*152+B[j-1]*28;h[j]=d?h[j]*d[D>>8]>>8:h[j]*D>>16}}function r(B,h,d,v,j,D,$,q,K,z,L){const k=!!D,e=k?D[0]:0,a=k?D[1]:0,b=k?D[2]:0;let x;j==="Luminosity"?x=T:x=p;const N=Math.min(v,Math.ceil(1048576/d));for(let nt=0;nt<v;nt+=N){const tt=Math.min(N,v-nt),st=B.getImageData(q-z,nt+(K-L),d,tt),at=h.getImageData(q,nt+K,d,tt);k&&s(st.data,e,a,b),x(st.data,at.data,$),h.putImageData(at,q,nt+K)}}function O(B,h,d,v){const j=v[0],D=v[1],$=v[2]-j,q=v[3]-D;$===0||q===0||(r(h.context,d,$,q,h.subtype,h.backdrop,h.transferMap,j,D,h.offsetX,h.offsetY),B.save(),B.globalAlpha=1,B.globalCompositeOperation="source-over",B.setTransform(1,0,0,1,0,0),B.drawImage(d.canvas,0,0),B.restore())}function X(B,h){const d=f.Util.singularValueDecompose2dScale(B);d[0]=Math.fround(d[0]),d[1]=Math.fround(d[1]);const v=Math.fround((globalThis.devicePixelRatio||1)*S.PixelsPerInch.PDF_TO_CSS_UNITS);return h!==void 0?h:d[0]<=v||d[1]<=v}const Y=["butt","round","square"],Z=["miter","round","bevel"],rt={},ft={},yt=class{constructor(h,d,v,j,D,{optionalContentConfig:$,markedContentStack:q=null},K){et(this,dt);this.ctx=h,this.current=new F(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=d,this.objs=v,this.canvasFactory=j,this.filterFactory=D,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=q||[],this.optionalContentConfig=$,this.cachedCanvases=new n(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=K,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(h,d=null){return typeof h=="string"?h.startsWith("g_")?this.commonObjs.get(h):this.objs.get(h):d}beginDrawing({transform:h,viewport:d,transparency:v=!1,background:j=null}){const D=this.ctx.canvas.width,$=this.ctx.canvas.height,q=this.ctx.fillStyle;if(this.ctx.fillStyle=j||"#ffffff",this.ctx.fillRect(0,0,D,$),this.ctx.fillStyle=q,v){const K=this.cachedCanvases.getCanvas("transparent",D,$);this.compositeCtx=this.ctx,this.transparentCanvas=K.canvas,this.ctx=K.context,this.ctx.save(),this.ctx.transform(...(0,S.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),l(this.ctx),h&&(this.ctx.transform(...h),this.outputScaleX=h[0],this.outputScaleY=h[0]),this.ctx.transform(...d.transform),this.viewportScale=d.scale,this.baseTransform=(0,S.getCurrentTransform)(this.ctx)}executeOperatorList(h,d,v,j){const D=h.argsArray,$=h.fnArray;let q=d||0;const K=D.length;if(K===q)return q;const z=K-q>C&&typeof v=="function",L=z?Date.now()+w:0;let k=0;const e=this.commonObjs,a=this.objs;let b;for(;;){if(j!==void 0&&q===j.nextBreakPoint)return j.breakIt(q,v),q;if(b=$[q],b!==f.OPS.dependency)this[b].apply(this,D[q]);else for(const x of D[q]){const I=x.startsWith("g_")?e:a;if(!I.has(x))return I.get(x,v),q}if(q++,q===K)return q;if(z&&++k>C){if(Date.now()>L)return v(),q;k=0}}}endDrawing(h=null){lt(this,dt,me).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const d of this._cachedBitmapsMap.values()){for(const v of d.values())typeof HTMLCanvasElement<"u"&&v instanceof HTMLCanvasElement&&(v.width=v.height=0);d.clear()}if(this._cachedBitmapsMap.clear(),h){const d=this.filterFactory.addHCMFilter(h.foreground,h.background);if(d!=="none"){const v=this.ctx.filter;this.ctx.filter=d,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=v}}}_scaleImage(h,d){const v=h.width,j=h.height;let D=Math.max(Math.hypot(d[0],d[1]),1),$=Math.max(Math.hypot(d[2],d[3]),1),q=v,K=j,z="prescale1",L,k;for(;D>2&&q>1||$>2&&K>1;){let e=q,a=K;D>2&&q>1&&(e=q>=16384?Math.floor(q/2)-1||1:Math.ceil(q/2),D/=q/e),$>2&&K>1&&(a=K>=16384?Math.floor(K/2)-1||1:Math.ceil(K)/2,$/=K/a),L=this.cachedCanvases.getCanvas(z,e,a),k=L.context,k.clearRect(0,0,e,a),k.drawImage(h,0,0,q,K,0,0,e,a),h=L.canvas,q=e,K=a,z=z==="prescale1"?"prescale2":"prescale1"}return{img:h,paintWidth:q,paintHeight:K}}_createMaskCanvas(h){const d=this.ctx,{width:v,height:j}=h,D=this.current.fillColor,$=this.current.patternFill,q=(0,S.getCurrentTransform)(d);let K,z,L,k;if((h.bitmap||h.data)&&h.count>1){const ct=h.bitmap||h.data.buffer;z=JSON.stringify($?q:[q.slice(0,4),D]),K=this._cachedBitmapsMap.get(ct),K||(K=new Map,this._cachedBitmapsMap.set(ct,K));const _t=K.get(z);if(_t&&!$){const pt=Math.round(Math.min(q[0],q[2])+q[4]),Et=Math.round(Math.min(q[1],q[3])+q[5]);return{canvas:_t,offsetX:pt,offsetY:Et}}L=_t}L||(k=this.cachedCanvases.getCanvas("maskCanvas",v,j),t(k.context,h));let e=f.Util.transform(q,[1/v,0,0,-1/j,0,0]);e=f.Util.transform(e,[1,0,0,1,0,-j]);const a=f.Util.applyTransform([0,0],e),b=f.Util.applyTransform([v,j],e),x=f.Util.normalizeRect([a[0],a[1],b[0],b[1]]),I=Math.round(x[2]-x[0])||1,N=Math.round(x[3]-x[1])||1,nt=this.cachedCanvases.getCanvas("fillCanvas",I,N),tt=nt.context,st=Math.min(a[0],b[0]),at=Math.min(a[1],b[1]);tt.translate(-st,-at),tt.transform(...e),L||(L=this._scaleImage(k.canvas,(0,S.getCurrentTransformInverse)(tt)),L=L.img,K&&$&&K.set(z,L)),tt.imageSmoothingEnabled=X((0,S.getCurrentTransform)(tt),h.interpolate),i(tt,L,0,0,L.width,L.height,0,0,v,j),tt.globalCompositeOperation="source-in";const ut=f.Util.transform((0,S.getCurrentTransformInverse)(tt),[1,0,0,1,-st,-at]);return tt.fillStyle=$?D.getPattern(d,this,ut,G.PathType.FILL):D,tt.fillRect(0,0,v,j),K&&!$&&(this.cachedCanvases.delete("fillCanvas"),K.set(z,nt.canvas)),{canvas:nt.canvas,offsetX:Math.round(st),offsetY:Math.round(at)}}setLineWidth(h){h!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=h,this.ctx.lineWidth=h}setLineCap(h){this.ctx.lineCap=Y[h]}setLineJoin(h){this.ctx.lineJoin=Z[h]}setMiterLimit(h){this.ctx.miterLimit=h}setDash(h,d){const v=this.ctx;v.setLineDash!==void 0&&(v.setLineDash(h),v.lineDashOffset=d)}setRenderingIntent(h){}setFlatness(h){}setGState(h){for(const[d,v]of h)switch(d){case"LW":this.setLineWidth(v);break;case"LC":this.setLineCap(v);break;case"LJ":this.setLineJoin(v);break;case"ML":this.setMiterLimit(v);break;case"D":this.setDash(v[0],v[1]);break;case"RI":this.setRenderingIntent(v);break;case"FL":this.setFlatness(v);break;case"Font":this.setFont(v[0],v[1]);break;case"CA":this.current.strokeAlpha=v;break;case"ca":this.current.fillAlpha=v,this.ctx.globalAlpha=v;break;case"BM":this.ctx.globalCompositeOperation=v;break;case"SMask":this.current.activeSMask=v?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(v);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const h=this.inSMaskMode;this.current.activeSMask&&!h?this.beginSMaskMode():!this.current.activeSMask&&h&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const h=this.ctx.canvas.width,d=this.ctx.canvas.height,v="smaskGroupAt"+this.groupLevel,j=this.cachedCanvases.getCanvas(v,h,d);this.suspendedCtx=this.ctx,this.ctx=j.context;const D=this.ctx;D.setTransform(...(0,S.getCurrentTransform)(this.suspendedCtx)),o(this.suspendedCtx,D),g(D,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),o(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(h){if(!this.current.activeSMask)return;h?(h[0]=Math.floor(h[0]),h[1]=Math.floor(h[1]),h[2]=Math.ceil(h[2]),h[3]=Math.ceil(h[3])):h=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const d=this.current.activeSMask,v=this.suspendedCtx;O(v,d,this.ctx,h),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(o(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const h=this.current;this.stateStack.push(h),this.current=h.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),o(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(h,d,v,j,D,$){this.ctx.transform(h,d,v,j,D,$),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(h,d,v){const j=this.ctx,D=this.current;let $=D.x,q=D.y,K,z;const L=(0,S.getCurrentTransform)(j),k=L[0]===0&&L[3]===0||L[1]===0&&L[2]===0,e=k?v.slice(0):null;for(let a=0,b=0,x=h.length;a<x;a++)switch(h[a]|0){case f.OPS.rectangle:$=d[b++],q=d[b++];const I=d[b++],N=d[b++],nt=$+I,tt=q+N;j.moveTo($,q),I===0||N===0?j.lineTo(nt,tt):(j.lineTo(nt,q),j.lineTo(nt,tt),j.lineTo($,tt)),k||D.updateRectMinMax(L,[$,q,nt,tt]),j.closePath();break;case f.OPS.moveTo:$=d[b++],q=d[b++],j.moveTo($,q),k||D.updatePathMinMax(L,$,q);break;case f.OPS.lineTo:$=d[b++],q=d[b++],j.lineTo($,q),k||D.updatePathMinMax(L,$,q);break;case f.OPS.curveTo:K=$,z=q,$=d[b+4],q=d[b+5],j.bezierCurveTo(d[b],d[b+1],d[b+2],d[b+3],$,q),D.updateCurvePathMinMax(L,K,z,d[b],d[b+1],d[b+2],d[b+3],$,q,e),b+=6;break;case f.OPS.curveTo2:K=$,z=q,j.bezierCurveTo($,q,d[b],d[b+1],d[b+2],d[b+3]),D.updateCurvePathMinMax(L,K,z,$,q,d[b],d[b+1],d[b+2],d[b+3],e),$=d[b+2],q=d[b+3],b+=4;break;case f.OPS.curveTo3:K=$,z=q,$=d[b+2],q=d[b+3],j.bezierCurveTo(d[b],d[b+1],$,q,$,q),D.updateCurvePathMinMax(L,K,z,d[b],d[b+1],$,q,$,q,e),b+=4;break;case f.OPS.closePath:j.closePath();break}k&&D.updateScalingPathMinMax(L,e),D.setCurrentPoint($,q)}closePath(){this.ctx.closePath()}stroke(h=!0){const d=this.ctx,v=this.current.strokeColor;d.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof v=="object"&&(v!=null&&v.getPattern)?(d.save(),d.strokeStyle=v.getPattern(d,this,(0,S.getCurrentTransformInverse)(d),G.PathType.STROKE),this.rescaleAndStroke(!1),d.restore()):this.rescaleAndStroke(!0)),h&&this.consumePath(this.current.getClippedPathBoundingBox()),d.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(h=!0){const d=this.ctx,v=this.current.fillColor,j=this.current.patternFill;let D=!1;j&&(d.save(),d.fillStyle=v.getPattern(d,this,(0,S.getCurrentTransformInverse)(d),G.PathType.FILL),D=!0);const $=this.current.getClippedPathBoundingBox();this.contentVisible&&$!==null&&(this.pendingEOFill?(d.fill("evenodd"),this.pendingEOFill=!1):d.fill()),D&&d.restore(),h&&this.consumePath($)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=rt}eoClip(){this.pendingClip=ft}beginText(){this.current.textMatrix=f.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const h=this.pendingTextPaths,d=this.ctx;if(h===void 0){d.beginPath();return}d.save(),d.beginPath();for(const v of h)d.setTransform(...v.transform),d.translate(v.x,v.y),v.addToPath(d,v.fontSize);d.restore(),d.clip(),d.beginPath(),delete this.pendingTextPaths}setCharSpacing(h){this.current.charSpacing=h}setWordSpacing(h){this.current.wordSpacing=h}setHScale(h){this.current.textHScale=h/100}setLeading(h){this.current.leading=-h}setFont(h,d){const v=this.commonObjs.get(h),j=this.current;if(!v)throw new Error(`Can't find font for ${h}`);if(j.fontMatrix=v.fontMatrix||f.FONT_IDENTITY_MATRIX,(j.fontMatrix[0]===0||j.fontMatrix[3]===0)&&(0,f.warn)("Invalid font matrix for font "+h),d<0?(d=-d,j.fontDirection=-1):j.fontDirection=1,this.current.font=v,this.current.fontSize=d,v.isType3Font)return;const D=v.loadedName||"sans-serif";let $="normal";v.black?$="900":v.bold&&($="bold");const q=v.italic?"italic":"normal",K=`"${D}", ${v.fallbackName}`;let z=d;d<M?z=M:d>E&&(z=E),this.current.fontSizeScale=d/z,this.ctx.font=`${q} ${$} ${z}px ${K}`}setTextRenderingMode(h){this.current.textRenderingMode=h}setTextRise(h){this.current.textRise=h}moveText(h,d){this.current.x=this.current.lineX+=h,this.current.y=this.current.lineY+=d}setLeadingMoveText(h,d){this.setLeading(-d),this.moveText(h,d)}setTextMatrix(h,d,v,j,D,$){this.current.textMatrix=[h,d,v,j,D,$],this.current.textMatrixScale=Math.hypot(h,d),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(h,d,v,j){const D=this.ctx,$=this.current,q=$.font,K=$.textRenderingMode,z=$.fontSize/$.fontSizeScale,L=K&f.TextRenderingMode.FILL_STROKE_MASK,k=!!(K&f.TextRenderingMode.ADD_TO_PATH_FLAG),e=$.patternFill&&!q.missingFile;let a;(q.disableFontFace||k||e)&&(a=q.getPathGenerator(this.commonObjs,h)),q.disableFontFace||e?(D.save(),D.translate(d,v),D.beginPath(),a(D,z),j&&D.setTransform(...j),(L===f.TextRenderingMode.FILL||L===f.TextRenderingMode.FILL_STROKE)&&D.fill(),(L===f.TextRenderingMode.STROKE||L===f.TextRenderingMode.FILL_STROKE)&&D.stroke(),D.restore()):((L===f.TextRenderingMode.FILL||L===f.TextRenderingMode.FILL_STROKE)&&D.fillText(h,d,v),(L===f.TextRenderingMode.STROKE||L===f.TextRenderingMode.FILL_STROKE)&&D.strokeText(h,d,v)),k&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,S.getCurrentTransform)(D),x:d,y:v,fontSize:z,addToPath:a})}get isFontSubpixelAAEnabled(){const{context:h}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);h.scale(1.5,1),h.fillText("I",0,10);const d=h.getImageData(0,0,10,10).data;let v=!1;for(let j=3;j<d.length;j+=4)if(d[j]>0&&d[j]<255){v=!0;break}return(0,f.shadow)(this,"isFontSubpixelAAEnabled",v)}showText(h){const d=this.current,v=d.font;if(v.isType3Font)return this.showType3Text(h);const j=d.fontSize;if(j===0)return;const D=this.ctx,$=d.fontSizeScale,q=d.charSpacing,K=d.wordSpacing,z=d.fontDirection,L=d.textHScale*z,k=h.length,e=v.vertical,a=e?1:-1,b=v.defaultVMetrics,x=j*d.fontMatrix[0],I=d.textRenderingMode===f.TextRenderingMode.FILL&&!v.disableFontFace&&!d.patternFill;D.save(),D.transform(...d.textMatrix),D.translate(d.x,d.y+d.textRise),z>0?D.scale(L,-1):D.scale(L,1);let N;if(d.patternFill){D.save();const ut=d.fillColor.getPattern(D,this,(0,S.getCurrentTransformInverse)(D),G.PathType.FILL);N=(0,S.getCurrentTransform)(D),D.restore(),D.fillStyle=ut}let nt=d.lineWidth;const tt=d.textMatrixScale;if(tt===0||nt===0){const ut=d.textRenderingMode&f.TextRenderingMode.FILL_STROKE_MASK;(ut===f.TextRenderingMode.STROKE||ut===f.TextRenderingMode.FILL_STROKE)&&(nt=this.getSinglePixelWidth())}else nt/=tt;if($!==1&&(D.scale($,$),nt/=$),D.lineWidth=nt,v.isInvalidPDFjsFont){const ut=[];let ct=0;for(const _t of h)ut.push(_t.unicode),ct+=_t.width;D.fillText(ut.join(""),0,0),d.x+=ct*x*L,D.restore(),this.compose();return}let st=0,at;for(at=0;at<k;++at){const ut=h[at];if(typeof ut=="number"){st+=a*ut*j/1e3;continue}let ct=!1;const _t=(ut.isSpace?K:0)+q,pt=ut.fontChar,Et=ut.accent;let At,Tt,R=ut.width;if(e){const W=ut.vmetric||b,gt=-(ut.vmetric?W[1]:R*.5)*x,Ct=W[2]*x;R=W?-W[0]:R,At=gt/$,Tt=(st+Ct)/$}else At=st/$,Tt=0;if(v.remeasure&&R>0){const W=D.measureText(pt).width*1e3/j*$;if(R<W&&this.isFontSubpixelAAEnabled){const gt=R/W;ct=!0,D.save(),D.scale(gt,1),At/=gt}else R!==W&&(At+=(R-W)/2e3*j/$)}if(this.contentVisible&&(ut.isInFont||v.missingFile)){if(I&&!Et)D.fillText(pt,At,Tt);else if(this.paintChar(pt,At,Tt,N),Et){const W=At+j*Et.offset.x/$,gt=Tt-j*Et.offset.y/$;this.paintChar(Et.fontChar,W,gt,N)}}let U;e?U=R*x-_t*z:U=R*x+_t*z,st+=U,ct&&D.restore()}e?d.y-=st:d.x+=st*L,D.restore(),this.compose()}showType3Text(h){const d=this.ctx,v=this.current,j=v.font,D=v.fontSize,$=v.fontDirection,q=j.vertical?1:-1,K=v.charSpacing,z=v.wordSpacing,L=v.textHScale*$,k=v.fontMatrix||f.FONT_IDENTITY_MATRIX,e=h.length,a=v.textRenderingMode===f.TextRenderingMode.INVISIBLE;let b,x,I,N;if(!(a||D===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,d.save(),d.transform(...v.textMatrix),d.translate(v.x,v.y),d.scale(L,$),b=0;b<e;++b){if(x=h[b],typeof x=="number"){N=q*x*D/1e3,this.ctx.translate(N,0),v.x+=N*L;continue}const nt=(x.isSpace?z:0)+K,tt=j.charProcOperatorList[x.operatorListId];if(!tt){(0,f.warn)(`Type3 character "${x.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=x,this.save(),d.scale(D,D),d.transform(...k),this.executeOperatorList(tt),this.restore()),I=f.Util.applyTransform([x.width,0],k)[0]*D+nt,d.translate(I,0),v.x+=I*L}d.restore(),this.processingType3=null}}setCharWidth(h,d){}setCharWidthAndBounds(h,d,v,j,D,$){this.ctx.rect(v,j,D-v,$-j),this.ctx.clip(),this.endPath()}getColorN_Pattern(h){let d;if(h[0]==="TilingPattern"){const v=h[1],j=this.baseTransform||(0,S.getCurrentTransform)(this.ctx),D={createCanvasGraphics:$=>new yt($,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};d=new G.TilingPattern(h,v,this.ctx,D,j)}else d=this._getPattern(h[1],h[2]);return d}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(h,d,v){const j=f.Util.makeHexColor(h,d,v);this.ctx.strokeStyle=j,this.current.strokeColor=j}setFillRGBColor(h,d,v){const j=f.Util.makeHexColor(h,d,v);this.ctx.fillStyle=j,this.current.fillColor=j,this.current.patternFill=!1}_getPattern(h,d=null){let v;return this.cachedPatterns.has(h)?v=this.cachedPatterns.get(h):(v=(0,G.getShadingPattern)(this.getObject(h)),this.cachedPatterns.set(h,v)),d&&(v.matrix=d),v}shadingFill(h){if(!this.contentVisible)return;const d=this.ctx;this.save();const v=this._getPattern(h);d.fillStyle=v.getPattern(d,this,(0,S.getCurrentTransformInverse)(d),G.PathType.SHADING);const j=(0,S.getCurrentTransformInverse)(d);if(j){const D=d.canvas,$=D.width,q=D.height,K=f.Util.applyTransform([0,0],j),z=f.Util.applyTransform([0,q],j),L=f.Util.applyTransform([$,0],j),k=f.Util.applyTransform([$,q],j),e=Math.min(K[0],z[0],L[0],k[0]),a=Math.min(K[1],z[1],L[1],k[1]),b=Math.max(K[0],z[0],L[0],k[0]),x=Math.max(K[1],z[1],L[1],k[1]);this.ctx.fillRect(e,a,b-e,x-a)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,f.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,f.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(h,d){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(h)&&h.length===6&&this.transform(...h),this.baseTransform=(0,S.getCurrentTransform)(this.ctx),d)){const v=d[2]-d[0],j=d[3]-d[1];this.ctx.rect(d[0],d[1],v,j),this.current.updateRectMinMax((0,S.getCurrentTransform)(this.ctx),d),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(h){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const d=this.ctx;h.isolated||(0,f.info)("TODO: Support non-isolated groups."),h.knockout&&(0,f.warn)("Knockout groups not supported.");const v=(0,S.getCurrentTransform)(d);if(h.matrix&&d.transform(...h.matrix),!h.bbox)throw new Error("Bounding box is required.");let j=f.Util.getAxialAlignedBoundingBox(h.bbox,(0,S.getCurrentTransform)(d));const D=[0,0,d.canvas.width,d.canvas.height];j=f.Util.intersect(j,D)||[0,0,0,0];const $=Math.floor(j[0]),q=Math.floor(j[1]);let K=Math.max(Math.ceil(j[2])-$,1),z=Math.max(Math.ceil(j[3])-q,1),L=1,k=1;K>_&&(L=K/_,K=_),z>_&&(k=z/_,z=_),this.current.startNewPathAndClipBox([0,0,K,z]);let e="groupAt"+this.groupLevel;h.smask&&(e+="_smask_"+this.smaskCounter++%2);const a=this.cachedCanvases.getCanvas(e,K,z),b=a.context;b.scale(1/L,1/k),b.translate(-$,-q),b.transform(...v),h.smask?this.smaskStack.push({canvas:a.canvas,context:b,offsetX:$,offsetY:q,scaleX:L,scaleY:k,subtype:h.smask.subtype,backdrop:h.smask.backdrop,transferMap:h.smask.transferMap||null,startTransformInverse:null}):(d.setTransform(1,0,0,1,0,0),d.translate($,q),d.scale(L,k),d.save()),o(d,b),this.ctx=b,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(d),this.groupLevel++}endGroup(h){if(!this.contentVisible)return;this.groupLevel--;const d=this.ctx,v=this.groupStack.pop();if(this.ctx=v,this.ctx.imageSmoothingEnabled=!1,h.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const j=(0,S.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...j);const D=f.Util.getAxialAlignedBoundingBox([0,0,d.canvas.width,d.canvas.height],j);this.ctx.drawImage(d.canvas,0,0),this.ctx.restore(),this.compose(D)}}beginAnnotation(h,d,v,j,D){if(lt(this,dt,me).call(this),l(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(d)&&d.length===4){const $=d[2]-d[0],q=d[3]-d[1];if(D&&this.annotationCanvasMap){v=v.slice(),v[4]-=d[0],v[5]-=d[1],d=d.slice(),d[0]=d[1]=0,d[2]=$,d[3]=q;const[K,z]=f.Util.singularValueDecompose2dScale((0,S.getCurrentTransform)(this.ctx)),{viewportScale:L}=this,k=Math.ceil($*this.outputScaleX*L),e=Math.ceil(q*this.outputScaleY*L);this.annotationCanvas=this.canvasFactory.create(k,e);const{canvas:a,context:b}=this.annotationCanvas;this.annotationCanvasMap.set(h,a),this.annotationCanvas.savedCtx=this.ctx,this.ctx=b,this.ctx.setTransform(K,0,0,-z,0,q*z),l(this.ctx)}else l(this.ctx),this.ctx.rect(d[0],d[1],$,q),this.ctx.clip(),this.endPath()}this.current=new F(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...v),this.transform(...j)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(h){if(!this.contentVisible)return;const d=h.count;h=this.getObject(h.data,h),h.count=d;const v=this.ctx,j=this.processingType3;if(j&&(j.compiled===void 0&&(j.compiled=P(h)),j.compiled)){j.compiled(v);return}const D=this._createMaskCanvas(h),$=D.canvas;v.save(),v.setTransform(1,0,0,1,0,0),v.drawImage($,D.offsetX,D.offsetY),v.restore(),this.compose()}paintImageMaskXObjectRepeat(h,d,v=0,j=0,D,$){if(!this.contentVisible)return;h=this.getObject(h.data,h);const q=this.ctx;q.save();const K=(0,S.getCurrentTransform)(q);q.transform(d,v,j,D,0,0);const z=this._createMaskCanvas(h);q.setTransform(1,0,0,1,z.offsetX-K[4],z.offsetY-K[5]);for(let L=0,k=$.length;L<k;L+=2){const e=f.Util.transform(K,[d,v,j,D,$[L],$[L+1]]),[a,b]=f.Util.applyTransform([0,0],e);q.drawImage(z.canvas,a,b)}q.restore(),this.compose()}paintImageMaskXObjectGroup(h){if(!this.contentVisible)return;const d=this.ctx,v=this.current.fillColor,j=this.current.patternFill;for(const D of h){const{data:$,width:q,height:K,transform:z}=D,L=this.cachedCanvases.getCanvas("maskCanvas",q,K),k=L.context;k.save();const e=this.getObject($,D);t(k,e),k.globalCompositeOperation="source-in",k.fillStyle=j?v.getPattern(k,this,(0,S.getCurrentTransformInverse)(d),G.PathType.FILL):v,k.fillRect(0,0,q,K),k.restore(),d.save(),d.transform(...z),d.scale(1,-1),i(d,L.canvas,0,0,q,K,0,-1,1,1),d.restore()}this.compose()}paintImageXObject(h){if(!this.contentVisible)return;const d=this.getObject(h);if(!d){(0,f.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(d)}paintImageXObjectRepeat(h,d,v,j){if(!this.contentVisible)return;const D=this.getObject(h);if(!D){(0,f.warn)("Dependent image isn't ready yet");return}const $=D.width,q=D.height,K=[];for(let z=0,L=j.length;z<L;z+=2)K.push({transform:[d,0,0,v,j[z],j[z+1]],x:0,y:0,w:$,h:q});this.paintInlineImageXObjectGroup(D,K)}applyTransferMapsToCanvas(h){return this.current.transferMaps!=="none"&&(h.filter=this.current.transferMaps,h.drawImage(h.canvas,0,0),h.filter="none"),h.canvas}applyTransferMapsToBitmap(h){if(this.current.transferMaps==="none")return h.bitmap;const{bitmap:d,width:v,height:j}=h,D=this.cachedCanvases.getCanvas("inlineImage",v,j),$=D.context;return $.filter=this.current.transferMaps,$.drawImage(d,0,0),$.filter="none",D.canvas}paintInlineImageXObject(h){if(!this.contentVisible)return;const d=h.width,v=h.height,j=this.ctx;this.save(),Q.isNodeJS||(j.filter="none"),j.scale(1/d,-1/v);let D;if(h.bitmap)D=this.applyTransferMapsToBitmap(h);else if(typeof HTMLElement=="function"&&h instanceof HTMLElement||!h.data)D=h;else{const K=this.cachedCanvases.getCanvas("inlineImage",d,v).context;y(K,h),D=this.applyTransferMapsToCanvas(K)}const $=this._scaleImage(D,(0,S.getCurrentTransformInverse)(j));j.imageSmoothingEnabled=X((0,S.getCurrentTransform)(j),h.interpolate),i(j,$.img,0,0,$.paintWidth,$.paintHeight,0,-v,d,v),this.compose(),this.restore()}paintInlineImageXObjectGroup(h,d){if(!this.contentVisible)return;const v=this.ctx;let j;if(h.bitmap)j=h.bitmap;else{const D=h.width,$=h.height,K=this.cachedCanvases.getCanvas("inlineImage",D,$).context;y(K,h),j=this.applyTransferMapsToCanvas(K)}for(const D of d)v.save(),v.transform(...D.transform),v.scale(1,-1),i(v,j,D.x,D.y,D.w,D.h,0,-1,1,1),v.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(h){}markPointProps(h,d){}beginMarkedContent(h){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(h,d){h==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(d)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(h){const d=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(h);const v=this.ctx;this.pendingClip&&(d||(this.pendingClip===ft?v.clip("evenodd"):v.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),v.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const h=(0,S.getCurrentTransform)(this.ctx);if(h[1]===0&&h[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(h[0]),Math.abs(h[3]));else{const d=Math.abs(h[0]*h[3]-h[2]*h[1]),v=Math.hypot(h[0],h[2]),j=Math.hypot(h[1],h[3]);this._cachedGetSinglePixelWidth=Math.max(v,j)/d}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:h}=this.current,d=(0,S.getCurrentTransform)(this.ctx);let v,j;if(d[1]===0&&d[2]===0){const D=Math.abs(d[0]),$=Math.abs(d[3]);if(h===0)v=1/D,j=1/$;else{const q=D*h,K=$*h;v=q<1?1/q:1,j=K<1?1/K:1}}else{const D=Math.abs(d[0]*d[3]-d[2]*d[1]),$=Math.hypot(d[0],d[1]),q=Math.hypot(d[2],d[3]);if(h===0)v=q/D,j=$/D;else{const K=h*D;v=q>K?q/K:1,j=$>K?$/K:1}}this._cachedScaleForStroking=[v,j]}return this._cachedScaleForStroking}rescaleAndStroke(h){const{ctx:d}=this,{lineWidth:v}=this.current,[j,D]=this.getScaleForStroking();if(d.lineWidth=v||1,j===1&&D===1){d.stroke();return}let $,q,K;h&&($=(0,S.getCurrentTransform)(d),q=d.getLineDash().slice(),K=d.lineDashOffset),d.scale(j,D);const z=Math.max(j,D);d.setLineDash(d.getLineDash().map(L=>L/z)),d.lineDashOffset/=z,d.stroke(),h&&(d.setTransform(...$),d.setLineDash(q),d.lineDashOffset=K)}isContentVisible(){for(let h=this.markedContentStack.length-1;h>=0;h--)if(!this.markedContentStack[h].visible)return!1;return!0}};let ot=yt;dt=new WeakSet,me=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},c.CanvasGraphics=ot;for(const B in f.OPS)ot.prototype[B]!==void 0&&(ot.prototype[f.OPS[B]]=ot.prototype[B])},(it,c,H)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TilingPattern=c.PathType=void 0,c.getShadingPattern=A;var f=H(1),S=H(6);const G={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};c.PathType=G;function V(n,i){if(!i)return;const P=i[2]-i[0],F=i[3]-i[1],y=new Path2D;y.rect(i[0],i[1],P,F),n.clip(y)}class Q{constructor(){this.constructor===Q&&(0,f.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,f.unreachable)("Abstract method `getPattern` called.")}}class M extends Q{constructor(i){super(),this._type=i[1],this._bbox=i[2],this._colorStops=i[3],this._p0=i[4],this._p1=i[5],this._r0=i[6],this._r1=i[7],this.matrix=null}_createGradient(i){let P;this._type==="axial"?P=i.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(P=i.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const F of this._colorStops)P.addColorStop(F[0],F[1]);return P}getPattern(i,P,F,y){let t;if(y===G.STROKE||y===G.FILL){const o=P.current.getClippedPathBoundingBox(y,(0,S.getCurrentTransform)(i))||[0,0,0,0],l=Math.ceil(o[2]-o[0])||1,s=Math.ceil(o[3]-o[1])||1,p=P.cachedCanvases.getCanvas("pattern",l,s,!0),T=p.context;T.clearRect(0,0,T.canvas.width,T.canvas.height),T.beginPath(),T.rect(0,0,T.canvas.width,T.canvas.height),T.translate(-o[0],-o[1]),F=f.Util.transform(F,[1,0,0,1,o[0],o[1]]),T.transform(...P.baseTransform),this.matrix&&T.transform(...this.matrix),V(T,this._bbox),T.fillStyle=this._createGradient(T),T.fill(),t=i.createPattern(p.canvas,"no-repeat");const r=new DOMMatrix(F);t.setTransform(r)}else V(i,this._bbox),t=this._createGradient(i);return t}}function E(n,i,P,F,y,t,o,l){const s=i.coords,p=i.colors,T=n.data,r=n.width*4;let O;s[P+1]>s[F+1]&&(O=P,P=F,F=O,O=t,t=o,o=O),s[F+1]>s[y+1]&&(O=F,F=y,y=O,O=o,o=l,l=O),s[P+1]>s[F+1]&&(O=P,P=F,F=O,O=t,t=o,o=O);const X=(s[P]+i.offsetX)*i.scaleX,Y=(s[P+1]+i.offsetY)*i.scaleY,Z=(s[F]+i.offsetX)*i.scaleX,rt=(s[F+1]+i.offsetY)*i.scaleY,ft=(s[y]+i.offsetX)*i.scaleX,ot=(s[y+1]+i.offsetY)*i.scaleY;if(Y>=ot)return;const dt=p[t],bt=p[t+1],yt=p[t+2],B=p[o],h=p[o+1],d=p[o+2],v=p[l],j=p[l+1],D=p[l+2],$=Math.round(Y),q=Math.round(ot);let K,z,L,k,e,a,b,x;for(let I=$;I<=q;I++){if(I<rt){let at;I<Y?at=0:at=(Y-I)/(Y-rt),K=X-(X-Z)*at,z=dt-(dt-B)*at,L=bt-(bt-h)*at,k=yt-(yt-d)*at}else{let at;I>ot?at=1:rt===ot?at=0:at=(rt-I)/(rt-ot),K=Z-(Z-ft)*at,z=B-(B-v)*at,L=h-(h-j)*at,k=d-(d-D)*at}let N;I<Y?N=0:I>ot?N=1:N=(Y-I)/(Y-ot),e=X-(X-ft)*N,a=dt-(dt-v)*N,b=bt-(bt-j)*N,x=yt-(yt-D)*N;const nt=Math.round(Math.min(K,e)),tt=Math.round(Math.max(K,e));let st=r*I+nt*4;for(let at=nt;at<=tt;at++)N=(K-at)/(K-e),N<0?N=0:N>1&&(N=1),T[st++]=z-(z-a)*N|0,T[st++]=L-(L-b)*N|0,T[st++]=k-(k-x)*N|0,T[st++]=255}}function _(n,i,P){const F=i.coords,y=i.colors;let t,o;switch(i.type){case"lattice":const l=i.verticesPerRow,s=Math.floor(F.length/l)-1,p=l-1;for(t=0;t<s;t++){let T=t*l;for(let r=0;r<p;r++,T++)E(n,P,F[T],F[T+1],F[T+l],y[T],y[T+1],y[T+l]),E(n,P,F[T+l+1],F[T+1],F[T+l],y[T+l+1],y[T+1],y[T+l])}break;case"triangles":for(t=0,o=F.length;t<o;t+=3)E(n,P,F[t],F[t+1],F[t+2],y[t],y[t+1],y[t+2]);break;default:throw new Error("illegal figure")}}class w extends Q{constructor(i){super(),this._coords=i[2],this._colors=i[3],this._figures=i[4],this._bounds=i[5],this._bbox=i[7],this._background=i[8],this.matrix=null}_createMeshCanvas(i,P,F){const l=Math.floor(this._bounds[0]),s=Math.floor(this._bounds[1]),p=Math.ceil(this._bounds[2])-l,T=Math.ceil(this._bounds[3])-s,r=Math.min(Math.ceil(Math.abs(p*i[0]*1.1)),3e3),O=Math.min(Math.ceil(Math.abs(T*i[1]*1.1)),3e3),X=p/r,Y=T/O,Z={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-s,scaleX:1/X,scaleY:1/Y},rt=r+2*2,ft=O+2*2,ot=F.getCanvas("mesh",rt,ft,!1),dt=ot.context,bt=dt.createImageData(r,O);if(P){const B=bt.data;for(let h=0,d=B.length;h<d;h+=4)B[h]=P[0],B[h+1]=P[1],B[h+2]=P[2],B[h+3]=255}for(const B of this._figures)_(bt,B,Z);return dt.putImageData(bt,2,2),{canvas:ot.canvas,offsetX:l-2*X,offsetY:s-2*Y,scaleX:X,scaleY:Y}}getPattern(i,P,F,y){V(i,this._bbox);let t;if(y===G.SHADING)t=f.Util.singularValueDecompose2dScale((0,S.getCurrentTransform)(i));else if(t=f.Util.singularValueDecompose2dScale(P.baseTransform),this.matrix){const l=f.Util.singularValueDecompose2dScale(this.matrix);t=[t[0]*l[0],t[1]*l[1]]}const o=this._createMeshCanvas(t,y===G.SHADING?null:this._background,P.cachedCanvases);return y!==G.SHADING&&(i.setTransform(...P.baseTransform),this.matrix&&i.transform(...this.matrix)),i.translate(o.offsetX,o.offsetY),i.scale(o.scaleX,o.scaleY),i.createPattern(o.canvas,"no-repeat")}}class C extends Q{getPattern(){return"hotpink"}}function A(n){switch(n[0]){case"RadialAxial":return new M(n);case"Mesh":return new w(n);case"Dummy":return new C}throw new Error(`Unknown IR type: ${n[0]}`)}const u={COLORED:1,UNCOLORED:2};class g{static get MAX_PATTERN_SIZE(){return(0,f.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(i,P,F,y,t){this.operatorList=i[2],this.matrix=i[3]||[1,0,0,1,0,0],this.bbox=i[4],this.xstep=i[5],this.ystep=i[6],this.paintType=i[7],this.tilingType=i[8],this.color=P,this.ctx=F,this.canvasGraphicsFactory=y,this.baseTransform=t}createPatternCanvas(i){const P=this.operatorList,F=this.bbox,y=this.xstep,t=this.ystep,o=this.paintType,l=this.tilingType,s=this.color,p=this.canvasGraphicsFactory;(0,f.info)("TilingType: "+l);const T=F[0],r=F[1],O=F[2],X=F[3],Y=f.Util.singularValueDecompose2dScale(this.matrix),Z=f.Util.singularValueDecompose2dScale(this.baseTransform),rt=[Y[0]*Z[0],Y[1]*Z[1]],ft=this.getSizeAndScale(y,this.ctx.canvas.width,rt[0]),ot=this.getSizeAndScale(t,this.ctx.canvas.height,rt[1]),dt=i.cachedCanvases.getCanvas("pattern",ft.size,ot.size,!0),bt=dt.context,yt=p.createCanvasGraphics(bt);yt.groupLevel=i.groupLevel,this.setFillAndStrokeStyleToContext(yt,o,s);let B=T,h=r,d=O,v=X;return T<0&&(B=0,d+=Math.abs(T)),r<0&&(h=0,v+=Math.abs(r)),bt.translate(-(ft.scale*B),-(ot.scale*h)),yt.transform(ft.scale,0,0,ot.scale,0,0),bt.save(),this.clipBbox(yt,B,h,d,v),yt.baseTransform=(0,S.getCurrentTransform)(yt.ctx),yt.executeOperatorList(P),yt.endDrawing(),{canvas:dt.canvas,scaleX:ft.scale,scaleY:ot.scale,offsetX:B,offsetY:h}}getSizeAndScale(i,P,F){i=Math.abs(i);const y=Math.max(g.MAX_PATTERN_SIZE,P);let t=Math.ceil(i*F);return t>=y?t=y:F=t/i,{scale:F,size:t}}clipBbox(i,P,F,y,t){const o=y-P,l=t-F;i.ctx.rect(P,F,o,l),i.current.updateRectMinMax((0,S.getCurrentTransform)(i.ctx),[P,F,y,t]),i.clip(),i.endPath()}setFillAndStrokeStyleToContext(i,P,F){const y=i.ctx,t=i.current;switch(P){case u.COLORED:const o=this.ctx;y.fillStyle=o.fillStyle,y.strokeStyle=o.strokeStyle,t.fillColor=o.fillStyle,t.strokeColor=o.strokeStyle;break;case u.UNCOLORED:const l=f.Util.makeHexColor(F[0],F[1],F[2]);y.fillStyle=l,y.strokeStyle=l,t.fillColor=l,t.strokeColor=l;break;default:throw new f.FormatError(`Unsupported paint type: ${P}`)}}getPattern(i,P,F,y){let t=F;y!==G.SHADING&&(t=f.Util.transform(t,P.baseTransform),this.matrix&&(t=f.Util.transform(t,this.matrix)));const o=this.createPatternCanvas(P);let l=new DOMMatrix(t);l=l.translate(o.offsetX,o.offsetY),l=l.scale(1/o.scaleX,1/o.scaleY);const s=i.createPattern(o.canvas,"repeat");return s.setTransform(l),s}}c.TilingPattern=g},(it,c,H)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.convertBlackAndWhiteToRGBA=G,c.convertToRGBA=S,c.grayToRGBA=Q;var f=H(1);function S(M){switch(M.kind){case f.ImageKind.GRAYSCALE_1BPP:return G(M);case f.ImageKind.RGB_24BPP:return V(M)}return null}function G({src:M,srcPos:E=0,dest:_,width:w,height:C,nonBlackColor:A=4294967295,inverseDecode:u=!1}){const g=f.FeatureTest.isLittleEndian?4278190080:255,[n,i]=u?[A,g]:[g,A],P=w>>3,F=w&7,y=M.length;_=new Uint32Array(_.buffer);let t=0;for(let o=0;o<C;o++){for(const s=E+P;E<s;E++){const p=E<y?M[E]:255;_[t++]=p&128?i:n,_[t++]=p&64?i:n,_[t++]=p&32?i:n,_[t++]=p&16?i:n,_[t++]=p&8?i:n,_[t++]=p&4?i:n,_[t++]=p&2?i:n,_[t++]=p&1?i:n}if(F===0)continue;const l=E<y?M[E++]:255;for(let s=0;s<F;s++)_[t++]=l&1<<7-s?i:n}return{srcPos:E,destPos:t}}function V({src:M,srcPos:E=0,dest:_,destPos:w=0,width:C,height:A}){let u=0;const g=M.length>>2,n=new Uint32Array(M.buffer,E,g);if(f.FeatureTest.isLittleEndian){for(;u<g-2;u+=3,w+=4){const i=n[u],P=n[u+1],F=n[u+2];_[w]=i|4278190080,_[w+1]=i>>>24|P<<8|4278190080,_[w+2]=P>>>16|F<<16|4278190080,_[w+3]=F>>>8|4278190080}for(let i=u*4,P=M.length;i<P;i+=3)_[w++]=M[i]|M[i+1]<<8|M[i+2]<<16|4278190080}else{for(;u<g-2;u+=3,w+=4){const i=n[u],P=n[u+1],F=n[u+2];_[w]=i|255,_[w+1]=i<<24|P>>>8|255,_[w+2]=P<<16|F>>>16|255,_[w+3]=F<<8|255}for(let i=u*4,P=M.length;i<P;i+=3)_[w++]=M[i]<<24|M[i+1]<<16|M[i+2]<<8|255}return{srcPos:E,destPos:w}}function Q(M,E){if(f.FeatureTest.isLittleEndian)for(let _=0,w=M.length;_<w;_++)E[_]=M[_]*65793|4278190080;else for(let _=0,w=M.length;_<w;_++)E[_]=M[_]*16843008|255}},(it,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.GlobalWorkerOptions=void 0;const H=Object.create(null);c.GlobalWorkerOptions=H,H.workerPort=null,H.workerSrc=""},(it,c,H)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.MessageHandler=void 0;var f=H(1);const S={UNKNOWN:0,DATA:1,ERROR:2},G={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function V(M){switch(M instanceof Error||typeof M=="object"&&M!==null||(0,f.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),M.name){case"AbortException":return new f.AbortException(M.message);case"MissingPDFException":return new f.MissingPDFException(M.message);case"PasswordException":return new f.PasswordException(M.message,M.code);case"UnexpectedResponseException":return new f.UnexpectedResponseException(M.message,M.status);case"UnknownErrorException":return new f.UnknownErrorException(M.message,M.details);default:return new f.UnknownErrorException(M.message,M.toString())}}class Q{constructor(E,_,w){this.sourceName=E,this.targetName=_,this.comObj=w,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=C=>{const A=C.data;if(A.targetName!==this.sourceName)return;if(A.stream){this._processStreamMessage(A);return}if(A.callback){const g=A.callbackId,n=this.callbackCapabilities[g];if(!n)throw new Error(`Cannot resolve callback ${g}`);if(delete this.callbackCapabilities[g],A.callback===S.DATA)n.resolve(A.data);else if(A.callback===S.ERROR)n.reject(V(A.reason));else throw new Error("Unexpected callback case");return}const u=this.actionHandler[A.action];if(!u)throw new Error(`Unknown action from worker: ${A.action}`);if(A.callbackId){const g=this.sourceName,n=A.sourceName;new Promise(function(i){i(u(A.data))}).then(function(i){w.postMessage({sourceName:g,targetName:n,callback:S.DATA,callbackId:A.callbackId,data:i})},function(i){w.postMessage({sourceName:g,targetName:n,callback:S.ERROR,callbackId:A.callbackId,reason:V(i)})});return}if(A.streamId){this._createStreamSink(A);return}u(A.data)},w.addEventListener("message",this._onComObjOnMessage)}on(E,_){const w=this.actionHandler;if(w[E])throw new Error(`There is already an actionName called "${E}"`);w[E]=_}send(E,_,w){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:E,data:_},w)}sendWithPromise(E,_,w){const C=this.callbackId++,A=(0,f.createPromiseCapability)();this.callbackCapabilities[C]=A;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:E,callbackId:C,data:_},w)}catch(u){A.reject(u)}return A.promise}sendWithStream(E,_,w,C){const A=this.streamId++,u=this.sourceName,g=this.targetName,n=this.comObj;return new ReadableStream({start:i=>{const P=(0,f.createPromiseCapability)();return this.streamControllers[A]={controller:i,startCall:P,pullCall:null,cancelCall:null,isClosed:!1},n.postMessage({sourceName:u,targetName:g,action:E,streamId:A,data:_,desiredSize:i.desiredSize},C),P.promise},pull:i=>{const P=(0,f.createPromiseCapability)();return this.streamControllers[A].pullCall=P,n.postMessage({sourceName:u,targetName:g,stream:G.PULL,streamId:A,desiredSize:i.desiredSize}),P.promise},cancel:i=>{(0,f.assert)(i instanceof Error,"cancel must have a valid reason");const P=(0,f.createPromiseCapability)();return this.streamControllers[A].cancelCall=P,this.streamControllers[A].isClosed=!0,n.postMessage({sourceName:u,targetName:g,stream:G.CANCEL,streamId:A,reason:V(i)}),P.promise}},w)}_createStreamSink(E){const _=E.streamId,w=this.sourceName,C=E.sourceName,A=this.comObj,u=this,g=this.actionHandler[E.action],n={enqueue(i,P=1,F){if(this.isCancelled)return;const y=this.desiredSize;this.desiredSize-=P,y>0&&this.desiredSize<=0&&(this.sinkCapability=(0,f.createPromiseCapability)(),this.ready=this.sinkCapability.promise),A.postMessage({sourceName:w,targetName:C,stream:G.ENQUEUE,streamId:_,chunk:i},F)},close(){this.isCancelled||(this.isCancelled=!0,A.postMessage({sourceName:w,targetName:C,stream:G.CLOSE,streamId:_}),delete u.streamSinks[_])},error(i){(0,f.assert)(i instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,A.postMessage({sourceName:w,targetName:C,stream:G.ERROR,streamId:_,reason:V(i)}))},sinkCapability:(0,f.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:E.desiredSize,ready:null};n.sinkCapability.resolve(),n.ready=n.sinkCapability.promise,this.streamSinks[_]=n,new Promise(function(i){i(g(E.data,n))}).then(function(){A.postMessage({sourceName:w,targetName:C,stream:G.START_COMPLETE,streamId:_,success:!0})},function(i){A.postMessage({sourceName:w,targetName:C,stream:G.START_COMPLETE,streamId:_,reason:V(i)})})}_processStreamMessage(E){const _=E.streamId,w=this.sourceName,C=E.sourceName,A=this.comObj,u=this.streamControllers[_],g=this.streamSinks[_];switch(E.stream){case G.START_COMPLETE:E.success?u.startCall.resolve():u.startCall.reject(V(E.reason));break;case G.PULL_COMPLETE:E.success?u.pullCall.resolve():u.pullCall.reject(V(E.reason));break;case G.PULL:if(!g){A.postMessage({sourceName:w,targetName:C,stream:G.PULL_COMPLETE,streamId:_,success:!0});break}g.desiredSize<=0&&E.desiredSize>0&&g.sinkCapability.resolve(),g.desiredSize=E.desiredSize,new Promise(function(n){n(g.onPull&&g.onPull())}).then(function(){A.postMessage({sourceName:w,targetName:C,stream:G.PULL_COMPLETE,streamId:_,success:!0})},function(n){A.postMessage({sourceName:w,targetName:C,stream:G.PULL_COMPLETE,streamId:_,reason:V(n)})});break;case G.ENQUEUE:if((0,f.assert)(u,"enqueue should have stream controller"),u.isClosed)break;u.controller.enqueue(E.chunk);break;case G.CLOSE:if((0,f.assert)(u,"close should have stream controller"),u.isClosed)break;u.isClosed=!0,u.controller.close(),this._deleteStreamController(u,_);break;case G.ERROR:(0,f.assert)(u,"error should have stream controller"),u.controller.error(V(E.reason)),this._deleteStreamController(u,_);break;case G.CANCEL_COMPLETE:E.success?u.cancelCall.resolve():u.cancelCall.reject(V(E.reason)),this._deleteStreamController(u,_);break;case G.CANCEL:if(!g)break;new Promise(function(n){n(g.onCancel&&g.onCancel(V(E.reason)))}).then(function(){A.postMessage({sourceName:w,targetName:C,stream:G.CANCEL_COMPLETE,streamId:_,success:!0})},function(n){A.postMessage({sourceName:w,targetName:C,stream:G.CANCEL_COMPLETE,streamId:_,reason:V(n)})}),g.sinkCapability.reject(V(E.reason)),g.isCancelled=!0,delete this.streamSinks[_];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(E,_){await Promise.allSettled([E.startCall&&E.startCall.promise,E.pullCall&&E.pullCall.promise,E.cancelCall&&E.cancelCall.promise]),delete this.streamControllers[_]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}c.MessageHandler=Q},(it,c,H)=>{var G,V;Object.defineProperty(c,"__esModule",{value:!0}),c.Metadata=void 0;var f=H(1);class S{constructor({parsedData:M,rawData:E}){et(this,G,void 0);et(this,V,void 0);mt(this,G,M),mt(this,V,E)}getRaw(){return m(this,V)}get(M){return m(this,G).get(M)??null}getAll(){return(0,f.objectFromMap)(m(this,G))}has(M){return m(this,G).has(M)}}G=new WeakMap,V=new WeakMap,c.Metadata=S},(it,c,H)=>{var M,E,_,w,C,A,_e;Object.defineProperty(c,"__esModule",{value:!0}),c.OptionalContentConfig=void 0;var f=H(1),S=H(8);const G=Symbol("INTERNAL");class V{constructor(n,i){et(this,M,!0);this.name=n,this.intent=i}get visible(){return m(this,M)}_setVisible(n,i){n!==G&&(0,f.unreachable)("Internal method `_setVisible` called."),mt(this,M,i)}}M=new WeakMap;class Q{constructor(n){et(this,A);et(this,E,null);et(this,_,new Map);et(this,w,null);et(this,C,null);if(this.name=null,this.creator=null,n!==null){this.name=n.name,this.creator=n.creator,mt(this,C,n.order);for(const i of n.groups)m(this,_).set(i.id,new V(i.name,i.intent));if(n.baseState==="OFF")for(const i of m(this,_).values())i._setVisible(G,!1);for(const i of n.on)m(this,_).get(i)._setVisible(G,!0);for(const i of n.off)m(this,_).get(i)._setVisible(G,!1);mt(this,w,this.getHash())}}isVisible(n){if(m(this,_).size===0)return!0;if(!n)return(0,f.warn)("Optional content group not defined."),!0;if(n.type==="OCG")return m(this,_).has(n.id)?m(this,_).get(n.id).visible:((0,f.warn)(`Optional content group not found: ${n.id}`),!0);if(n.type==="OCMD"){if(n.expression)return lt(this,A,_e).call(this,n.expression);if(!n.policy||n.policy==="AnyOn"){for(const i of n.ids){if(!m(this,_).has(i))return(0,f.warn)(`Optional content group not found: ${i}`),!0;if(m(this,_).get(i).visible)return!0}return!1}else if(n.policy==="AllOn"){for(const i of n.ids){if(!m(this,_).has(i))return(0,f.warn)(`Optional content group not found: ${i}`),!0;if(!m(this,_).get(i).visible)return!1}return!0}else if(n.policy==="AnyOff"){for(const i of n.ids){if(!m(this,_).has(i))return(0,f.warn)(`Optional content group not found: ${i}`),!0;if(!m(this,_).get(i).visible)return!0}return!1}else if(n.policy==="AllOff"){for(const i of n.ids){if(!m(this,_).has(i))return(0,f.warn)(`Optional content group not found: ${i}`),!0;if(m(this,_).get(i).visible)return!1}return!0}return(0,f.warn)(`Unknown optional content policy ${n.policy}.`),!0}return(0,f.warn)(`Unknown group type ${n.type}.`),!0}setVisibility(n,i=!0){if(!m(this,_).has(n)){(0,f.warn)(`Optional content group not found: ${n}`);return}m(this,_).get(n)._setVisible(G,!!i),mt(this,E,null)}get hasInitialVisibility(){return this.getHash()===m(this,w)}getOrder(){return m(this,_).size?m(this,C)?m(this,C).slice():[...m(this,_).keys()]:null}getGroups(){return m(this,_).size>0?(0,f.objectFromMap)(m(this,_)):null}getGroup(n){return m(this,_).get(n)||null}getHash(){if(m(this,E)!==null)return m(this,E);const n=new S.MurmurHash3_64;for(const[i,P]of m(this,_))n.update(`${i}:${P.visible}`);return mt(this,E,n.hexdigest())}}E=new WeakMap,_=new WeakMap,w=new WeakMap,C=new WeakMap,A=new WeakSet,_e=function(n){const i=n.length;if(i<2)return!0;const P=n[0];for(let F=1;F<i;F++){const y=n[F];let t;if(Array.isArray(y))t=lt(this,A,_e).call(this,y);else if(m(this,_).has(y))t=m(this,_).get(y).visible;else return(0,f.warn)(`Optional content group not found: ${y}`),!0;switch(P){case"And":if(!t)return!1;break;case"Or":if(t)return!0;break;case"Not":return!t;default:return!0}}return P==="And"},c.OptionalContentConfig=Q},(it,c,H)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PDFDataTransportStream=void 0;var f=H(1),S=H(6);class G{constructor({length:E,initialData:_,progressiveDone:w=!1,contentDispositionFilename:C=null,disableRange:A=!1,disableStream:u=!1},g){if((0,f.assert)(g,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=w,this._contentDispositionFilename=C,(_==null?void 0:_.length)>0){const n=_ instanceof Uint8Array&&_.byteLength===_.buffer.byteLength?_.buffer:new Uint8Array(_).buffer;this._queuedChunks.push(n)}this._pdfDataRangeTransport=g,this._isStreamingSupported=!u,this._isRangeSupported=!A,this._contentLength=E,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((n,i)=>{this._onReceiveData({begin:n,chunk:i})}),this._pdfDataRangeTransport.addProgressListener((n,i)=>{this._onProgress({loaded:n,total:i})}),this._pdfDataRangeTransport.addProgressiveReadListener(n=>{this._onReceiveData({chunk:n})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:E,chunk:_}){const w=_ instanceof Uint8Array&&_.byteLength===_.buffer.byteLength?_.buffer:new Uint8Array(_).buffer;if(E===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(w):this._queuedChunks.push(w);else{const C=this._rangeReaders.some(function(A){return A._begin!==E?!1:(A._enqueue(w),!0)});(0,f.assert)(C,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var E;return((E=this._fullRequestReader)==null?void 0:E._loaded)??0}_onProgress(E){var _,w,C,A;E.total===void 0?(w=(_=this._rangeReaders[0])==null?void 0:_.onProgress)==null||w.call(_,{loaded:E.loaded}):(A=(C=this._fullRequestReader)==null?void 0:C.onProgress)==null||A.call(C,{loaded:E.loaded,total:E.total})}_onProgressiveDone(){var E;(E=this._fullRequestReader)==null||E.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(E){const _=this._rangeReaders.indexOf(E);_>=0&&this._rangeReaders.splice(_,1)}getFullReader(){(0,f.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const E=this._queuedChunks;return this._queuedChunks=null,new V(this,E,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(E,_){if(_<=this._progressiveDataLength)return null;const w=new Q(this,E,_);return this._pdfDataRangeTransport.requestDataRange(E,_),this._rangeReaders.push(w),w}cancelAllRequests(E){var _;(_=this._fullRequestReader)==null||_.cancel(E);for(const w of this._rangeReaders.slice(0))w.cancel(E);this._pdfDataRangeTransport.abort()}}c.PDFDataTransportStream=G;class V{constructor(E,_,w=!1,C=null){this._stream=E,this._done=w||!1,this._filename=(0,S.isPdfFile)(C)?C:null,this._queuedChunks=_||[],this._loaded=0;for(const A of this._queuedChunks)this._loaded+=A.byteLength;this._requests=[],this._headersReady=Promise.resolve(),E._fullRequestReader=this,this.onProgress=null}_enqueue(E){this._done||(this._requests.length>0?this._requests.shift().resolve({value:E,done:!1}):this._queuedChunks.push(E),this._loaded+=E.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const E=(0,f.createPromiseCapability)();return this._requests.push(E),E.promise}cancel(E){this._done=!0;for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Q{constructor(E,_,w){this._stream=E,this._begin=_,this._end=w,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(E){if(!this._done){if(this._requests.length===0)this._queuedChunk=E;else{this._requests.shift().resolve({value:E,done:!1});for(const w of this._requests)w.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const _=this._queuedChunk;return this._queuedChunk=null,{value:_,done:!1}}if(this._done)return{value:void 0,done:!0};const E=(0,f.createPromiseCapability)();return this._requests.push(E),E.promise}cancel(E){this._done=!0;for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(it,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.XfaText=void 0;class H{static textContent(S){const G=[],V={items:G,styles:Object.create(null)};function Q(M){var w;if(!M)return;let E=null;const _=M.name;if(_==="#text")E=M.value;else if(H.shouldBuildText(_))(w=M==null?void 0:M.attributes)!=null&&w.textContent?E=M.attributes.textContent:M.value&&(E=M.value);else return;if(E!==null&&G.push({str:E}),!!M.children)for(const C of M.children)Q(C)}return Q(S),V}static shouldBuildText(S){return!(S==="textarea"||S==="input"||S==="option"||S==="select")}}c.XfaText=H},(it,c,H)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.NodeStandardFontDataFactory=c.NodeFilterFactory=c.NodeCanvasFactory=c.NodeCMapReaderFactory=void 0;var f=H(7);const S=function(E){return new Promise((_,w)=>{require$$5.readFile(E,(A,u)=>{if(A||!u){w(new Error(A));return}_(new Uint8Array(u))})})};class G extends f.BaseFilterFactory{}c.NodeFilterFactory=G;class V extends f.BaseCanvasFactory{_createCanvas(_,w){return require$$5.createCanvas(_,w)}}c.NodeCanvasFactory=V;class Q extends f.BaseCMapReaderFactory{_fetchData(_,w){return S(_).then(C=>({cMapData:C,compressionType:w}))}}c.NodeCMapReaderFactory=Q;class M extends f.BaseStandardFontDataFactory{_fetchData(_){return S(_)}}c.NodeStandardFontDataFactory=M},(it,c,H)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PDFNodeStream=void 0;var f=H(1),S=H(22);const G=require$$5,V=require$$5,Q=require$$5,M=require$$5,E=/^file:\/\/\/[a-zA-Z]:\//;function _(F){const y=M.parse(F);return y.protocol==="file:"||y.host?y:/^[a-z]:[/\\]/i.test(F)?M.parse(`file:///${F}`):(y.host||(y.protocol="file:"),y)}class w{constructor(y){this.source=y,this.url=_(y.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&y.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var y;return((y=this._fullRequestReader)==null?void 0:y._loaded)??0}getFullReader(){return(0,f.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new i(this):new g(this),this._fullRequestReader}getRangeReader(y,t){if(t<=this._progressiveDataLength)return null;const o=this.isFsUrl?new P(this,y,t):new n(this,y,t);return this._rangeRequestReaders.push(o),o}cancelAllRequests(y){var t;(t=this._fullRequestReader)==null||t.cancel(y);for(const o of this._rangeRequestReaders.slice(0))o.cancel(y)}}c.PDFNodeStream=w;class C{constructor(y){this._url=y.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=y.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=(0,f.createPromiseCapability)(),this._headersCapability=(0,f.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var o;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const y=this._readableStream.read();return y===null?(this._readCapability=(0,f.createPromiseCapability)(),this.read()):(this._loaded+=y.length,(o=this.onProgress)==null||o.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(y).buffer,done:!1})}cancel(y){if(!this._readableStream){this._error(y);return}this._readableStream.destroy(y)}_error(y){this._storedError=y,this._readCapability.resolve()}_setReadableStream(y){this._readableStream=y,y.on("readable",()=>{this._readCapability.resolve()}),y.on("end",()=>{y.destroy(),this._done=!0,this._readCapability.resolve()}),y.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new f.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class A{constructor(y){this._url=y.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,f.createPromiseCapability)();const t=y.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var o;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const y=this._readableStream.read();return y===null?(this._readCapability=(0,f.createPromiseCapability)(),this.read()):(this._loaded+=y.length,(o=this.onProgress)==null||o.call(this,{loaded:this._loaded}),{value:new Uint8Array(y).buffer,done:!1})}cancel(y){if(!this._readableStream){this._error(y);return}this._readableStream.destroy(y)}_error(y){this._storedError=y,this._readCapability.resolve()}_setReadableStream(y){this._readableStream=y,y.on("readable",()=>{this._readCapability.resolve()}),y.on("end",()=>{y.destroy(),this._done=!0,this._readCapability.resolve()}),y.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function u(F,y){return{protocol:F.protocol,auth:F.auth,host:F.hostname,port:F.port,path:F.path,method:"GET",headers:y}}class g extends C{constructor(y){super(y);const t=o=>{if(o.statusCode===404){const T=new f.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=T,this._headersCapability.reject(T);return}this._headersCapability.resolve(),this._setReadableStream(o);const l=T=>this._readableStream.headers[T.toLowerCase()],{allowRangeRequests:s,suggestedLength:p}=(0,S.validateRangeRequestCapabilities)({getResponseHeader:l,isHttp:y.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=p||this._contentLength,this._filename=(0,S.extractFilenameFromHeader)(l)};this._request=null,this._url.protocol==="http:"?this._request=V.request(u(this._url,y.httpHeaders),t):this._request=Q.request(u(this._url,y.httpHeaders),t),this._request.on("error",o=>{this._storedError=o,this._headersCapability.reject(o)}),this._request.end()}}class n extends A{constructor(y,t,o){super(y),this._httpHeaders={};for(const s in y.httpHeaders){const p=y.httpHeaders[s];p!==void 0&&(this._httpHeaders[s]=p)}this._httpHeaders.Range=`bytes=${t}-${o-1}`;const l=s=>{if(s.statusCode===404){const p=new f.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=p;return}this._setReadableStream(s)};this._request=null,this._url.protocol==="http:"?this._request=V.request(u(this._url,this._httpHeaders),l):this._request=Q.request(u(this._url,this._httpHeaders),l),this._request.on("error",s=>{this._storedError=s}),this._request.end()}}class i extends C{constructor(y){super(y);let t=decodeURIComponent(this._url.path);E.test(this._url.href)&&(t=t.replace(/^\//,"")),G.lstat(t,(o,l)=>{if(o){o.code==="ENOENT"&&(o=new f.MissingPDFException(`Missing PDF "${t}".`)),this._storedError=o,this._headersCapability.reject(o);return}this._contentLength=l.size,this._setReadableStream(G.createReadStream(t)),this._headersCapability.resolve()})}}class P extends A{constructor(y,t,o){super(y);let l=decodeURIComponent(this._url.path);E.test(this._url.href)&&(l=l.replace(/^\//,"")),this._setReadableStream(G.createReadStream(l,{start:t,end:o-1}))}}},(it,c,H)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.createResponseStatusError=M,c.extractFilenameFromHeader=Q,c.validateRangeRequestCapabilities=V,c.validateResponseStatus=E;var f=H(1),S=H(23),G=H(6);function V({getResponseHeader:_,isHttp:w,rangeChunkSize:C,disableRange:A}){const u={allowRangeRequests:!1,suggestedLength:void 0},g=parseInt(_("Content-Length"),10);return!Number.isInteger(g)||(u.suggestedLength=g,g<=2*C)||A||!w||_("Accept-Ranges")!=="bytes"||(_("Content-Encoding")||"identity")!=="identity"||(u.allowRangeRequests=!0),u}function Q(_){const w=_("Content-Disposition");if(w){let C=(0,S.getFilenameFromContentDispositionHeader)(w);if(C.includes("%"))try{C=decodeURIComponent(C)}catch{}if((0,G.isPdfFile)(C))return C}return null}function M(_,w){return _===404||_===0&&w.startsWith("file:")?new f.MissingPDFException('Missing PDF "'+w+'".'):new f.UnexpectedResponseException(`Unexpected server response (${_}) while retrieving PDF "${w}".`,_)}function E(_){return _===200||_===206}},(it,c,H)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.getFilenameFromContentDispositionHeader=S;var f=H(1);function S(G){let V=!0,Q=M("filename\\*","i").exec(G);if(Q){Q=Q[1];let g=C(Q);return g=unescape(g),g=A(g),g=u(g),_(g)}if(Q=w(G),Q){const g=u(Q);return _(g)}if(Q=M("filename","i").exec(G),Q){Q=Q[1];let g=C(Q);return g=u(g),_(g)}function M(g,n){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',n)}function E(g,n){if(g){if(!/^[\x00-\xFF]+$/.test(n))return n;try{const i=new TextDecoder(g,{fatal:!0}),P=(0,f.stringToBytes)(n);n=i.decode(P),V=!1}catch{}}return n}function _(g){return V&&/[\x80-\xff]/.test(g)&&(g=E("utf-8",g),V&&(g=E("iso-8859-1",g))),g}function w(g){const n=[];let i;const P=M("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(i=P.exec(g))!==null;){let[,y,t,o]=i;if(y=parseInt(y,10),y in n){if(y===0)break;continue}n[y]=[t,o]}const F=[];for(let y=0;y<n.length&&y in n;++y){let[t,o]=n[y];o=C(o),t&&(o=unescape(o),y===0&&(o=A(o))),F.push(o)}return F.join("")}function C(g){if(g.startsWith('"')){const n=g.slice(1).split('\\"');for(let i=0;i<n.length;++i){const P=n[i].indexOf('"');P!==-1&&(n[i]=n[i].slice(0,P),n.length=i+1),n[i]=n[i].replaceAll(/\\(.)/g,"$1")}g=n.join('"')}return g}function A(g){const n=g.indexOf("'");if(n===-1)return g;const i=g.slice(0,n),F=g.slice(n+1).replace(/^[^']*'/,"");return E(i,F)}function u(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(n,i,P,F){if(P==="q"||P==="Q")return F=F.replaceAll("_"," "),F=F.replaceAll(/=([0-9a-fA-F]{2})/g,function(y,t){return String.fromCharCode(parseInt(t,16))}),E(i,F);try{F=atob(F)}catch{}return E(i,F)})}return""}},(it,c,H)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PDFNetworkStream=void 0;var f=H(1),S=H(22);const G=200,V=206;function Q(C){const A=C.response;return typeof A!="string"?A:(0,f.stringToBytes)(A).buffer}class M{constructor(A,u={}){this.url=A,this.isHttp=/^https?:/i.test(A),this.httpHeaders=this.isHttp&&u.httpHeaders||Object.create(null),this.withCredentials=u.withCredentials||!1,this.getXhr=u.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(A,u,g){const n={begin:A,end:u};for(const i in g)n[i]=g[i];return this.request(n)}requestFull(A){return this.request(A)}request(A){const u=this.getXhr(),g=this.currXhrId++,n=this.pendingRequests[g]={xhr:u};u.open("GET",this.url),u.withCredentials=this.withCredentials;for(const i in this.httpHeaders){const P=this.httpHeaders[i];P!==void 0&&u.setRequestHeader(i,P)}return this.isHttp&&"begin"in A&&"end"in A?(u.setRequestHeader("Range",`bytes=${A.begin}-${A.end-1}`),n.expectedStatus=V):n.expectedStatus=G,u.responseType="arraybuffer",A.onError&&(u.onerror=function(i){A.onError(u.status)}),u.onreadystatechange=this.onStateChange.bind(this,g),u.onprogress=this.onProgress.bind(this,g),n.onHeadersReceived=A.onHeadersReceived,n.onDone=A.onDone,n.onError=A.onError,n.onProgress=A.onProgress,u.send(null),g}onProgress(A,u){var n;const g=this.pendingRequests[A];g&&((n=g.onProgress)==null||n.call(g,u))}onStateChange(A,u){var y,t,o;const g=this.pendingRequests[A];if(!g)return;const n=g.xhr;if(n.readyState>=2&&g.onHeadersReceived&&(g.onHeadersReceived(),delete g.onHeadersReceived),n.readyState!==4||!(A in this.pendingRequests))return;if(delete this.pendingRequests[A],n.status===0&&this.isHttp){(y=g.onError)==null||y.call(g,n.status);return}const i=n.status||G;if(!(i===G&&g.expectedStatus===V)&&i!==g.expectedStatus){(t=g.onError)==null||t.call(g,n.status);return}const F=Q(n);if(i===V){const l=n.getResponseHeader("Content-Range"),s=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);g.onDone({begin:parseInt(s[1],10),chunk:F})}else F?g.onDone({begin:0,chunk:F}):(o=g.onError)==null||o.call(g,n.status)}getRequestXhr(A){return this.pendingRequests[A].xhr}isPendingRequest(A){return A in this.pendingRequests}abortRequest(A){const u=this.pendingRequests[A].xhr;delete this.pendingRequests[A],u.abort()}}class E{constructor(A){this._source=A,this._manager=new M(A.url,{httpHeaders:A.httpHeaders,withCredentials:A.withCredentials}),this._rangeChunkSize=A.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(A){const u=this._rangeRequestReaders.indexOf(A);u>=0&&this._rangeRequestReaders.splice(u,1)}getFullReader(){return(0,f.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new _(this._manager,this._source),this._fullRequestReader}getRangeReader(A,u){const g=new w(this._manager,A,u);return g.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(g),g}cancelAllRequests(A){var u;(u=this._fullRequestReader)==null||u.cancel(A);for(const g of this._rangeRequestReaders.slice(0))g.cancel(A)}}c.PDFNetworkStream=E;class _{constructor(A,u){this._manager=A;const g={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=u.url,this._fullRequestId=A.requestFull(g),this._headersReceivedCapability=(0,f.createPromiseCapability)(),this._disableRange=u.disableRange||!1,this._contentLength=u.length,this._rangeChunkSize=u.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const A=this._fullRequestId,u=this._manager.getRequestXhr(A),g=P=>u.getResponseHeader(P),{allowRangeRequests:n,suggestedLength:i}=(0,S.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});n&&(this._isRangeSupported=!0),this._contentLength=i||this._contentLength,this._filename=(0,S.extractFilenameFromHeader)(g),this._isRangeSupported&&this._manager.abortRequest(A),this._headersReceivedCapability.resolve()}_onDone(A){if(A&&(this._requests.length>0?this._requests.shift().resolve({value:A.chunk,done:!1}):this._cachedChunks.push(A.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(A){this._storedError=(0,S.createResponseStatusError)(A,this._url),this._headersReceivedCapability.reject(this._storedError);for(const u of this._requests)u.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(A){var u;(u=this.onProgress)==null||u.call(this,{loaded:A.loaded,total:A.lengthComputable?A.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const A=(0,f.createPromiseCapability)();return this._requests.push(A),A.promise}cancel(A){this._done=!0,this._headersReceivedCapability.reject(A);for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class w{constructor(A,u,g){this._manager=A;const n={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=A.url,this._requestId=A.requestRange(u,g,n),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var A;(A=this.onClosed)==null||A.call(this,this)}_onDone(A){const u=A.chunk;this._requests.length>0?this._requests.shift().resolve({value:u,done:!1}):this._queuedChunk=u,this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(A){this._storedError=(0,S.createResponseStatusError)(A,this._url);for(const u of this._requests)u.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(A){var u;this.isStreamingSupported||(u=this.onProgress)==null||u.call(this,{loaded:A.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const u=this._queuedChunk;return this._queuedChunk=null,{value:u,done:!1}}if(this._done)return{value:void 0,done:!0};const A=(0,f.createPromiseCapability)();return this._requests.push(A),A.promise}cancel(A){this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(it,c,H)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PDFFetchStream=void 0;var f=H(1),S=H(22);function G(w,C,A){return{method:"GET",headers:w,signal:A.signal,mode:"cors",credentials:C?"include":"same-origin",redirect:"follow"}}function V(w){const C=new Headers;for(const A in w){const u=w[A];u!==void 0&&C.append(A,u)}return C}function Q(w){return w instanceof Uint8Array?w.buffer:w instanceof ArrayBuffer?w:((0,f.warn)(`getArrayBuffer - unexpected data format: ${w}`),new Uint8Array(w).buffer)}class M{constructor(C){this.source=C,this.isHttp=/^https?:/i.test(C.url),this.httpHeaders=this.isHttp&&C.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var C;return((C=this._fullRequestReader)==null?void 0:C._loaded)??0}getFullReader(){return(0,f.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new E(this),this._fullRequestReader}getRangeReader(C,A){if(A<=this._progressiveDataLength)return null;const u=new _(this,C,A);return this._rangeRequestReaders.push(u),u}cancelAllRequests(C){var A;(A=this._fullRequestReader)==null||A.cancel(C);for(const u of this._rangeRequestReaders.slice(0))u.cancel(C)}}c.PDFFetchStream=M;class E{constructor(C){this._stream=C,this._reader=null,this._loaded=0,this._filename=null;const A=C.source;this._withCredentials=A.withCredentials||!1,this._contentLength=A.length,this._headersCapability=(0,f.createPromiseCapability)(),this._disableRange=A.disableRange||!1,this._rangeChunkSize=A.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!A.disableStream,this._isRangeSupported=!A.disableRange,this._headers=V(this._stream.httpHeaders);const u=A.url;fetch(u,G(this._headers,this._withCredentials,this._abortController)).then(g=>{if(!(0,S.validateResponseStatus)(g.status))throw(0,S.createResponseStatusError)(g.status,u);this._reader=g.body.getReader(),this._headersCapability.resolve();const n=F=>g.headers.get(F),{allowRangeRequests:i,suggestedLength:P}=(0,S.validateRangeRequestCapabilities)({getResponseHeader:n,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=i,this._contentLength=P||this._contentLength,this._filename=(0,S.extractFilenameFromHeader)(n),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new f.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var u;await this._headersCapability.promise;const{value:C,done:A}=await this._reader.read();return A?{value:C,done:A}:(this._loaded+=C.byteLength,(u=this.onProgress)==null||u.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Q(C),done:!1})}cancel(C){var A;(A=this._reader)==null||A.cancel(C),this._abortController.abort()}}class _{constructor(C,A,u){this._stream=C,this._reader=null,this._loaded=0;const g=C.source;this._withCredentials=g.withCredentials||!1,this._readCapability=(0,f.createPromiseCapability)(),this._isStreamingSupported=!g.disableStream,this._abortController=new AbortController,this._headers=V(this._stream.httpHeaders),this._headers.append("Range",`bytes=${A}-${u-1}`);const n=g.url;fetch(n,G(this._headers,this._withCredentials,this._abortController)).then(i=>{if(!(0,S.validateResponseStatus)(i.status))throw(0,S.createResponseStatusError)(i.status,n);this._readCapability.resolve(),this._reader=i.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var u;await this._readCapability.promise;const{value:C,done:A}=await this._reader.read();return A?{value:C,done:A}:(this._loaded+=C.byteLength,(u=this.onProgress)==null||u.call(this,{loaded:this._loaded}),{value:Q(C),done:!1})}cancel(C){var A;(A=this._reader)==null||A.cancel(C),this._abortController.abort()}}},(it,c,H)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TextLayerRenderTask=void 0,c.renderTextLayer=g,c.updateTextLayer=n;var f=H(1),S=H(6);const G=1e5,V=30,Q=.8,M=new Map;function E(i,P){let F;if(P&&f.FeatureTest.isOffscreenCanvasSupported)F=new OffscreenCanvas(i,i).getContext("2d",{alpha:!1});else{const y=document.createElement("canvas");y.width=y.height=i,F=y.getContext("2d",{alpha:!1})}return F}function _(i,P){const F=M.get(i);if(F)return F;const y=E(V,P);y.font=`${V}px ${i}`;const t=y.measureText("");let o=t.fontBoundingBoxAscent,l=Math.abs(t.fontBoundingBoxDescent);if(o){const p=o/(o+l);return M.set(i,p),y.canvas.width=y.canvas.height=0,p}y.strokeStyle="red",y.clearRect(0,0,V,V),y.strokeText("g",0,0);let s=y.getImageData(0,0,V,V).data;l=0;for(let p=s.length-1-3;p>=0;p-=4)if(s[p]>0){l=Math.ceil(p/4/V);break}y.clearRect(0,0,V,V),y.strokeText("A",0,V),s=y.getImageData(0,0,V,V).data,o=0;for(let p=0,T=s.length;p<T;p+=4)if(s[p]>0){o=V-Math.floor(p/4/V);break}if(y.canvas.width=y.canvas.height=0,o){const p=o/(o+l);return M.set(i,p),p}return M.set(i,Q),Q}function w(i,P,F){const y=document.createElement("span"),t={angle:0,canvasWidth:0,hasText:P.str!=="",hasEOL:P.hasEOL,fontSize:0};i._textDivs.push(y);const o=f.Util.transform(i._transform,P.transform);let l=Math.atan2(o[1],o[0]);const s=F[P.fontName];s.vertical&&(l+=Math.PI/2);const p=Math.hypot(o[2],o[3]),T=p*_(s.fontFamily,i._isOffscreenCanvasSupported);let r,O;l===0?(r=o[4],O=o[5]-T):(r=o[4]+T*Math.sin(l),O=o[5]-T*Math.cos(l));const X="calc(var(--scale-factor)*",Y=y.style;i._container===i._rootContainer?(Y.left=`${(100*r/i._pageWidth).toFixed(2)}%`,Y.top=`${(100*O/i._pageHeight).toFixed(2)}%`):(Y.left=`${X}${r.toFixed(2)}px)`,Y.top=`${X}${O.toFixed(2)}px)`),Y.fontSize=`${X}${p.toFixed(2)}px)`,Y.fontFamily=s.fontFamily,t.fontSize=p,y.setAttribute("role","presentation"),y.textContent=P.str,y.dir=P.dir,i._fontInspectorEnabled&&(y.dataset.fontName=P.fontName),l!==0&&(t.angle=l*(180/Math.PI));let Z=!1;if(P.str.length>1)Z=!0;else if(P.str!==" "&&P.transform[0]!==P.transform[3]){const rt=Math.abs(P.transform[0]),ft=Math.abs(P.transform[3]);rt!==ft&&Math.max(rt,ft)/Math.min(rt,ft)>1.5&&(Z=!0)}Z&&(t.canvasWidth=s.vertical?P.height:P.width),i._textDivProperties.set(y,t),i._isReadableStream&&i._layoutText(y)}function C(i){const{div:P,scale:F,properties:y,ctx:t,prevFontSize:o,prevFontFamily:l}=i,{style:s}=P;let p="";if(y.canvasWidth!==0&&y.hasText){const{fontFamily:T}=s,{canvasWidth:r,fontSize:O}=y;(o!==O||l!==T)&&(t.font=`${O*F}px ${T}`,i.prevFontSize=O,i.prevFontFamily=T);const{width:X}=t.measureText(P.textContent);X>0&&(p=`scaleX(${r*F/X})`)}y.angle!==0&&(p=`rotate(${y.angle}deg) ${p}`),p.length>0&&(s.transform=p)}function A(i){if(i._canceled)return;const P=i._textDivs,F=i._capability;if(P.length>G){F.resolve();return}if(!i._isReadableStream)for(const t of P)i._layoutText(t);F.resolve()}class u{constructor({textContentSource:P,container:F,viewport:y,textDivs:t,textDivProperties:o,textContentItemsStr:l,isOffscreenCanvasSupported:s}){var X;this._textContentSource=P,this._isReadableStream=P instanceof ReadableStream,this._container=this._rootContainer=F,this._textDivs=t||[],this._textContentItemsStr=l||[],this._isOffscreenCanvasSupported=s,this._fontInspectorEnabled=!!((X=globalThis.FontInspector)!=null&&X.enabled),this._reader=null,this._textDivProperties=o||new WeakMap,this._canceled=!1,this._capability=(0,f.createPromiseCapability)(),this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:y.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:E(0,s)};const{pageWidth:p,pageHeight:T,pageX:r,pageY:O}=y.rawDims;this._transform=[1,0,0,-1,-r,O+T],this._pageWidth=p,this._pageHeight=T,(0,S.setLayerDimensions)(F,y),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new f.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new f.AbortException("TextLayer task cancelled."))}_processItems(P,F){for(const y of P){if(y.str===void 0){if(y.type==="beginMarkedContentProps"||y.type==="beginMarkedContent"){const t=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),y.id!==null&&this._container.setAttribute("id",`${y.id}`),t.append(this._container)}else y.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(y.str),w(this,y,F)}}_layoutText(P){const F=this._layoutTextParams.properties=this._textDivProperties.get(P);if(this._layoutTextParams.div=P,C(this._layoutTextParams),F.hasText&&this._container.append(P),F.hasEOL){const y=document.createElement("br");y.setAttribute("role","presentation"),this._container.append(y)}}_render(){const P=(0,f.createPromiseCapability)();let F=Object.create(null);if(this._isReadableStream){const y=()=>{this._reader.read().then(({value:t,done:o})=>{if(o){P.resolve();return}Object.assign(F,t.styles),this._processItems(t.items,F),y()},P.reject)};this._reader=this._textContentSource.getReader(),y()}else if(this._textContentSource){const{items:y,styles:t}=this._textContentSource;this._processItems(y,t),P.resolve()}else throw new Error('No "textContentSource" parameter specified.');P.promise.then(()=>{F=null,A(this)},this._capability.reject)}}c.TextLayerRenderTask=u;function g(i){!i.textContentSource&&(i.textContent||i.textContentStream)&&((0,S.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),i.textContentSource=i.textContent||i.textContentStream);const{container:P,viewport:F}=i,y=getComputedStyle(P),t=y.getPropertyValue("visibility"),o=parseFloat(y.getPropertyValue("--scale-factor"));t==="visible"&&(!o||Math.abs(o-F.scale)>1e-15)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const l=new u(i);return l._render(),l}function n({container:i,viewport:P,textDivs:F,textDivProperties:y,isOffscreenCanvasSupported:t,mustRotate:o=!0,mustRescale:l=!0}){if(o&&(0,S.setLayerDimensions)(i,{rotation:P.rotation}),l){const s=E(0,t),T={prevFontSize:null,prevFontFamily:null,div:null,scale:P.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:s};for(const r of F)T.properties=y.get(r),T.div=r,C(T)}}},(it,c,H)=>{var E,_,w,C,A,u,g,n,i,be,F,Be,t,Ae,l,ye;Object.defineProperty(c,"__esModule",{value:!0}),c.AnnotationEditorLayer=void 0;var f=H(1),S=H(5),G=H(28),V=H(29),Q=H(6);const p=class{constructor(r){et(this,i);et(this,F);et(this,t);et(this,l);et(this,E,void 0);et(this,_,!1);et(this,w,this.pointerup.bind(this));et(this,C,this.pointerdown.bind(this));et(this,A,new Map);et(this,u,!1);et(this,g,!1);et(this,n,void 0);p._initialized||(p._initialized=!0,G.FreeTextEditor.initialize(r.l10n),V.InkEditor.initialize(r.l10n)),r.uiManager.registerEditorTypes([G.FreeTextEditor,V.InkEditor]),mt(this,n,r.uiManager),this.pageIndex=r.pageIndex,this.div=r.div,mt(this,E,r.accessibilityManager),m(this,n).addLayer(this)}get isEmpty(){return m(this,A).size===0}updateToolbar(r){m(this,n).updateToolbar(r)}updateMode(r=m(this,n).getMode()){lt(this,l,ye).call(this),r===f.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),m(this,n).unselectAll(),r!==f.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",r===f.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",r===f.AnnotationEditorType.INK),this.div.hidden=!1)}addInkEditorIfNeeded(r){if(!r&&m(this,n).getMode()!==f.AnnotationEditorType.INK)return;if(!r){for(const X of m(this,A).values())if(X.isEmpty()){X.setInBackground();return}}lt(this,t,Ae).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(r){m(this,n).setEditingState(r)}addCommands(r){m(this,n).addCommands(r)}enable(){this.div.style.pointerEvents="auto";for(const r of m(this,A).values())r.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const r of m(this,A).values())r.disableEditing();lt(this,l,ye).call(this),this.isEmpty&&(this.div.hidden=!0)}setActiveEditor(r){m(this,n).getActive()!==r&&m(this,n).setActiveEditor(r)}enableClick(){this.div.addEventListener("pointerdown",m(this,C)),this.div.addEventListener("pointerup",m(this,w))}disableClick(){this.div.removeEventListener("pointerdown",m(this,C)),this.div.removeEventListener("pointerup",m(this,w))}attach(r){m(this,A).set(r.id,r)}detach(r){var O;m(this,A).delete(r.id),(O=m(this,E))==null||O.removePointerInTextLayer(r.contentDiv)}remove(r){m(this,n).removeEditor(r),this.detach(r),r.div.style.display="none",setTimeout(()=>{r.div.style.display="",r.div.remove(),r.isAttachedToDOM=!1,document.activeElement===document.body&&m(this,n).focusMainContainer()},0),m(this,g)||this.addInkEditorIfNeeded(!1)}add(r){if(lt(this,i,be).call(this,r),m(this,n).addEditor(r),this.attach(r),!r.isAttachedToDOM){const O=r.render();this.div.append(O),r.isAttachedToDOM=!0}this.moveEditorInDOM(r),r.onceAdded(),m(this,n).addToAnnotationStorage(r)}moveEditorInDOM(r){var O;(O=m(this,E))==null||O.moveElementInDOM(this.div,r.div,r.contentDiv,!0)}addOrRebuild(r){r.needsToBeRebuilt()?r.rebuild():this.add(r)}addANewEditor(r){const O=()=>{this.addOrRebuild(r)},X=()=>{r.remove()};this.addCommands({cmd:O,undo:X,mustExec:!0})}addUndoableEditor(r){const O=()=>{this.addOrRebuild(r)},X=()=>{r.remove()};this.addCommands({cmd:O,undo:X,mustExec:!1})}getNextId(){return m(this,n).getId()}deserialize(r){switch(r.annotationType){case f.AnnotationEditorType.FREETEXT:return G.FreeTextEditor.deserialize(r,this,m(this,n));case f.AnnotationEditorType.INK:return V.InkEditor.deserialize(r,this,m(this,n))}return null}setSelected(r){m(this,n).setSelected(r)}toggleSelected(r){m(this,n).toggleSelected(r)}isSelected(r){return m(this,n).isSelected(r)}unselect(r){m(this,n).unselect(r)}pointerup(r){const{isMac:O}=f.FeatureTest.platform;if(!(r.button!==0||r.ctrlKey&&O)&&r.target===this.div&&m(this,u)){if(mt(this,u,!1),!m(this,_)){mt(this,_,!0);return}lt(this,t,Ae).call(this,r)}}pointerdown(r){const{isMac:O}=f.FeatureTest.platform;if(r.button!==0||r.ctrlKey&&O||r.target!==this.div)return;mt(this,u,!0);const X=m(this,n).getActive();mt(this,_,!X||X.isEmpty())}drop(r){const O=r.dataTransfer.getData("text/plain"),X=m(this,n).getEditor(O);if(!X)return;r.preventDefault(),r.dataTransfer.dropEffect="move",lt(this,i,be).call(this,X);const Y=this.div.getBoundingClientRect(),Z=r.clientX-Y.x,rt=r.clientY-Y.y;X.translate(Z-X.startX,rt-X.startY),this.moveEditorInDOM(X),X.div.focus()}dragover(r){r.preventDefault()}destroy(){var r,O;((r=m(this,n).getActive())==null?void 0:r.parent)===this&&m(this,n).setActiveEditor(null);for(const X of m(this,A).values())(O=m(this,E))==null||O.removePointerInTextLayer(X.contentDiv),X.setParent(null),X.isAttachedToDOM=!1,X.div.remove();this.div=null,m(this,A).clear(),m(this,n).removeLayer(this)}render({viewport:r}){this.viewport=r,(0,Q.setLayerDimensions)(this.div,r),(0,S.bindEvents)(this,this.div,["dragover","drop"]);for(const O of m(this,n).getEditors(this.pageIndex))this.add(O);this.updateMode()}update({viewport:r}){m(this,n).commitOrRemove(),this.viewport=r,(0,Q.setLayerDimensions)(this.div,{rotation:r.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:r,pageHeight:O}=this.viewport.rawDims;return[r,O]}};let M=p;E=new WeakMap,_=new WeakMap,w=new WeakMap,C=new WeakMap,A=new WeakMap,u=new WeakMap,g=new WeakMap,n=new WeakMap,i=new WeakSet,be=function(r){var O;r.parent!==this&&(this.attach(r),(O=r.parent)==null||O.detach(r),r.setParent(this),r.div&&r.isAttachedToDOM&&(r.div.remove(),this.div.append(r.div)))},F=new WeakSet,Be=function(r){switch(m(this,n).getMode()){case f.AnnotationEditorType.FREETEXT:return new G.FreeTextEditor(r);case f.AnnotationEditorType.INK:return new V.InkEditor(r)}return null},t=new WeakSet,Ae=function(r){const O=this.getNextId(),X=lt(this,F,Be).call(this,{parent:this,id:O,x:r.offsetX,y:r.offsetY,uiManager:m(this,n)});return X&&this.add(X),X},l=new WeakSet,ye=function(){mt(this,g,!0);for(const r of m(this,A).values())r.isEmpty()&&r.remove();mt(this,g,!1)},Dt(M,"_initialized",!1),c.AnnotationEditorLayer=M},(it,c,H)=>{var Q,M,E,_,w,C,A,u,g,n,Ue,P,We,y,He,o,ve;Object.defineProperty(c,"__esModule",{value:!0}),c.FreeTextEditor=void 0;var f=H(1),S=H(5),G=H(4);const s=class extends G.AnnotationEditor{constructor(r){super({...r,name:"freeTextEditor"});et(this,n);et(this,P);et(this,y);et(this,o);et(this,Q,this.editorDivBlur.bind(this));et(this,M,this.editorDivFocus.bind(this));et(this,E,this.editorDivInput.bind(this));et(this,_,this.editorDivKeydown.bind(this));et(this,w,void 0);et(this,C,"");et(this,A,`${this.id}-editor`);et(this,u,!1);et(this,g,void 0);mt(this,w,r.color||s._defaultColor||G.AnnotationEditor._defaultLineColor),mt(this,g,r.fontSize||s._defaultFontSize)}static initialize(r){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(X=>[X,r.get(X)]));const O=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(O.getPropertyValue("--freetext-padding"))}static updateDefaultParams(r,O){switch(r){case f.AnnotationEditorParamsType.FREETEXT_SIZE:s._defaultFontSize=O;break;case f.AnnotationEditorParamsType.FREETEXT_COLOR:s._defaultColor=O;break}}updateParams(r,O){switch(r){case f.AnnotationEditorParamsType.FREETEXT_SIZE:lt(this,n,Ue).call(this,O);break;case f.AnnotationEditorParamsType.FREETEXT_COLOR:lt(this,P,We).call(this,O);break}}static get defaultPropertiesToUpdate(){return[[f.AnnotationEditorParamsType.FREETEXT_SIZE,s._defaultFontSize],[f.AnnotationEditorParamsType.FREETEXT_COLOR,s._defaultColor||G.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[f.AnnotationEditorParamsType.FREETEXT_SIZE,m(this,g)],[f.AnnotationEditorParamsType.FREETEXT_COLOR,m(this,w)]]}getInitialTranslation(){const r=this.parentScale;return[-s._internalPadding*r,-(s._internalPadding+m(this,g))*r]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(f.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",m(this,_)),this.editorDiv.addEventListener("focus",m(this,M)),this.editorDiv.addEventListener("blur",m(this,Q)),this.editorDiv.addEventListener("input",m(this,E)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",m(this,A)),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",m(this,_)),this.editorDiv.removeEventListener("focus",m(this,M)),this.editorDiv.removeEventListener("blur",m(this,Q)),this.editorDiv.removeEventListener("input",m(this,E)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(r){super.focusin(r),r.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}commit(){this.isInEditMode()&&(super.commit(),m(this,u)||(mt(this,u,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),mt(this,C,lt(this,y,He).call(this).trimEnd()),lt(this,o,ve).call(this))}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(r){this.enableEditMode(),this.editorDiv.focus()}keydown(r){r.target===this.div&&r.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(r){s._keyboardManager.exec(this,r)}editorDivFocus(r){this.isEditing=!0}editorDivBlur(r){this.isEditing=!1}editorDivInput(r){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let r,O;this.width&&(r=this.x,O=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",m(this,A)),this.enableEditing(),s._l10nPromise.get("editor_free_text2_aria_label").then(Y=>{var Z;return(Z=this.editorDiv)==null?void 0:Z.setAttribute("aria-label",Y)}),s._l10nPromise.get("free_text2_default_content").then(Y=>{var Z;return(Z=this.editorDiv)==null?void 0:Z.setAttribute("default-content",Y)}),this.editorDiv.contentEditable=!0;const{style:X}=this.editorDiv;if(X.fontSize=`calc(${m(this,g)}px * var(--scale-factor))`,X.color=m(this,w),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,S.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Y,Z]=this.parentDimensions;this.setAt(r*Y,O*Z,this.width*Y,this.height*Z);for(const rt of m(this,C).split(`
`)){const ft=document.createElement("div");ft.append(rt?document.createTextNode(rt):document.createElement("br")),this.editorDiv.append(ft)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(r,O,X){const Y=super.deserialize(r,O,X);return mt(Y,g,r.fontSize),mt(Y,w,f.Util.makeHexColor(...r.color)),mt(Y,C,r.value),Y}serialize(){if(this.isEmpty())return null;const r=s._internalPadding*this.parentScale,O=this.getRect(r,r),X=G.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:m(this,w));return{annotationType:f.AnnotationEditorType.FREETEXT,color:X,fontSize:m(this,g),value:m(this,C),pageIndex:this.pageIndex,rect:O,rotation:this.rotation}}};let V=s;Q=new WeakMap,M=new WeakMap,E=new WeakMap,_=new WeakMap,w=new WeakMap,C=new WeakMap,A=new WeakMap,u=new WeakMap,g=new WeakMap,n=new WeakSet,Ue=function(r){const O=Y=>{this.editorDiv.style.fontSize=`calc(${Y}px * var(--scale-factor))`,this.translate(0,-(Y-m(this,g))*this.parentScale),mt(this,g,Y),lt(this,o,ve).call(this)},X=m(this,g);this.addCommands({cmd:()=>{O(r)},undo:()=>{O(X)},mustExec:!0,type:f.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},P=new WeakSet,We=function(r){const O=m(this,w);this.addCommands({cmd:()=>{mt(this,w,this.editorDiv.style.color=r)},undo:()=>{mt(this,w,this.editorDiv.style.color=O)},mustExec:!0,type:f.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},y=new WeakSet,He=function(){const r=this.editorDiv.getElementsByTagName("div");if(r.length===0)return this.editorDiv.innerText;const O=[];for(const X of r)O.push(X.innerText.replace(/\r\n?|\n/,""));return O.join(`
`)},o=new WeakSet,ve=function(){const[r,O]=this.parentDimensions;let X;if(this.isAttachedToDOM)X=this.div.getBoundingClientRect();else{const{currentLayer:Y,div:Z}=this,rt=Z.style.display;Z.style.display="hidden",Y.div.append(this.div),X=Z.getBoundingClientRect(),Z.remove(),Z.style.display=rt}this.width=X.width/r,this.height=X.height/O},Dt(V,"_freeTextDefaultContent",""),Dt(V,"_l10nPromise"),Dt(V,"_internalPadding",0),Dt(V,"_defaultColor",null),Dt(V,"_defaultFontSize",10),Dt(V,"_keyboardManager",new S.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],s.prototype.commitOrRemove]])),Dt(V,"_type","freetext"),c.FreeTextEditor=V},(it,c,H)=>{var E,_,w,C,A,u,g,n,i,P,F,y,t,o,l,qe,p,Ge,r,$e,X,Ve,Z,Se,ft,Xe,dt,ze,yt,Ye,h,Gt,v,Ee,D,ae,q,oe,z,Yt,k,Ce,a,le,x,xe,N,Ke,tt,Je,at,Qe,ct,Te,pt,ce,At,Kt,R,Pe;Object.defineProperty(c,"__esModule",{value:!0}),c.InkEditor=void 0,Object.defineProperty(c,"fitCurve",{enumerable:!0,get:function(){return G.fitCurve}});var f=H(1),S=H(4),G=H(30),V=H(5);const Q=16,W=class extends S.AnnotationEditor{constructor(J){super({...J,name:"inkEditor"});et(this,l);et(this,p);et(this,r);et(this,X);et(this,Z);et(this,ft);et(this,dt);et(this,yt);et(this,h);et(this,v);et(this,D);et(this,q);et(this,z);et(this,k);et(this,a);et(this,N);et(this,tt);et(this,at);et(this,ct);et(this,pt);et(this,At);et(this,R);et(this,E,0);et(this,_,0);et(this,w,0);et(this,C,this.canvasPointermove.bind(this));et(this,A,this.canvasPointerleave.bind(this));et(this,u,this.canvasPointerup.bind(this));et(this,g,this.canvasPointerdown.bind(this));et(this,n,!1);et(this,i,!1);et(this,P,null);et(this,F,null);et(this,y,0);et(this,t,0);et(this,o,null);this.color=J.color||null,this.thickness=J.thickness||null,this.opacity=J.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(J){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(ht=>[ht,J.get(ht)]))}static updateDefaultParams(J,ht){switch(J){case f.AnnotationEditorParamsType.INK_THICKNESS:W._defaultThickness=ht;break;case f.AnnotationEditorParamsType.INK_COLOR:W._defaultColor=ht;break;case f.AnnotationEditorParamsType.INK_OPACITY:W._defaultOpacity=ht/100;break}}updateParams(J,ht){switch(J){case f.AnnotationEditorParamsType.INK_THICKNESS:lt(this,l,qe).call(this,ht);break;case f.AnnotationEditorParamsType.INK_COLOR:lt(this,p,Ge).call(this,ht);break;case f.AnnotationEditorParamsType.INK_OPACITY:lt(this,r,$e).call(this,ht);break}}static get defaultPropertiesToUpdate(){return[[f.AnnotationEditorParamsType.INK_THICKNESS,W._defaultThickness],[f.AnnotationEditorParamsType.INK_COLOR,W._defaultColor||S.AnnotationEditor._defaultLineColor],[f.AnnotationEditorParamsType.INK_OPACITY,Math.round(W._defaultOpacity*100)]]}get propertiesToUpdate(){return[[f.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||W._defaultThickness],[f.AnnotationEditorParamsType.INK_COLOR,this.color||W._defaultColor||S.AnnotationEditor._defaultLineColor],[f.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??W._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(lt(this,D,ae).call(this),lt(this,q,oe).call(this)),this.isAttachedToDOM||(this.parent.add(this),lt(this,z,Yt).call(this)),lt(this,At,Kt).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,m(this,F).disconnect(),mt(this,F,null),super.remove())}setParent(J){!this.parent&&J?this._uiManager.removeShouldRescale(this):this.parent&&J===null&&this._uiManager.addShouldRescale(this),super.setParent(J)}onScaleChanging(){const[J,ht]=this.parentDimensions,vt=this.width*J,St=this.height*ht;this.setDimensions(vt,St)}enableEditMode(){m(this,n)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",m(this,g)),this.canvas.addEventListener("pointerup",m(this,u)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",m(this,g)),this.canvas.removeEventListener("pointerup",m(this,u)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){m(this,n)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),mt(this,n,!0),this.div.classList.add("disabled"),lt(this,At,Kt).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(J){super.focusin(J),this.enableEditMode()}canvasPointerdown(J){J.button!==0||!this.isInEditMode()||m(this,n)||(this.setInForeground(),J.type!=="mouse"&&this.div.focus(),J.stopPropagation(),this.canvas.addEventListener("pointerleave",m(this,A)),this.canvas.addEventListener("pointermove",m(this,C)),lt(this,ft,Xe).call(this,J.offsetX,J.offsetY))}canvasPointermove(J){J.stopPropagation(),lt(this,dt,ze).call(this,J.offsetX,J.offsetY)}canvasPointerup(J){J.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(J.stopPropagation(),lt(this,v,Ee).call(this,J),this.setInBackground())}canvasPointerleave(J){lt(this,v,Ee).call(this,J),this.setInBackground()}render(){if(this.div)return this.div;let J,ht;this.width&&(J=this.x,ht=this.y),super.render(),W._l10nPromise.get("editor_ink2_aria_label").then(wt=>{var Pt;return(Pt=this.div)==null?void 0:Pt.setAttribute("aria-label",wt)});const[vt,St,kt,Ft]=lt(this,X,Ve).call(this);if(this.setAt(vt,St,0,0),this.setDims(kt,Ft),lt(this,D,ae).call(this),this.width){const[wt,Pt]=this.parentDimensions;this.setAt(J*wt,ht*Pt,this.width*wt,this.height*Pt),mt(this,i,!0),lt(this,z,Yt).call(this),this.setDims(this.width*wt,this.height*Pt),lt(this,h,Gt).call(this),lt(this,R,Pe).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return lt(this,q,oe).call(this),this.div}setDimensions(J,ht){const vt=Math.round(J),St=Math.round(ht);if(m(this,y)===vt&&m(this,t)===St)return;mt(this,y,vt),mt(this,t,St),this.canvas.style.visibility="hidden",m(this,E)&&Math.abs(m(this,E)-J/ht)>.01&&(ht=Math.ceil(J/m(this,E)),this.setDims(J,ht));const[kt,Ft]=this.parentDimensions;this.width=J/kt,this.height=ht/Ft,m(this,n)&&lt(this,k,Ce).call(this,J,ht),lt(this,z,Yt).call(this),lt(this,h,Gt).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(J,ht,vt){var Mt,Ot;const St=super.deserialize(J,ht,vt);St.thickness=J.thickness,St.color=f.Util.makeHexColor(...J.color),St.opacity=J.opacity;const[kt,Ft]=St.pageDimensions,wt=St.width*kt,Pt=St.height*Ft,Rt=St.parentScale,xt=J.thickness/2;mt(St,E,wt/Pt),mt(St,n,!0),mt(St,y,Math.round(wt)),mt(St,t,Math.round(Pt));for(const{bezier:Lt}of J.paths){const jt=[];St.paths.push(jt);let It=Rt*(Lt[0]-xt),Bt=Rt*(Pt-Lt[1]-xt);for(let Ut=2,Zt=Lt.length;Ut<Zt;Ut+=6){const te=Rt*(Lt[Ut]-xt),ee=Rt*(Pt-Lt[Ut+1]-xt),ne=Rt*(Lt[Ut+2]-xt),se=Rt*(Pt-Lt[Ut+3]-xt),Fe=Rt*(Lt[Ut+4]-xt),Re=Rt*(Pt-Lt[Ut+5]-xt);jt.push([[It,Bt],[te,ee],[ne,se],[Fe,Re]]),It=Fe,Bt=Re}const Ht=lt(this,x,xe).call(this,jt);St.bezierPath2D.push(Ht)}const Nt=lt(Mt=St,ct,Te).call(Mt);return mt(St,w,Math.max(Q,Nt[2]-Nt[0])),mt(St,_,Math.max(Q,Nt[3]-Nt[1])),lt(Ot=St,k,Ce).call(Ot,wt,Pt),St}serialize(){if(this.isEmpty())return null;const J=this.getRect(0,0),ht=this.rotation%180===0?J[3]-J[1]:J[2]-J[0],vt=S.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:f.AnnotationEditorType.INK,color:vt,thickness:this.thickness,opacity:this.opacity,paths:lt(this,N,Ke).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,ht),pageIndex:this.pageIndex,rect:J,rotation:this.rotation}}};let M=W;E=new WeakMap,_=new WeakMap,w=new WeakMap,C=new WeakMap,A=new WeakMap,u=new WeakMap,g=new WeakMap,n=new WeakMap,i=new WeakMap,P=new WeakMap,F=new WeakMap,y=new WeakMap,t=new WeakMap,o=new WeakMap,l=new WeakSet,qe=function(J){const ht=this.thickness;this.addCommands({cmd:()=>{this.thickness=J,lt(this,At,Kt).call(this)},undo:()=>{this.thickness=ht,lt(this,At,Kt).call(this)},mustExec:!0,type:f.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},p=new WeakSet,Ge=function(J){const ht=this.color;this.addCommands({cmd:()=>{this.color=J,lt(this,h,Gt).call(this)},undo:()=>{this.color=ht,lt(this,h,Gt).call(this)},mustExec:!0,type:f.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},r=new WeakSet,$e=function(J){J/=100;const ht=this.opacity;this.addCommands({cmd:()=>{this.opacity=J,lt(this,h,Gt).call(this)},undo:()=>{this.opacity=ht,lt(this,h,Gt).call(this)},mustExec:!0,type:f.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},X=new WeakSet,Ve=function(){const{parentRotation:J,parentDimensions:[ht,vt]}=this;switch(J){case 90:return[0,vt,vt,ht];case 180:return[ht,vt,ht,vt];case 270:return[ht,0,vt,ht];default:return[0,0,ht,vt]}},Z=new WeakSet,Se=function(){const{ctx:J,color:ht,opacity:vt,thickness:St,parentScale:kt,scaleFactor:Ft}=this;J.lineWidth=St*kt/Ft,J.lineCap="round",J.lineJoin="round",J.miterLimit=10,J.strokeStyle=`${ht}${(0,V.opacityToHex)(vt)}`},ft=new WeakSet,Xe=function(J,ht){this.isEditing=!0,m(this,i)||(mt(this,i,!0),lt(this,z,Yt).call(this),this.thickness||(this.thickness=W._defaultThickness),this.color||(this.color=W._defaultColor||S.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=W._defaultOpacity)),this.currentPath.push([J,ht]),mt(this,P,null),lt(this,Z,Se).call(this),this.ctx.beginPath(),this.ctx.moveTo(J,ht),mt(this,o,()=>{m(this,o)&&(m(this,P)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):lt(this,h,Gt).call(this),this.ctx.lineTo(...m(this,P)),mt(this,P,null),this.ctx.stroke()),window.requestAnimationFrame(m(this,o)))}),window.requestAnimationFrame(m(this,o))},dt=new WeakSet,ze=function(J,ht){const[vt,St]=this.currentPath.at(-1);J===vt&&ht===St||(this.currentPath.push([J,ht]),mt(this,P,[J,ht]))},yt=new WeakSet,Ye=function(J,ht){var Rt;this.ctx.closePath(),mt(this,o,null),J=Math.min(Math.max(J,0),this.canvas.width),ht=Math.min(Math.max(ht,0),this.canvas.height);const[vt,St]=this.currentPath.at(-1);(J!==vt||ht!==St)&&this.currentPath.push([J,ht]);let kt;if(this.currentPath.length!==1)kt=(0,G.fitCurve)(this.currentPath,30,null);else{const xt=[J,ht];kt=[[xt,xt.slice(),xt.slice(),xt]]}const Ft=lt(Rt=W,x,xe).call(Rt,kt);this.currentPath.length=0;const wt=()=>{this.paths.push(kt),this.bezierPath2D.push(Ft),this.rebuild()},Pt=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(lt(this,D,ae).call(this),lt(this,q,oe).call(this)),lt(this,At,Kt).call(this))};this.addCommands({cmd:wt,undo:Pt,mustExec:!0})},h=new WeakSet,Gt=function(){if(this.isEmpty()){lt(this,a,le).call(this);return}lt(this,Z,Se).call(this);const{canvas:J,ctx:ht}=this;ht.setTransform(1,0,0,1,0,0),ht.clearRect(0,0,J.width,J.height),lt(this,a,le).call(this);for(const vt of this.bezierPath2D)ht.stroke(vt)},v=new WeakSet,Ee=function(J){lt(this,yt,Ye).call(this,J.offsetX,J.offsetY),this.canvas.removeEventListener("pointerleave",m(this,A)),this.canvas.removeEventListener("pointermove",m(this,C)),this.addToAnnotationStorage()},D=new WeakSet,ae=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",W._l10nPromise.get("editor_ink_canvas_aria_label").then(J=>{var ht;return(ht=this.canvas)==null?void 0:ht.setAttribute("aria-label",J)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},q=new WeakSet,oe=function(){mt(this,F,new ResizeObserver(J=>{const ht=J[0].contentRect;ht.width&&ht.height&&this.setDimensions(ht.width,ht.height)})),m(this,F).observe(this.div)},z=new WeakSet,Yt=function(){if(!m(this,i))return;const[J,ht]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*J),this.canvas.height=Math.ceil(this.height*ht),lt(this,a,le).call(this)},k=new WeakSet,Ce=function(J,ht){const vt=lt(this,pt,ce).call(this),St=(J-vt)/m(this,w),kt=(ht-vt)/m(this,_);this.scaleFactor=Math.min(St,kt)},a=new WeakSet,le=function(){const J=lt(this,pt,ce).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+J,this.translationY*this.scaleFactor+J)},x=new WeakSet,xe=function(J){const ht=new Path2D;for(let vt=0,St=J.length;vt<St;vt++){const[kt,Ft,wt,Pt]=J[vt];vt===0&&ht.moveTo(...kt),ht.bezierCurveTo(Ft[0],Ft[1],wt[0],wt[1],Pt[0],Pt[1])}return ht},N=new WeakSet,Ke=function(J,ht,vt,St){const Ft=[],wt=this.thickness/2;let Pt,Rt;for(const xt of this.paths){Pt=[],Rt=[];for(let Nt=0,Mt=xt.length;Nt<Mt;Nt++){const[Ot,Lt,jt,It]=xt[Nt],Bt=J*(Ot[0]+ht)+wt,Ht=St-J*(Ot[1]+vt)-wt,Ut=J*(Lt[0]+ht)+wt,Zt=St-J*(Lt[1]+vt)-wt,te=J*(jt[0]+ht)+wt,ee=St-J*(jt[1]+vt)-wt,ne=J*(It[0]+ht)+wt,se=St-J*(It[1]+vt)-wt;Nt===0&&(Pt.push(Bt,Ht),Rt.push(Bt,Ht)),Pt.push(Ut,Zt,te,ee,ne,se),lt(this,tt,Je).call(this,Bt,Ht,Ut,Zt,te,ee,ne,se,4,Rt)}Ft.push({bezier:Pt,points:Rt})}return Ft},tt=new WeakSet,Je=function(J,ht,vt,St,kt,Ft,wt,Pt,Rt,xt){if(lt(this,at,Qe).call(this,J,ht,vt,St,kt,Ft,wt,Pt)){xt.push(wt,Pt);return}for(let Nt=1;Nt<Rt-1;Nt++){const Mt=Nt/Rt,Ot=1-Mt;let Lt=Mt*J+Ot*vt,jt=Mt*ht+Ot*St,It=Mt*vt+Ot*kt,Bt=Mt*St+Ot*Ft;const Ht=Mt*kt+Ot*wt,Ut=Mt*Ft+Ot*Pt;Lt=Mt*Lt+Ot*It,jt=Mt*jt+Ot*Bt,It=Mt*It+Ot*Ht,Bt=Mt*Bt+Ot*Ut,Lt=Mt*Lt+Ot*It,jt=Mt*jt+Ot*Bt,xt.push(Lt,jt)}xt.push(wt,Pt)},at=new WeakSet,Qe=function(J,ht,vt,St,kt,Ft,wt,Pt){const xt=(3*vt-2*J-wt)**2,Nt=(3*St-2*ht-Pt)**2,Mt=(3*kt-J-2*wt)**2,Ot=(3*Ft-ht-2*Pt)**2;return Math.max(xt,Mt)+Math.max(Nt,Ot)<=10},ct=new WeakSet,Te=function(){let J=1/0,ht=-1/0,vt=1/0,St=-1/0;for(const kt of this.paths)for(const[Ft,wt,Pt,Rt]of kt){const xt=f.Util.bezierBoundingBox(...Ft,...wt,...Pt,...Rt);J=Math.min(J,xt[0]),vt=Math.min(vt,xt[1]),ht=Math.max(ht,xt[2]),St=Math.max(St,xt[3])}return[J,vt,ht,St]},pt=new WeakSet,ce=function(){return m(this,n)?Math.ceil(this.thickness*this.parentScale):0},At=new WeakSet,Kt=function(J=!1){if(this.isEmpty())return;if(!m(this,n)){lt(this,h,Gt).call(this);return}const ht=lt(this,ct,Te).call(this),vt=lt(this,pt,ce).call(this);mt(this,w,Math.max(Q,ht[2]-ht[0])),mt(this,_,Math.max(Q,ht[3]-ht[1]));const St=Math.ceil(vt+m(this,w)*this.scaleFactor),kt=Math.ceil(vt+m(this,_)*this.scaleFactor),[Ft,wt]=this.parentDimensions;this.width=St/Ft,this.height=kt/wt,mt(this,E,St/kt),lt(this,R,Pe).call(this);const Pt=this.translationX,Rt=this.translationY;this.translationX=-ht[0],this.translationY=-ht[1],lt(this,z,Yt).call(this),lt(this,h,Gt).call(this),mt(this,y,St),mt(this,t,kt),this.setDims(St,kt);const xt=J?vt/this.scaleFactor/2:0;this.translate(Pt-this.translationX-xt,Rt-this.translationY-xt)},R=new WeakSet,Pe=function(){const{style:J}=this.div;m(this,E)>=1?(J.minHeight=`${Q}px`,J.minWidth=`${Math.round(m(this,E)*Q)}px`):(J.minWidth=`${Q}px`,J.minHeight=`${Math.round(Q/m(this,E))}px`)},et(M,x),Dt(M,"_defaultColor",null),Dt(M,"_defaultOpacity",1),Dt(M,"_defaultThickness",1),Dt(M,"_l10nPromise"),Dt(M,"_type","ink"),c.InkEditor=M},(it,c,H)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.fitCurve=void 0;const f=H(31);c.fitCurve=f},it=>{function c(u,g,n){if(!Array.isArray(u))throw new TypeError("First argument should be an array");if(u.forEach(y=>{if(!Array.isArray(y)||y.some(t=>typeof t!="number")||y.length!==u[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),u=u.filter((y,t)=>t===0||!y.every((o,l)=>o===u[t-1][l])),u.length<2)return[];const i=u.length,P=w(u[1],u[0]),F=w(u[i-2],u[i-1]);return H(u,P,F,g,n)}function H(u,g,n,i,P){var y,t,o,l,s,p,T,r,O,X,Y,Z,rt;if(u.length===2)return Z=C.vectorLen(C.subtract(u[0],u[1]))/3,y=[u[0],C.addArrays(u[0],C.mulItems(g,Z)),C.addArrays(u[1],C.mulItems(n,Z)),u[1]],[y];if(t=Q(u),[y,l,p]=f(u,t,t,g,n,P),l===0||l<i)return[y];if(l<i*i)for(o=t,s=l,T=p,rt=0;rt<20;rt++){if(o=G(y,u,o),[y,l,p]=f(u,t,o,g,n,P),l<i)return[y];if(p===T){let ft=l/s;if(ft>.9999&&ft<1.0001)break}s=l,T=p}return Y=[],r=C.subtract(u[p-1],u[p+1]),r.every(ft=>ft===0)&&(r=C.subtract(u[p-1],u[p]),[r[0],r[1]]=[-r[1],r[0]]),O=C.normalize(r),X=C.mulItems(O,-1),Y=Y.concat(H(u.slice(0,p+1),g,O,i,P)),Y=Y.concat(H(u.slice(p),X,n,i,P)),Y}function f(u,g,n,i,P,F){var y,t,o;return y=S(u,n,i,P),[t,o]=M(u,y,g),F&&F({bez:y,points:u,params:g,maxErr:t,maxPoint:o}),[y,t,o]}function S(u,g,n,i){var P,F,y,t,o,l,s,p,T,r,O,X,Y,Z,rt,ft,ot,dt=u[0],bt=u[u.length-1];for(P=[dt,null,null,bt],F=C.zeros_Xx2x2(g.length),Y=0,Z=g.length;Y<Z;Y++)ft=g[Y],ot=1-ft,y=F[Y],y[0]=C.mulItems(n,3*ft*(ot*ot)),y[1]=C.mulItems(i,3*ot*(ft*ft));for(t=[[0,0],[0,0]],o=[0,0],Y=0,Z=u.length;Y<Z;Y++)ft=g[Y],y=F[Y],t[0][0]+=C.dot(y[0],y[0]),t[0][1]+=C.dot(y[0],y[1]),t[1][0]+=C.dot(y[0],y[1]),t[1][1]+=C.dot(y[1],y[1]),rt=C.subtract(u[Y],A.q([dt,dt,bt,bt],ft)),o[0]+=C.dot(y[0],rt),o[1]+=C.dot(y[1],rt);return l=t[0][0]*t[1][1]-t[1][0]*t[0][1],s=t[0][0]*o[1]-t[1][0]*o[0],p=o[0]*t[1][1]-o[1]*t[0][1],T=l===0?0:p/l,r=l===0?0:s/l,X=C.vectorLen(C.subtract(dt,bt)),O=1e-6*X,T<O||r<O?(P[1]=C.addArrays(dt,C.mulItems(n,X/3)),P[2]=C.addArrays(bt,C.mulItems(i,X/3))):(P[1]=C.addArrays(dt,C.mulItems(n,T)),P[2]=C.addArrays(bt,C.mulItems(i,r))),P}function G(u,g,n){return n.map((i,P)=>V(u,g[P],i))}function V(u,g,n){var i=C.subtract(A.q(u,n),g),P=A.qprime(u,n),F=C.mulMatrix(i,P),y=C.sum(C.squareItems(P))+2*C.mulMatrix(i,A.qprimeprime(u,n));return y===0?n:n-F/y}function Q(u){var g=[],n,i,P;return u.forEach((F,y)=>{n=y?i+C.vectorLen(C.subtract(F,P)):0,g.push(n),i=n,P=F}),g=g.map(F=>F/i),g}function M(u,g,n){var i,P,F,y,t,o,l,s;P=0,F=Math.floor(u.length/2);const p=E(g,10);for(t=0,o=u.length;t<o;t++)l=u[t],s=_(g,n[t],p,10),y=C.subtract(A.q(g,s),l),i=y[0]*y[0]+y[1]*y[1],i>P&&(P=i,F=t);return[P,F]}var E=function(u,g){for(var n,i=[0],P=u[0],F=0,y=1;y<=g;y++)n=A.q(u,y/g),F+=C.vectorLen(C.subtract(n,P)),i.push(F),P=n;return i=i.map(t=>t/F),i};function _(u,g,n,i){if(g<0)return 0;if(g>1)return 1;for(var P,F,y,t,o,l=1;l<=i;l++)if(g<=n[l]){t=(l-1)/i,y=l/i,F=n[l-1],P=n[l],o=(g-F)/(P-F)*(y-t)+t;break}return o}function w(u,g){return C.normalize(C.subtract(u,g))}class C{static zeros_Xx2x2(g){for(var n=[];g--;)n.push([0,0]);return n}static mulItems(g,n){return g.map(i=>i*n)}static mulMatrix(g,n){return g.reduce((i,P,F)=>i+P*n[F],0)}static subtract(g,n){return g.map((i,P)=>i-n[P])}static addArrays(g,n){return g.map((i,P)=>i+n[P])}static addItems(g,n){return g.map(i=>i+n)}static sum(g){return g.reduce((n,i)=>n+i)}static dot(g,n){return C.mulMatrix(g,n)}static vectorLen(g){return Math.hypot(...g)}static divItems(g,n){return g.map(i=>i/n)}static squareItems(g){return g.map(n=>n*n)}static normalize(g){return this.divItems(g,this.vectorLen(g))}}class A{static q(g,n){var i=1-n,P=C.mulItems(g[0],i*i*i),F=C.mulItems(g[1],3*i*i*n),y=C.mulItems(g[2],3*i*n*n),t=C.mulItems(g[3],n*n*n);return C.addArrays(C.addArrays(P,F),C.addArrays(y,t))}static qprime(g,n){var i=1-n,P=C.mulItems(C.subtract(g[1],g[0]),3*i*i),F=C.mulItems(C.subtract(g[2],g[1]),6*i*n),y=C.mulItems(C.subtract(g[3],g[2]),3*n*n);return C.addArrays(C.addArrays(P,F),y)}static qprimeprime(g,n){return C.addArrays(C.mulItems(C.addArrays(C.subtract(g[2],C.mulItems(g[1],2)),g[0]),6*(1-n)),C.mulItems(C.addArrays(C.subtract(g[3],C.mulItems(g[2],2)),g[1]),6*n))}}it.exports=c,it.exports.fitCubic=H,it.exports.createTangent=w},(it,c,H)=>{var h,Vt,v,Ze,$,we,K,ke;Object.defineProperty(c,"__esModule",{value:!0}),c.AnnotationLayer=void 0;var f=H(1),S=H(6),G=H(3),V=H(33),Q=H(34);const M=1e3,E=9,_=new WeakSet;function w(k){return{width:k[2]-k[0],height:k[3]-k[1]}}class C{static create(e){switch(e.data.annotationType){case f.AnnotationType.LINK:return new u(e);case f.AnnotationType.TEXT:return new g(e);case f.AnnotationType.WIDGET:switch(e.data.fieldType){case"Tx":return new i(e);case"Btn":return e.data.radioButton?new F(e):e.data.checkBox?new P(e):new y(e);case"Ch":return new t(e)}return new n(e);case f.AnnotationType.POPUP:return new o(e);case f.AnnotationType.FREETEXT:return new s(e);case f.AnnotationType.LINE:return new p(e);case f.AnnotationType.SQUARE:return new T(e);case f.AnnotationType.CIRCLE:return new r(e);case f.AnnotationType.POLYLINE:return new O(e);case f.AnnotationType.CARET:return new Y(e);case f.AnnotationType.INK:return new Z(e);case f.AnnotationType.POLYGON:return new X(e);case f.AnnotationType.HIGHLIGHT:return new rt(e);case f.AnnotationType.UNDERLINE:return new ft(e);case f.AnnotationType.SQUIGGLY:return new ot(e);case f.AnnotationType.STRIKEOUT:return new dt(e);case f.AnnotationType.STAMP:return new bt(e);case f.AnnotationType.FILEATTACHMENT:return new yt(e);default:return new A(e)}}}class A{constructor(e,{isRenderable:a=!1,ignoreBorder:b=!1,createQuadrilaterals:x=!1}={}){this.isRenderable=a,this.data=e.data,this.layer=e.layer,this.page=e.page,this.viewport=e.viewport,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,a&&(this.container=this._createContainer(b)),x&&(this.quadrilaterals=this._createQuadrilaterals(b))}_createContainer(e=!1){const{data:a,page:b,viewport:x}=this,I=document.createElement("section");I.setAttribute("data-annotation-id",a.id),a.noRotate&&I.classList.add("norotate");const{pageWidth:N,pageHeight:nt,pageX:tt,pageY:st}=x.rawDims,{width:at,height:ut}=w(a.rect),ct=f.Util.normalizeRect([a.rect[0],b.view[3]-a.rect[1]+b.view[1],a.rect[2],b.view[3]-a.rect[3]+b.view[1]]);if(!e&&a.borderStyle.width>0){I.style.borderWidth=`${a.borderStyle.width}px`;const pt=a.borderStyle.horizontalCornerRadius,Et=a.borderStyle.verticalCornerRadius;if(pt>0||Et>0){const Tt=`calc(${pt}px * var(--scale-factor)) / calc(${Et}px * var(--scale-factor))`;I.style.borderRadius=Tt}else if(this instanceof F){const Tt=`calc(${at}px * var(--scale-factor)) / calc(${ut}px * var(--scale-factor))`;I.style.borderRadius=Tt}switch(a.borderStyle.style){case f.AnnotationBorderStyleType.SOLID:I.style.borderStyle="solid";break;case f.AnnotationBorderStyleType.DASHED:I.style.borderStyle="dashed";break;case f.AnnotationBorderStyleType.BEVELED:(0,f.warn)("Unimplemented border style: beveled");break;case f.AnnotationBorderStyleType.INSET:(0,f.warn)("Unimplemented border style: inset");break;case f.AnnotationBorderStyleType.UNDERLINE:I.style.borderBottomStyle="solid";break}const At=a.borderColor||null;At?I.style.borderColor=f.Util.makeHexColor(At[0]|0,At[1]|0,At[2]|0):I.style.borderWidth=0}I.style.left=`${100*(ct[0]-tt)/N}%`,I.style.top=`${100*(ct[1]-st)/nt}%`;const{rotation:_t}=a;return a.hasOwnCanvas||_t===0?(I.style.width=`${100*at/N}%`,I.style.height=`${100*ut/nt}%`):this.setRotation(_t,I),I}setRotation(e,a=this.container){const{pageWidth:b,pageHeight:x}=this.viewport.rawDims,{width:I,height:N}=w(this.data.rect);let nt,tt;e%180===0?(nt=100*I/b,tt=100*N/x):(nt=100*N/b,tt=100*I/x),a.style.width=`${nt}%`,a.style.height=`${tt}%`,a.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(a,b,x)=>{const I=x.detail[a];x.target.style[b]=V.ColorConverters[`${I[0]}_HTML`](I.slice(1))};return(0,f.shadow)(this,"_commonActions",{display:a=>{const b=a.detail.display%2===1;this.container.style.visibility=b?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:b,print:a.detail.display===0||a.detail.display===3})},print:a=>{this.annotationStorage.setValue(this.data.id,{print:a.detail.print})},hidden:a=>{this.container.style.visibility=a.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:a.detail.hidden})},focus:a=>{setTimeout(()=>a.target.focus({preventScroll:!1}),0)},userName:a=>{a.target.title=a.detail.userName},readonly:a=>{a.detail.readonly?a.target.setAttribute("readonly",""):a.target.removeAttribute("readonly")},required:a=>{this._setRequired(a.target,a.detail.required)},bgColor:a=>{e("bgColor","backgroundColor",a)},fillColor:a=>{e("fillColor","backgroundColor",a)},fgColor:a=>{e("fgColor","color",a)},textColor:a=>{e("textColor","color",a)},borderColor:a=>{e("borderColor","borderColor",a)},strokeColor:a=>{e("strokeColor","borderColor",a)},rotation:a=>{const b=a.detail.rotation;this.setRotation(b),this.annotationStorage.setValue(this.data.id,{rotation:b})}})}_dispatchEventFromSandbox(e,a){const b=this._commonActions;for(const x of Object.keys(a.detail)){const I=e[x]||b[x];I==null||I(a)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const a=this.annotationStorage.getRawValue(this.data.id);if(!a)return;const b=this._commonActions;for(const[x,I]of Object.entries(a)){const N=b[x];if(N){const nt={detail:{[x]:I},target:e};N(nt),delete a[x]}}}_createQuadrilaterals(e=!1){if(!this.data.quadPoints)return null;const a=[],b=this.data.rect;for(const x of this.data.quadPoints)this.data.rect=[x[2].x,x[2].y,x[1].x,x[1].y],a.push(this._createContainer(e));return this.data.rect=b,a}_createPopup(e,a){let b=this.container;this.quadrilaterals&&(e=e||this.quadrilaterals,b=this.quadrilaterals[0]),e||(e=document.createElement("div"),e.classList.add("popupTriggerArea"),b.append(e));const I=new l({container:b,trigger:e,color:a.color,titleObj:a.titleObj,modificationDate:a.modificationDate,contentsObj:a.contentsObj,richText:a.richText,hideWrapper:!0}).render();I.style.left="100%",b.append(I)}_renderQuadrilaterals(e){for(const a of this.quadrilaterals)a.classList.add(e);return this.quadrilaterals}render(){(0,f.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,a=null){const b=[];if(this._fieldObjects){const x=this._fieldObjects[e];if(x)for(const{page:I,id:N,exportValues:nt}of x){if(I===-1||N===a)continue;const tt=typeof nt=="string"?nt:null,st=document.querySelector(`[data-element-id="${N}"]`);if(st&&!_.has(st)){(0,f.warn)(`_getElementsByName - element not allowed: ${N}`);continue}b.push({id:N,exportValue:tt,domElement:st})}return b}for(const x of document.getElementsByName(e)){const{exportValue:I}=x,N=x.getAttribute("data-element-id");N!==a&&_.has(x)&&b.push({id:N,exportValue:I,domElement:x})}return b}}class u extends A{constructor(a,b=null){super(a,{isRenderable:!0,ignoreBorder:!!(b!=null&&b.ignoreBorder),createQuadrilaterals:!0});et(this,h);et(this,v);this.isTooltipOnly=a.data.isTooltipOnly}render(){const{data:a,linkService:b}=this,x=document.createElement("a");x.setAttribute("data-element-id",a.id);let I=!1;return a.url?(b.addLinkAttributes(x,a.url,a.newWindow),I=!0):a.action?(this._bindNamedAction(x,a.action),I=!0):a.attachment?(this._bindAttachment(x,a.attachment),I=!0):a.setOCGState?(lt(this,v,Ze).call(this,x,a.setOCGState),I=!0):a.dest?(this._bindLink(x,a.dest),I=!0):(a.actions&&(a.actions.Action||a.actions["Mouse Up"]||a.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(x,a),I=!0),a.resetForm?(this._bindResetFormAction(x,a.resetForm),I=!0):this.isTooltipOnly&&!I&&(this._bindLink(x,""),I=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((N,nt)=>{const tt=nt===0?x:x.cloneNode();return N.append(tt),N}):(this.container.classList.add("linkAnnotation"),I&&this.container.append(x),this.container)}_bindLink(a,b){a.href=this.linkService.getDestinationHash(b),a.onclick=()=>(b&&this.linkService.goToDestination(b),!1),(b||b==="")&&lt(this,h,Vt).call(this)}_bindNamedAction(a,b){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>(this.linkService.executeNamedAction(b),!1),lt(this,h,Vt).call(this)}_bindAttachment(a,b){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>{var x;return(x=this.downloadManager)==null||x.openOrDownloadData(this.container,b.content,b.filename),!1},lt(this,h,Vt).call(this)}_bindJSAction(a,b){a.href=this.linkService.getAnchorUrl("");const x=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const I of Object.keys(b.actions)){const N=x.get(I);N&&(a[N]=()=>{var nt;return(nt=this.linkService.eventBus)==null||nt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:b.id,name:I}}),!1})}a.onclick||(a.onclick=()=>!1),lt(this,h,Vt).call(this)}_bindResetFormAction(a,b){const x=a.onclick;if(x||(a.href=this.linkService.getAnchorUrl("")),lt(this,h,Vt).call(this),!this._fieldObjects){(0,f.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),x||(a.onclick=()=>!1);return}a.onclick=()=>{var ut;x==null||x();const{fields:I,refs:N,include:nt}=b,tt=[];if(I.length!==0||N.length!==0){const ct=new Set(N);for(const _t of I){const pt=this._fieldObjects[_t]||[];for(const{id:Et}of pt)ct.add(Et)}for(const _t of Object.values(this._fieldObjects))for(const pt of _t)ct.has(pt.id)===nt&&tt.push(pt)}else for(const ct of Object.values(this._fieldObjects))tt.push(...ct);const st=this.annotationStorage,at=[];for(const ct of tt){const{id:_t}=ct;switch(at.push(_t),ct.type){case"text":{const Et=ct.defaultValue||"";st.setValue(_t,{value:Et});break}case"checkbox":case"radiobutton":{const Et=ct.defaultValue===ct.exportValues;st.setValue(_t,{value:Et});break}case"combobox":case"listbox":{const Et=ct.defaultValue||"";st.setValue(_t,{value:Et});break}default:continue}const pt=document.querySelector(`[data-element-id="${_t}"]`);if(pt){if(!_.has(pt)){(0,f.warn)(`_bindResetFormAction - element not allowed: ${_t}`);continue}}else continue;pt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((ut=this.linkService.eventBus)==null||ut.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:at,name:"ResetForm"}})),!1}}}h=new WeakSet,Vt=function(){this.container.setAttribute("data-internal-link","")},v=new WeakSet,Ze=function(a,b){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>(this.linkService.executeSetOCGState(b),!1),lt(this,h,Vt).call(this)};class g extends A{constructor(e){var b,x,I;const a=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:a})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.alt="[{{type}} Annotation]",e.dataset.l10nId="text_annotation_type",e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(e,this.data),this.container.append(e),this.container}}class n extends A{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(e){const{isWin:a,isMac:b}=f.FeatureTest.platform;return a&&e.ctrlKey||b&&e.metaKey}_setEventListener(e,a,b,x){a.includes("mouse")?e.addEventListener(a,I=>{var N;(N=this.linkService.eventBus)==null||N.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:b,value:x(I),shift:I.shiftKey,modifier:this._getKeyModifier(I)}})}):e.addEventListener(a,I=>{var N;(N=this.linkService.eventBus)==null||N.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:b,value:x(I)}})})}_setEventListeners(e,a,b){var x;for(const[I,N]of a)(N==="Action"||(x=this.data.actions)!=null&&x[N])&&this._setEventListener(e,I,N,b)}_setBackgroundColor(e){const a=this.data.backgroundColor||null;e.style.backgroundColor=a===null?"transparent":f.Util.makeHexColor(a[0],a[1],a[2])}_setTextStyle(e){const a=["left","center","right"],{fontColor:b}=this.data.defaultAppearanceData,x=this.data.defaultAppearanceData.fontSize||E,I=e.style;let N;const nt=2,tt=st=>Math.round(10*st)/10;if(this.data.multiLine){const st=Math.abs(this.data.rect[3]-this.data.rect[1]-nt),at=Math.round(st/(f.LINE_FACTOR*x))||1,ut=st/at;N=Math.min(x,tt(ut/f.LINE_FACTOR))}else{const st=Math.abs(this.data.rect[3]-this.data.rect[1]-nt);N=Math.min(x,tt(st/f.LINE_FACTOR))}I.fontSize=`calc(${N}px * var(--scale-factor))`,I.color=f.Util.makeHexColor(b[0],b[1],b[2]),this.data.textAlignment!==null&&(I.textAlign=a[this.data.textAlignment])}_setRequired(e,a){a?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",a)}}class i extends n{constructor(e){const a=e.renderForms||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:a})}setPropertyOnSiblings(e,a,b,x){const I=this.annotationStorage;for(const N of this._getElementsByName(e.name,e.id))N.domElement&&(N.domElement[a]=b),I.setValue(N.id,{[x]:b})}render(){var x;const e=this.annotationStorage,a=this.data.id;this.container.classList.add("textWidgetAnnotation");let b=null;if(this.renderForms){const I=e.getValue(a,{value:this.data.fieldValue});let N=I.formattedValue||I.value||"";const nt=e.getValue(a,{charLimit:this.data.maxLen}).charLimit;nt&&N.length>nt&&(N=N.slice(0,nt));const tt={userValue:N,formattedValue:null,lastCommittedValue:null,commitKey:1};this.data.multiLine?(b=document.createElement("textarea"),b.textContent=N,this.data.doNotScroll&&(b.style.overflowY="hidden")):(b=document.createElement("input"),b.type="text",b.setAttribute("value",N),this.data.doNotScroll&&(b.style.overflowX="hidden")),_.add(b),b.setAttribute("data-element-id",a),b.disabled=this.data.readOnly,b.name=this.data.fieldName,b.tabIndex=M,this._setRequired(b,this.data.required),nt&&(b.maxLength=nt),b.addEventListener("input",at=>{e.setValue(a,{value:at.target.value}),this.setPropertyOnSiblings(b,"value",at.target.value,"value")}),b.addEventListener("resetform",at=>{const ut=this.data.defaultFieldValue??"";b.value=tt.userValue=ut,tt.formattedValue=null});let st=at=>{const{formattedValue:ut}=tt;ut!=null&&(at.target.value=ut),at.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){b.addEventListener("focus",ut=>{const{target:ct}=ut;tt.userValue&&(ct.value=tt.userValue),tt.lastCommittedValue=ct.value,tt.commitKey=1}),b.addEventListener("updatefromsandbox",ut=>{const ct={value(_t){tt.userValue=_t.detail.value??"",e.setValue(a,{value:tt.userValue.toString()}),_t.target.value=tt.userValue},formattedValue(_t){const{formattedValue:pt}=_t.detail;tt.formattedValue=pt,pt!=null&&_t.target!==document.activeElement&&(_t.target.value=pt),e.setValue(a,{formattedValue:pt})},selRange(_t){_t.target.setSelectionRange(..._t.detail.selRange)},charLimit:_t=>{var Tt;const{charLimit:pt}=_t.detail,{target:Et}=_t;if(pt===0){Et.removeAttribute("maxLength");return}Et.setAttribute("maxLength",pt);let At=tt.userValue;!At||At.length<=pt||(At=At.slice(0,pt),Et.value=tt.userValue=At,e.setValue(a,{value:At}),(Tt=this.linkService.eventBus)==null||Tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:At,willCommit:!0,commitKey:1,selStart:Et.selectionStart,selEnd:Et.selectionEnd}}))}};this._dispatchEventFromSandbox(ct,ut)}),b.addEventListener("keydown",ut=>{var pt;tt.commitKey=1;let ct=-1;if(ut.key==="Escape"?ct=0:ut.key==="Enter"&&!this.data.multiLine?ct=2:ut.key==="Tab"&&(tt.commitKey=3),ct===-1)return;const{value:_t}=ut.target;tt.lastCommittedValue!==_t&&(tt.lastCommittedValue=_t,tt.userValue=_t,(pt=this.linkService.eventBus)==null||pt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:_t,willCommit:!0,commitKey:ct,selStart:ut.target.selectionStart,selEnd:ut.target.selectionEnd}}))});const at=st;st=null,b.addEventListener("blur",ut=>{var _t;if(!ut.relatedTarget)return;const{value:ct}=ut.target;tt.userValue=ct,tt.lastCommittedValue!==ct&&((_t=this.linkService.eventBus)==null||_t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:ct,willCommit:!0,commitKey:tt.commitKey,selStart:ut.target.selectionStart,selEnd:ut.target.selectionEnd}})),at(ut)}),(x=this.data.actions)!=null&&x.Keystroke&&b.addEventListener("beforeinput",ut=>{var U;tt.lastCommittedValue=null;const{data:ct,target:_t}=ut,{value:pt,selectionStart:Et,selectionEnd:At}=_t;let Tt=Et,R=At;switch(ut.inputType){case"deleteWordBackward":{const W=pt.substring(0,Et).match(/\w*[^\w]*$/);W&&(Tt-=W[0].length);break}case"deleteWordForward":{const W=pt.substring(Et).match(/^[^\w]*\w*/);W&&(R+=W[0].length);break}case"deleteContentBackward":Et===At&&(Tt-=1);break;case"deleteContentForward":Et===At&&(R+=1);break}ut.preventDefault(),(U=this.linkService.eventBus)==null||U.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:pt,change:ct||"",willCommit:!1,selStart:Tt,selEnd:R}})}),this._setEventListeners(b,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ut=>ut.target.value)}if(st&&b.addEventListener("blur",st),this.data.comb){const ut=(this.data.rect[2]-this.data.rect[0])/nt;b.classList.add("comb"),b.style.letterSpacing=`calc(${ut}px * var(--scale-factor) - 1ch)`}}else b=document.createElement("div"),b.textContent=this.data.fieldValue,b.style.verticalAlign="middle",b.style.display="table-cell";return this._setTextStyle(b),this._setBackgroundColor(b),this._setDefaultPropertiesFromJS(b),this.container.append(b),this.container}}class P extends n{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,a=this.data,b=a.id;let x=e.getValue(b,{value:a.exportValue===a.fieldValue}).value;typeof x=="string"&&(x=x!=="Off",e.setValue(b,{value:x})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const I=document.createElement("input");return _.add(I),I.setAttribute("data-element-id",b),I.disabled=a.readOnly,this._setRequired(I,this.data.required),I.type="checkbox",I.name=a.fieldName,x&&I.setAttribute("checked",!0),I.setAttribute("exportValue",a.exportValue),I.tabIndex=M,I.addEventListener("change",N=>{const{name:nt,checked:tt}=N.target;for(const st of this._getElementsByName(nt,b)){const at=tt&&st.exportValue===a.exportValue;st.domElement&&(st.domElement.checked=at),e.setValue(st.id,{value:at})}e.setValue(b,{value:tt})}),I.addEventListener("resetform",N=>{const nt=a.defaultFieldValue||"Off";N.target.checked=nt===a.exportValue}),this.enableScripting&&this.hasJSActions&&(I.addEventListener("updatefromsandbox",N=>{const nt={value(tt){tt.target.checked=tt.detail.value!=="Off",e.setValue(b,{value:tt.target.checked})}};this._dispatchEventFromSandbox(nt,N)}),this._setEventListeners(I,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],N=>N.target.checked)),this._setBackgroundColor(I),this._setDefaultPropertiesFromJS(I),this.container.append(I),this.container}}class F extends n{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,a=this.data,b=a.id;let x=e.getValue(b,{value:a.fieldValue===a.buttonValue}).value;typeof x=="string"&&(x=x!==a.buttonValue,e.setValue(b,{value:x}));const I=document.createElement("input");if(_.add(I),I.setAttribute("data-element-id",b),I.disabled=a.readOnly,this._setRequired(I,this.data.required),I.type="radio",I.name=a.fieldName,x&&I.setAttribute("checked",!0),I.tabIndex=M,I.addEventListener("change",N=>{const{name:nt,checked:tt}=N.target;for(const st of this._getElementsByName(nt,b))e.setValue(st.id,{value:!1});e.setValue(b,{value:tt})}),I.addEventListener("resetform",N=>{const nt=a.defaultFieldValue;N.target.checked=nt!=null&&nt===a.buttonValue}),this.enableScripting&&this.hasJSActions){const N=a.buttonValue;I.addEventListener("updatefromsandbox",nt=>{const tt={value:st=>{const at=N===st.detail.value;for(const ut of this._getElementsByName(st.target.name)){const ct=at&&ut.id===b;ut.domElement&&(ut.domElement.checked=ct),e.setValue(ut.id,{value:ct})}}};this._dispatchEventFromSandbox(tt,nt)}),this._setEventListeners(I,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],nt=>nt.target.checked)}return this._setBackgroundColor(I),this._setDefaultPropertiesFromJS(I),this.container.append(I),this.container}}class y extends u{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(e.title=this.data.alternativeText);const a=e.lastChild;return this.enableScripting&&this.hasJSActions&&a&&(this._setDefaultPropertiesFromJS(a),a.addEventListener("updatefromsandbox",b=>{this._dispatchEventFromSandbox({},b)})),e}}class t extends n{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,a=this.data.id,b=e.getValue(a,{value:this.data.fieldValue}),x=document.createElement("select");_.add(x),x.setAttribute("data-element-id",a),x.disabled=this.data.readOnly,this._setRequired(x,this.data.required),x.name=this.data.fieldName,x.tabIndex=M;let I=this.data.combo&&this.data.options.length>0;this.data.combo||(x.size=this.data.options.length,this.data.multiSelect&&(x.multiple=!0)),x.addEventListener("resetform",at=>{const ut=this.data.defaultFieldValue;for(const ct of x.options)ct.selected=ct.value===ut});for(const at of this.data.options){const ut=document.createElement("option");ut.textContent=at.displayValue,ut.value=at.exportValue,b.value.includes(at.exportValue)&&(ut.setAttribute("selected",!0),I=!1),x.append(ut)}let N=null;if(I){const at=document.createElement("option");at.value=" ",at.setAttribute("hidden",!0),at.setAttribute("selected",!0),x.prepend(at),N=()=>{at.remove(),x.removeEventListener("input",N),N=null},x.addEventListener("input",N)}const nt=at=>{const ut=at?"value":"textContent",{options:ct,multiple:_t}=x;return _t?Array.prototype.filter.call(ct,pt=>pt.selected).map(pt=>pt[ut]):ct.selectedIndex===-1?null:ct[ct.selectedIndex][ut]};let tt=nt(!1);const st=at=>{const ut=at.target.options;return Array.prototype.map.call(ut,ct=>({displayValue:ct.textContent,exportValue:ct.value}))};return this.enableScripting&&this.hasJSActions?(x.addEventListener("updatefromsandbox",at=>{const ut={value(ct){N==null||N();const _t=ct.detail.value,pt=new Set(Array.isArray(_t)?_t:[_t]);for(const Et of x.options)Et.selected=pt.has(Et.value);e.setValue(a,{value:nt(!0)}),tt=nt(!1)},multipleSelection(ct){x.multiple=!0},remove(ct){const _t=x.options,pt=ct.detail.remove;_t[pt].selected=!1,x.remove(pt),_t.length>0&&Array.prototype.findIndex.call(_t,At=>At.selected)===-1&&(_t[0].selected=!0),e.setValue(a,{value:nt(!0),items:st(ct)}),tt=nt(!1)},clear(ct){for(;x.length!==0;)x.remove(0);e.setValue(a,{value:null,items:[]}),tt=nt(!1)},insert(ct){const{index:_t,displayValue:pt,exportValue:Et}=ct.detail.insert,At=x.children[_t],Tt=document.createElement("option");Tt.textContent=pt,Tt.value=Et,At?At.before(Tt):x.append(Tt),e.setValue(a,{value:nt(!0),items:st(ct)}),tt=nt(!1)},items(ct){const{items:_t}=ct.detail;for(;x.length!==0;)x.remove(0);for(const pt of _t){const{displayValue:Et,exportValue:At}=pt,Tt=document.createElement("option");Tt.textContent=Et,Tt.value=At,x.append(Tt)}x.options.length>0&&(x.options[0].selected=!0),e.setValue(a,{value:nt(!0),items:st(ct)}),tt=nt(!1)},indices(ct){const _t=new Set(ct.detail.indices);for(const pt of ct.target.options)pt.selected=_t.has(pt.index);e.setValue(a,{value:nt(!0)}),tt=nt(!1)},editable(ct){ct.target.disabled=!ct.detail.editable}};this._dispatchEventFromSandbox(ut,at)}),x.addEventListener("input",at=>{var ct;const ut=nt(!0);e.setValue(a,{value:ut}),at.preventDefault(),(ct=this.linkService.eventBus)==null||ct.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:tt,changeEx:ut,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(x,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],at=>at.target.value)):x.addEventListener("input",function(at){e.setValue(a,{value:nt(!0)})}),this.data.combo&&this._setTextStyle(x),this._setBackgroundColor(x),this._setDefaultPropertiesFromJS(x),this.container.append(x),this.container}}const D=class extends A{constructor(e){var x,I,N;const{data:a}=e,b=!D.IGNORE_TYPES.has(a.parentType)&&!!((x=a.titleObj)!=null&&x.str||(I=a.contentsObj)!=null&&I.str||(N=a.richText)!=null&&N.str);super(e,{isRenderable:b})}render(){this.container.classList.add("popupAnnotation");const e=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(e.length===0)return this.container;const a=new l({container:this.container,trigger:Array.from(e),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),b=this.page,x=f.Util.normalizeRect([this.data.parentRect[0],b.view[3]-this.data.parentRect[1]+b.view[1],this.data.parentRect[2],b.view[3]-this.data.parentRect[3]+b.view[1]]),I=x[0]+this.data.parentRect[2]-this.data.parentRect[0],N=x[1],{pageWidth:nt,pageHeight:tt,pageX:st,pageY:at}=this.viewport.rawDims;return this.container.style.left=`${100*(I-st)/nt}%`,this.container.style.top=`${100*(N-at)/tt}%`,this.container.append(a.render()),this.container}};let o=D;Dt(o,"IGNORE_TYPES",new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]));class l{constructor(e){this.container=e.container,this.trigger=e.trigger,this.color=e.color,this.titleObj=e.titleObj,this.modificationDate=e.modificationDate,this.contentsObj=e.contentsObj,this.richText=e.richText,this.hideWrapper=e.hideWrapper||!1,this.pinned=!1}render(){var nt,tt;const a=document.createElement("div");a.classList.add("popupWrapper"),this.hideElement=this.hideWrapper?a:this.container,this.hideElement.hidden=!0;const b=document.createElement("div");b.classList.add("popup");const x=this.color;if(x){const st=.7*(255-x[0])+x[0],at=.7*(255-x[1])+x[1],ut=.7*(255-x[2])+x[2];b.style.backgroundColor=f.Util.makeHexColor(st|0,at|0,ut|0)}const I=document.createElement("h1");I.dir=this.titleObj.dir,I.textContent=this.titleObj.str,b.append(I);const N=S.PDFDateString.toDateObject(this.modificationDate);if(N){const st=document.createElement("span");st.classList.add("popupDate"),st.textContent="{{date}}, {{time}}",st.dataset.l10nId="annotation_date_string",st.dataset.l10nArgs=JSON.stringify({date:N.toLocaleDateString(),time:N.toLocaleTimeString()}),b.append(st)}if((nt=this.richText)!=null&&nt.str&&(!((tt=this.contentsObj)!=null&&tt.str)||this.contentsObj.str===this.richText.str))Q.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:b}),b.lastChild.classList.add("richText","popupContent");else{const st=this._formatContents(this.contentsObj);b.append(st)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const st of this.trigger)st.addEventListener("click",this._toggle.bind(this)),st.addEventListener("mouseover",this._show.bind(this,!1)),st.addEventListener("mouseout",this._hide.bind(this,!1));return b.addEventListener("click",this._hide.bind(this,!0)),a.append(b),a}_formatContents({str:e,dir:a}){const b=document.createElement("p");b.classList.add("popupContent"),b.dir=a;const x=e.split(/(?:\r\n?|\n)/);for(let I=0,N=x.length;I<N;++I){const nt=x[I];b.append(document.createTextNode(nt)),I<N-1&&b.append(document.createElement("br"))}return b}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(e=!1){e&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(e=!0){e&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class s extends A{constructor(e){var b,x,I;const a=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:a,ignoreBorder:!0}),this.textContent=e.data.textContent}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const a of this.textContent){const b=document.createElement("span");b.textContent=a,e.append(b)}this.container.append(e)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class p extends A{constructor(e){var b,x,I;const a=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:a,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:a,height:b}=w(e.rect),x=this.svgFactory.create(a,b,!0),I=this.svgFactory.createElement("svg:line");return I.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),I.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),I.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),I.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),I.setAttribute("stroke-width",e.borderStyle.width||1),I.setAttribute("stroke","transparent"),I.setAttribute("fill","transparent"),x.append(I),this.container.append(x),this._createPopup(I,e),this.container}}class T extends A{constructor(e){var b,x,I;const a=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:a,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:a,height:b}=w(e.rect),x=this.svgFactory.create(a,b,!0),I=e.borderStyle.width,N=this.svgFactory.createElement("svg:rect");return N.setAttribute("x",I/2),N.setAttribute("y",I/2),N.setAttribute("width",a-I),N.setAttribute("height",b-I),N.setAttribute("stroke-width",I||1),N.setAttribute("stroke","transparent"),N.setAttribute("fill","transparent"),x.append(N),this.container.append(x),this._createPopup(N,e),this.container}}class r extends A{constructor(e){var b,x,I;const a=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:a,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:a,height:b}=w(e.rect),x=this.svgFactory.create(a,b,!0),I=e.borderStyle.width,N=this.svgFactory.createElement("svg:ellipse");return N.setAttribute("cx",a/2),N.setAttribute("cy",b/2),N.setAttribute("rx",a/2-I/2),N.setAttribute("ry",b/2-I/2),N.setAttribute("stroke-width",I||1),N.setAttribute("stroke","transparent"),N.setAttribute("fill","transparent"),x.append(N),this.container.append(x),this._createPopup(N,e),this.container}}class O extends A{constructor(e){var b,x,I;const a=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:a,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:a,height:b}=w(e.rect),x=this.svgFactory.create(a,b,!0);let I=[];for(const nt of e.vertices){const tt=nt.x-e.rect[0],st=e.rect[3]-nt.y;I.push(tt+","+st)}I=I.join(" ");const N=this.svgFactory.createElement(this.svgElementName);return N.setAttribute("points",I),N.setAttribute("stroke-width",e.borderStyle.width||1),N.setAttribute("stroke","transparent"),N.setAttribute("fill","transparent"),x.append(N),this.container.append(x),this._createPopup(N,e),this.container}}class X extends O{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Y extends A{constructor(e){var b,x,I;const a=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:a,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class Z extends A{constructor(e){var b,x,I;const a=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:a,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:a,height:b}=w(e.rect),x=this.svgFactory.create(a,b,!0);for(const I of e.inkLists){let N=[];for(const tt of I){const st=tt.x-e.rect[0],at=e.rect[3]-tt.y;N.push(`${st},${at}`)}N=N.join(" ");const nt=this.svgFactory.createElement(this.svgElementName);nt.setAttribute("points",N),nt.setAttribute("stroke-width",e.borderStyle.width||1),nt.setAttribute("stroke","transparent"),nt.setAttribute("fill","transparent"),this._createPopup(nt,e),x.append(nt)}return this.container.append(x),this.container}}class rt extends A{constructor(e){var b,x,I;const a=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:a,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.classList.add("highlightAnnotation"),this.container)}}class ft extends A{constructor(e){var b,x,I;const a=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:a,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.classList.add("underlineAnnotation"),this.container)}}class ot extends A{constructor(e){var b,x,I;const a=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:a,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.classList.add("squigglyAnnotation"),this.container)}}class dt extends A{constructor(e){var b,x,I;const a=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:a,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.classList.add("strikeoutAnnotation"),this.container)}}class bt extends A{constructor(e){var b,x,I;const a=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:a,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class yt extends A{constructor(e){var x;super(e,{isRenderable:!0});const{filename:a,content:b}=this.data.file;this.filename=(0,S.getFilenameFromUrl)(a,!0),this.content=b,(x=this.linkService.eventBus)==null||x.dispatch("fileattachmentannotation",{source:this,filename:a,content:b})}render(){var a,b;this.container.classList.add("fileAttachmentAnnotation");let e;return this.data.hasAppearance?e=document.createElement("div"):(e=document.createElement("img"),e.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),e.classList.add("popupTriggerArea"),e.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((a=this.data.titleObj)!=null&&a.str||(b=this.data.contentsObj)!=null&&b.str||this.data.richText)&&this._createPopup(e,this.data),this.container.append(e),this.container}_download(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.container,this.content,this.filename)}}const L=class{static render(e){var tt,st;const{annotations:a,div:b,viewport:x,accessibilityManager:I}=e;(0,S.setLayerDimensions)(b,x);const N={data:null,layer:b,page:e.page,viewport:x,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new S.DOMSVGFactory,annotationStorage:e.annotationStorage||new G.AnnotationStorage,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects};let nt=0;for(const at of a){if(at.noHTML)continue;if(at.annotationType!==f.AnnotationType.POPUP){const{width:_t,height:pt}=w(at.rect);if(_t<=0||pt<=0)continue}N.data=at;const ut=C.create(N);if(!ut.isRenderable)continue;const ct=ut.render();if(at.hidden&&(ct.style.visibility="hidden"),Array.isArray(ct))for(const _t of ct)_t.style.zIndex=nt++,lt(tt=L,$,we).call(tt,_t,at.id,b,I);else ct.style.zIndex=nt++,ut instanceof o?b.prepend(ct):lt(st=L,$,we).call(st,ct,at.id,b,I)}lt(this,K,ke).call(this,b,e.annotationCanvasMap)}static update(e){const{annotationCanvasMap:a,div:b,viewport:x}=e;(0,S.setLayerDimensions)(b,{rotation:x.rotation}),lt(this,K,ke).call(this,b,a),b.hidden=!1}};let B=L;$=new WeakSet,we=function(e,a,b,x){const I=e.firstChild||e;I.id=`${S.AnnotationPrefix}${a}`,b.append(e),x==null||x.moveElementInDOM(b,e,I,!1)},K=new WeakSet,ke=function(e,a){if(a){for(const[b,x]of a){const I=e.querySelector(`[data-annotation-id="${b}"]`);if(!I)continue;const{firstChild:N}=I;N?N.nodeName==="CANVAS"?N.replaceWith(x):N.before(x):I.append(x)}a.clear()}},et(B,$),et(B,K),c.AnnotationLayer=B},(it,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ColorConverters=void 0;function H(S){return Math.floor(Math.max(0,Math.min(1,S))*255).toString(16).padStart(2,"0")}class f{static CMYK_G([G,V,Q,M]){return["G",1-Math.min(1,.3*G+.59*Q+.11*V+M)]}static G_CMYK([G]){return["CMYK",0,0,0,1-G]}static G_RGB([G]){return["RGB",G,G,G]}static G_HTML([G]){const V=H(G);return`#${V}${V}${V}`}static RGB_G([G,V,Q]){return["G",.3*G+.59*V+.11*Q]}static RGB_HTML([G,V,Q]){const M=H(G),E=H(V),_=H(Q);return`#${M}${E}${_}`}static T_HTML(){return"#00000000"}static CMYK_RGB([G,V,Q,M]){return["RGB",1-Math.min(1,G+M),1-Math.min(1,Q+M),1-Math.min(1,V+M)]}static CMYK_HTML(G){const V=this.CMYK_RGB(G).slice(1);return this.RGB_HTML(V)}static RGB_CMYK([G,V,Q]){const M=1-G,E=1-V,_=1-Q,w=Math.min(M,E,_);return["CMYK",M,E,_,w]}}c.ColorConverters=f},(it,c,H)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.XfaLayer=void 0;var f=H(19);class S{static setupStorage(V,Q,M,E,_){const w=E.getValue(Q,{value:null});switch(M.name){case"textarea":if(w.value!==null&&(V.textContent=w.value),_==="print")break;V.addEventListener("input",C=>{E.setValue(Q,{value:C.target.value})});break;case"input":if(M.attributes.type==="radio"||M.attributes.type==="checkbox"){if(w.value===M.attributes.xfaOn?V.setAttribute("checked",!0):w.value===M.attributes.xfaOff&&V.removeAttribute("checked"),_==="print")break;V.addEventListener("change",C=>{E.setValue(Q,{value:C.target.checked?C.target.getAttribute("xfaOn"):C.target.getAttribute("xfaOff")})})}else{if(w.value!==null&&V.setAttribute("value",w.value),_==="print")break;V.addEventListener("input",C=>{E.setValue(Q,{value:C.target.value})})}break;case"select":if(w.value!==null)for(const C of M.children)C.attributes.value===w.value&&(C.attributes.selected=!0);V.addEventListener("input",C=>{const A=C.target.options,u=A.selectedIndex===-1?"":A[A.selectedIndex].value;E.setValue(Q,{value:u})});break}}static setAttributes({html:V,element:Q,storage:M=null,intent:E,linkService:_}){const{attributes:w}=Q,C=V instanceof HTMLAnchorElement;w.type==="radio"&&(w.name=`${w.name}-${E}`);for(const[A,u]of Object.entries(w))if(u!=null)switch(A){case"class":u.length&&V.setAttribute(A,u.join(" "));break;case"dataId":break;case"id":V.setAttribute("data-element-id",u);break;case"style":Object.assign(V.style,u);break;case"textContent":V.textContent=u;break;default:(!C||A!=="href"&&A!=="newWindow")&&V.setAttribute(A,u)}C&&_.addLinkAttributes(V,w.href,w.newWindow),M&&w.dataId&&this.setupStorage(V,w.dataId,Q,M)}static render(V){var g;const Q=V.annotationStorage,M=V.linkService,E=V.xfaHtml,_=V.intent||"display",w=document.createElement(E.name);E.attributes&&this.setAttributes({html:w,element:E,intent:_,linkService:M});const C=[[E,-1,w]],A=V.div;if(A.append(w),V.viewport){const n=`matrix(${V.viewport.transform.join(",")})`;A.style.transform=n}_!=="richText"&&A.setAttribute("class","xfaLayer xfaFont");const u=[];for(;C.length>0;){const[n,i,P]=C.at(-1);if(i+1===n.children.length){C.pop();continue}const F=n.children[++C.at(-1)[1]];if(F===null)continue;const{name:y}=F;if(y==="#text"){const o=document.createTextNode(F.value);u.push(o),P.append(o);continue}let t;if((g=F==null?void 0:F.attributes)!=null&&g.xmlns?t=document.createElementNS(F.attributes.xmlns,y):t=document.createElement(y),P.append(t),F.attributes&&this.setAttributes({html:t,element:F,storage:Q,intent:_,linkService:M}),F.children&&F.children.length>0)C.push([F,-1,t]);else if(F.value){const o=document.createTextNode(F.value);f.XfaText.shouldBuildText(y)&&u.push(o),t.append(o)}}for(const n of A.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))n.setAttribute("readOnly",!0);return{textDivs:u}}static update(V){const Q=`matrix(${V.viewport.transform.join(",")})`;V.div.style.transform=Q,V.div.hidden=!1}}c.XfaLayer=S},(it,c,H)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SVGGraphics=void 0;var f=H(6),S=H(1),G=H(10);let V=class{constructor(){(0,S.unreachable)("Not implemented: SVGGraphics")}};c.SVGGraphics=V;{let g=function(t){let o=[];const l=[];for(const s of t){if(s.fn==="save"){o.push({fnId:92,fn:"group",items:[]}),l.push(o),o=o.at(-1).items;continue}s.fn==="restore"?o=l.pop():o.push(s)}return o},n=function(t){if(Number.isInteger(t))return t.toString();const o=t.toFixed(10);let l=o.length-1;if(o[l]!=="0")return o;do l--;while(o[l]==="0");return o.substring(0,o[l]==="."?l:l+1)},i=function(t){if(t[4]===0&&t[5]===0){if(t[1]===0&&t[2]===0)return t[0]===1&&t[3]===1?"":`scale(${n(t[0])} ${n(t[3])})`;if(t[0]===t[3]&&t[1]===-t[2]){const o=Math.acos(t[0])*180/Math.PI;return`rotate(${n(o)})`}}else if(t[0]===1&&t[1]===0&&t[2]===0&&t[3]===1)return`translate(${n(t[4])} ${n(t[5])})`;return`matrix(${n(t[0])} ${n(t[1])} ${n(t[2])} ${n(t[3])} ${n(t[4])} ${n(t[5])})`};const Q={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},M="http://www.w3.org/XML/1998/namespace",E="http://www.w3.org/1999/xlink",_=["butt","round","square"],w=["miter","round","bevel"],C=function(t,o="",l=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!l)return URL.createObjectURL(new Blob([t],{type:o}));const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let p=`data:${o};base64,`;for(let T=0,r=t.length;T<r;T+=3){const O=t[T]&255,X=t[T+1]&255,Y=t[T+2]&255,Z=O>>2,rt=(O&3)<<4|X>>4,ft=T+1<r?(X&15)<<2|Y>>6:64,ot=T+2<r?Y&63:64;p+=s[Z]+s[rt]+s[ft]+s[ot]}return p},A=function(){const t=new Uint8Array([137,80,78,71,13,10,26,10]),o=12,l=new Int32Array(256);for(let Y=0;Y<256;Y++){let Z=Y;for(let rt=0;rt<8;rt++)Z&1?Z=3988292384^Z>>1&2147483647:Z=Z>>1&2147483647;l[Y]=Z}function s(Y,Z,rt){let ft=-1;for(let ot=Z;ot<rt;ot++){const dt=(ft^Y[ot])&255,bt=l[dt];ft=ft>>>8^bt}return ft^-1}function p(Y,Z,rt,ft){let ot=ft;const dt=Z.length;rt[ot]=dt>>24&255,rt[ot+1]=dt>>16&255,rt[ot+2]=dt>>8&255,rt[ot+3]=dt&255,ot+=4,rt[ot]=Y.charCodeAt(0)&255,rt[ot+1]=Y.charCodeAt(1)&255,rt[ot+2]=Y.charCodeAt(2)&255,rt[ot+3]=Y.charCodeAt(3)&255,ot+=4,rt.set(Z,ot),ot+=Z.length;const bt=s(rt,ft+4,ot);rt[ot]=bt>>24&255,rt[ot+1]=bt>>16&255,rt[ot+2]=bt>>8&255,rt[ot+3]=bt&255}function T(Y,Z,rt){let ft=1,ot=0;for(let dt=Z;dt<rt;++dt)ft=(ft+(Y[dt]&255))%65521,ot=(ot+ft)%65521;return ot<<16|ft}function r(Y){if(!G.isNodeJS)return O(Y);try{let Z;parseInt(process.versions.node)>=8?Z=Y:Z=Buffer.from(Y);const rt=require$$5.deflateSync(Z,{level:9});return rt instanceof Uint8Array?rt:new Uint8Array(rt)}catch(Z){(0,S.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+Z)}return O(Y)}function O(Y){let Z=Y.length;const rt=65535,ft=Math.ceil(Z/rt),ot=new Uint8Array(2+Z+ft*5+4);let dt=0;ot[dt++]=120,ot[dt++]=156;let bt=0;for(;Z>rt;)ot[dt++]=0,ot[dt++]=255,ot[dt++]=255,ot[dt++]=0,ot[dt++]=0,ot.set(Y.subarray(bt,bt+rt),dt),dt+=rt,bt+=rt,Z-=rt;ot[dt++]=1,ot[dt++]=Z&255,ot[dt++]=Z>>8&255,ot[dt++]=~Z&65535&255,ot[dt++]=(~Z&65535)>>8&255,ot.set(Y.subarray(bt),dt),dt+=Y.length-bt;const yt=T(Y,0,Y.length);return ot[dt++]=yt>>24&255,ot[dt++]=yt>>16&255,ot[dt++]=yt>>8&255,ot[dt++]=yt&255,ot}function X(Y,Z,rt,ft){const ot=Y.width,dt=Y.height;let bt,yt,B;const h=Y.data;switch(Z){case S.ImageKind.GRAYSCALE_1BPP:yt=0,bt=1,B=ot+7>>3;break;case S.ImageKind.RGB_24BPP:yt=2,bt=8,B=ot*3;break;case S.ImageKind.RGBA_32BPP:yt=6,bt=8,B=ot*4;break;default:throw new Error("invalid format")}const d=new Uint8Array((1+B)*dt);let v=0,j=0;for(let L=0;L<dt;++L)d[v++]=0,d.set(h.subarray(j,j+B),v),j+=B,v+=B;if(Z===S.ImageKind.GRAYSCALE_1BPP&&ft){v=0;for(let L=0;L<dt;L++){v++;for(let k=0;k<B;k++)d[v++]^=255}}const D=new Uint8Array([ot>>24&255,ot>>16&255,ot>>8&255,ot&255,dt>>24&255,dt>>16&255,dt>>8&255,dt&255,bt,yt,0,0,0]),$=r(d),q=t.length+o*3+D.length+$.length,K=new Uint8Array(q);let z=0;return K.set(t,z),z+=t.length,p("IHDR",D,K,z),z+=o+D.length,p("IDATA",$,K,z),z+=o+$.length,p("IEND",new Uint8Array(0),K,z),C(K,"image/png",rt)}return function(Z,rt,ft){const ot=Z.kind===void 0?S.ImageKind.GRAYSCALE_1BPP:Z.kind;return X(Z,ot,rt,ft)}}();class u{constructor(){this.fontSizeScale=1,this.fontWeight=Q.fontWeight,this.fontSize=0,this.textMatrix=S.IDENTITY_MATRIX,this.fontMatrix=S.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=S.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=Q.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(o,l){this.x=o,this.y=l}}let P=0,F=0,y=0;c.SVGGraphics=V=class{constructor(t,o,l=!1){(0,f.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new f.DOMSVGFactory,this.current=new u,this.transformMatrix=S.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=t,this.objs=o,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!l,this._operatorIdMapping=[];for(const s in S.OPS)this._operatorIdMapping[S.OPS[s]]=s}getObject(t,o=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):o}save(){this.transformStack.push(this.transformMatrix);const t=this.current;this.extraStack.push(t),this.current=t.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(t){this.save(),this.executeOpTree(t),this.restore()}loadDependencies(t){const o=t.fnArray,l=t.argsArray;for(let s=0,p=o.length;s<p;s++)if(o[s]===S.OPS.dependency)for(const T of l[s]){const r=T.startsWith("g_")?this.commonObjs:this.objs,O=new Promise(X=>{r.get(T,X)});this.current.dependencies.push(O)}return Promise.all(this.current.dependencies)}transform(t,o,l,s,p,T){const r=[t,o,l,s,p,T];this.transformMatrix=S.Util.transform(this.transformMatrix,r),this.tgrp=null}getSVG(t,o){this.viewport=o;const l=this._initialize(o);return this.loadDependencies(t).then(()=>(this.transformMatrix=S.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(t)),l))}convertOpList(t){const o=this._operatorIdMapping,l=t.argsArray,s=t.fnArray,p=[];for(let T=0,r=s.length;T<r;T++){const O=s[T];p.push({fnId:O,fn:o[O],args:l[T]})}return g(p)}executeOpTree(t){for(const o of t){const l=o.fn,s=o.fnId,p=o.args;switch(s|0){case S.OPS.beginText:this.beginText();break;case S.OPS.dependency:break;case S.OPS.setLeading:this.setLeading(p);break;case S.OPS.setLeadingMoveText:this.setLeadingMoveText(p[0],p[1]);break;case S.OPS.setFont:this.setFont(p);break;case S.OPS.showText:this.showText(p[0]);break;case S.OPS.showSpacedText:this.showText(p[0]);break;case S.OPS.endText:this.endText();break;case S.OPS.moveText:this.moveText(p[0],p[1]);break;case S.OPS.setCharSpacing:this.setCharSpacing(p[0]);break;case S.OPS.setWordSpacing:this.setWordSpacing(p[0]);break;case S.OPS.setHScale:this.setHScale(p[0]);break;case S.OPS.setTextMatrix:this.setTextMatrix(p[0],p[1],p[2],p[3],p[4],p[5]);break;case S.OPS.setTextRise:this.setTextRise(p[0]);break;case S.OPS.setTextRenderingMode:this.setTextRenderingMode(p[0]);break;case S.OPS.setLineWidth:this.setLineWidth(p[0]);break;case S.OPS.setLineJoin:this.setLineJoin(p[0]);break;case S.OPS.setLineCap:this.setLineCap(p[0]);break;case S.OPS.setMiterLimit:this.setMiterLimit(p[0]);break;case S.OPS.setFillRGBColor:this.setFillRGBColor(p[0],p[1],p[2]);break;case S.OPS.setStrokeRGBColor:this.setStrokeRGBColor(p[0],p[1],p[2]);break;case S.OPS.setStrokeColorN:this.setStrokeColorN(p);break;case S.OPS.setFillColorN:this.setFillColorN(p);break;case S.OPS.shadingFill:this.shadingFill(p[0]);break;case S.OPS.setDash:this.setDash(p[0],p[1]);break;case S.OPS.setRenderingIntent:this.setRenderingIntent(p[0]);break;case S.OPS.setFlatness:this.setFlatness(p[0]);break;case S.OPS.setGState:this.setGState(p[0]);break;case S.OPS.fill:this.fill();break;case S.OPS.eoFill:this.eoFill();break;case S.OPS.stroke:this.stroke();break;case S.OPS.fillStroke:this.fillStroke();break;case S.OPS.eoFillStroke:this.eoFillStroke();break;case S.OPS.clip:this.clip("nonzero");break;case S.OPS.eoClip:this.clip("evenodd");break;case S.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case S.OPS.paintImageXObject:this.paintImageXObject(p[0]);break;case S.OPS.paintInlineImageXObject:this.paintInlineImageXObject(p[0]);break;case S.OPS.paintImageMaskXObject:this.paintImageMaskXObject(p[0]);break;case S.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(p[0],p[1]);break;case S.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case S.OPS.closePath:this.closePath();break;case S.OPS.closeStroke:this.closeStroke();break;case S.OPS.closeFillStroke:this.closeFillStroke();break;case S.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case S.OPS.nextLine:this.nextLine();break;case S.OPS.transform:this.transform(p[0],p[1],p[2],p[3],p[4],p[5]);break;case S.OPS.constructPath:this.constructPath(p[0],p[1]);break;case S.OPS.endPath:this.endPath();break;case 92:this.group(o.items);break;default:(0,S.warn)(`Unimplemented operator ${l}`);break}}}setWordSpacing(t){this.current.wordSpacing=t}setCharSpacing(t){this.current.charSpacing=t}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(t,o,l,s,p,T){const r=this.current;r.textMatrix=r.lineMatrix=[t,o,l,s,p,T],r.textMatrixScale=Math.hypot(t,o),r.x=r.lineX=0,r.y=r.lineY=0,r.xcoords=[],r.ycoords=[],r.tspan=this.svgFactory.createElement("svg:tspan"),r.tspan.setAttributeNS(null,"font-family",r.fontFamily),r.tspan.setAttributeNS(null,"font-size",`${n(r.fontSize)}px`),r.tspan.setAttributeNS(null,"y",n(-r.y)),r.txtElement=this.svgFactory.createElement("svg:text"),r.txtElement.append(r.tspan)}beginText(){const t=this.current;t.x=t.lineX=0,t.y=t.lineY=0,t.textMatrix=S.IDENTITY_MATRIX,t.lineMatrix=S.IDENTITY_MATRIX,t.textMatrixScale=1,t.tspan=this.svgFactory.createElement("svg:tspan"),t.txtElement=this.svgFactory.createElement("svg:text"),t.txtgrp=this.svgFactory.createElement("svg:g"),t.xcoords=[],t.ycoords=[]}moveText(t,o){const l=this.current;l.x=l.lineX+=t,l.y=l.lineY+=o,l.xcoords=[],l.ycoords=[],l.tspan=this.svgFactory.createElement("svg:tspan"),l.tspan.setAttributeNS(null,"font-family",l.fontFamily),l.tspan.setAttributeNS(null,"font-size",`${n(l.fontSize)}px`),l.tspan.setAttributeNS(null,"y",n(-l.y))}showText(t){const o=this.current,l=o.font,s=o.fontSize;if(s===0)return;const p=o.fontSizeScale,T=o.charSpacing,r=o.wordSpacing,O=o.fontDirection,X=o.textHScale*O,Y=l.vertical,Z=Y?1:-1,rt=l.defaultVMetrics,ft=s*o.fontMatrix[0];let ot=0;for(const yt of t){if(yt===null){ot+=O*r;continue}else if(typeof yt=="number"){ot+=Z*yt*s/1e3;continue}const B=(yt.isSpace?r:0)+T,h=yt.fontChar;let d,v,j=yt.width;if(Y){let $;const q=yt.vmetric||rt;$=yt.vmetric?q[1]:j*.5,$=-$*ft;const K=q[2]*ft;j=q?-q[0]:j,d=$/p,v=(ot+K)/p}else d=ot/p,v=0;(yt.isInFont||l.missingFile)&&(o.xcoords.push(o.x+d),Y&&o.ycoords.push(-o.y+v),o.tspan.textContent+=h);let D;Y?D=j*ft-B*O:D=j*ft+B*O,ot+=D}o.tspan.setAttributeNS(null,"x",o.xcoords.map(n).join(" ")),Y?o.tspan.setAttributeNS(null,"y",o.ycoords.map(n).join(" ")):o.tspan.setAttributeNS(null,"y",n(-o.y)),Y?o.y-=ot:o.x+=ot*X,o.tspan.setAttributeNS(null,"font-family",o.fontFamily),o.tspan.setAttributeNS(null,"font-size",`${n(o.fontSize)}px`),o.fontStyle!==Q.fontStyle&&o.tspan.setAttributeNS(null,"font-style",o.fontStyle),o.fontWeight!==Q.fontWeight&&o.tspan.setAttributeNS(null,"font-weight",o.fontWeight);const dt=o.textRenderingMode&S.TextRenderingMode.FILL_STROKE_MASK;if(dt===S.TextRenderingMode.FILL||dt===S.TextRenderingMode.FILL_STROKE?(o.fillColor!==Q.fillColor&&o.tspan.setAttributeNS(null,"fill",o.fillColor),o.fillAlpha<1&&o.tspan.setAttributeNS(null,"fill-opacity",o.fillAlpha)):o.textRenderingMode===S.TextRenderingMode.ADD_TO_PATH?o.tspan.setAttributeNS(null,"fill","transparent"):o.tspan.setAttributeNS(null,"fill","none"),dt===S.TextRenderingMode.STROKE||dt===S.TextRenderingMode.FILL_STROKE){const yt=1/(o.textMatrixScale||1);this._setStrokeAttributes(o.tspan,yt)}let bt=o.textMatrix;o.textRise!==0&&(bt=bt.slice(),bt[5]+=o.textRise),o.txtElement.setAttributeNS(null,"transform",`${i(bt)} scale(${n(X)}, -1)`),o.txtElement.setAttributeNS(M,"xml:space","preserve"),o.txtElement.append(o.tspan),o.txtgrp.append(o.txtElement),this._ensureTransformGroup().append(o.txtElement)}setLeadingMoveText(t,o){this.setLeading(-o),this.moveText(t,o)}addFontStyle(t){if(!t.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const o=C(t.data,t.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${t.loadedName}"; src: url(${o}); }
`}setFont(t){const o=this.current,l=this.commonObjs.get(t[0]);let s=t[1];o.font=l,this.embedFonts&&!l.missingFile&&!this.embeddedFonts[l.loadedName]&&(this.addFontStyle(l),this.embeddedFonts[l.loadedName]=l),o.fontMatrix=l.fontMatrix||S.FONT_IDENTITY_MATRIX;let p="normal";l.black?p="900":l.bold&&(p="bold");const T=l.italic?"italic":"normal";s<0?(s=-s,o.fontDirection=-1):o.fontDirection=1,o.fontSize=s,o.fontFamily=l.loadedName,o.fontWeight=p,o.fontStyle=T,o.tspan=this.svgFactory.createElement("svg:tspan"),o.tspan.setAttributeNS(null,"y",n(-o.y)),o.xcoords=[],o.ycoords=[]}endText(){var o;const t=this.current;t.textRenderingMode&S.TextRenderingMode.ADD_TO_PATH_FLAG&&((o=t.txtElement)!=null&&o.hasChildNodes())&&(t.element=t.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(t){t>0&&(this.current.lineWidth=t)}setLineCap(t){this.current.lineCap=_[t]}setLineJoin(t){this.current.lineJoin=w[t]}setMiterLimit(t){this.current.miterLimit=t}setStrokeAlpha(t){this.current.strokeAlpha=t}setStrokeRGBColor(t,o,l){this.current.strokeColor=S.Util.makeHexColor(t,o,l)}setFillAlpha(t){this.current.fillAlpha=t}setFillRGBColor(t,o,l){this.current.fillColor=S.Util.makeHexColor(t,o,l),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(t){this.current.strokeColor=this._makeColorN_Pattern(t)}setFillColorN(t){this.current.fillColor=this._makeColorN_Pattern(t)}shadingFill(t){const o=this.viewport.width,l=this.viewport.height,s=S.Util.inverseTransform(this.transformMatrix),p=S.Util.applyTransform([0,0],s),T=S.Util.applyTransform([0,l],s),r=S.Util.applyTransform([o,0],s),O=S.Util.applyTransform([o,l],s),X=Math.min(p[0],T[0],r[0],O[0]),Y=Math.min(p[1],T[1],r[1],O[1]),Z=Math.max(p[0],T[0],r[0],O[0]),rt=Math.max(p[1],T[1],r[1],O[1]),ft=this.svgFactory.createElement("svg:rect");ft.setAttributeNS(null,"x",X),ft.setAttributeNS(null,"y",Y),ft.setAttributeNS(null,"width",Z-X),ft.setAttributeNS(null,"height",rt-Y),ft.setAttributeNS(null,"fill",this._makeShadingPattern(t)),this.current.fillAlpha<1&&ft.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(ft)}_makeColorN_Pattern(t){return t[0]==="TilingPattern"?this._makeTilingPattern(t):this._makeShadingPattern(t)}_makeTilingPattern(t){const o=t[1],l=t[2],s=t[3]||S.IDENTITY_MATRIX,[p,T,r,O]=t[4],X=t[5],Y=t[6],Z=t[7],rt=`shading${y++}`,[ft,ot,dt,bt]=S.Util.normalizeRect([...S.Util.applyTransform([p,T],s),...S.Util.applyTransform([r,O],s)]),[yt,B]=S.Util.singularValueDecompose2dScale(s),h=X*yt,d=Y*B,v=this.svgFactory.createElement("svg:pattern");v.setAttributeNS(null,"id",rt),v.setAttributeNS(null,"patternUnits","userSpaceOnUse"),v.setAttributeNS(null,"width",h),v.setAttributeNS(null,"height",d),v.setAttributeNS(null,"x",`${ft}`),v.setAttributeNS(null,"y",`${ot}`);const j=this.svg,D=this.transformMatrix,$=this.current.fillColor,q=this.current.strokeColor,K=this.svgFactory.create(dt-ft,bt-ot);if(this.svg=K,this.transformMatrix=s,Z===2){const z=S.Util.makeHexColor(...o);this.current.fillColor=z,this.current.strokeColor=z}return this.executeOpTree(this.convertOpList(l)),this.svg=j,this.transformMatrix=D,this.current.fillColor=$,this.current.strokeColor=q,v.append(K.childNodes[0]),this.defs.append(v),`url(#${rt})`}_makeShadingPattern(t){switch(typeof t=="string"&&(t=this.objs.get(t)),t[0]){case"RadialAxial":const o=`shading${y++}`,l=t[3];let s;switch(t[1]){case"axial":const p=t[4],T=t[5];s=this.svgFactory.createElement("svg:linearGradient"),s.setAttributeNS(null,"id",o),s.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),s.setAttributeNS(null,"x1",p[0]),s.setAttributeNS(null,"y1",p[1]),s.setAttributeNS(null,"x2",T[0]),s.setAttributeNS(null,"y2",T[1]);break;case"radial":const r=t[4],O=t[5],X=t[6],Y=t[7];s=this.svgFactory.createElement("svg:radialGradient"),s.setAttributeNS(null,"id",o),s.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),s.setAttributeNS(null,"cx",O[0]),s.setAttributeNS(null,"cy",O[1]),s.setAttributeNS(null,"r",Y),s.setAttributeNS(null,"fx",r[0]),s.setAttributeNS(null,"fy",r[1]),s.setAttributeNS(null,"fr",X);break;default:throw new Error(`Unknown RadialAxial type: ${t[1]}`)}for(const p of l){const T=this.svgFactory.createElement("svg:stop");T.setAttributeNS(null,"offset",p[0]),T.setAttributeNS(null,"stop-color",p[1]),s.append(T)}return this.defs.append(s),`url(#${o})`;case"Mesh":return(0,S.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${t[0]}`)}}setDash(t,o){this.current.dashArray=t,this.current.dashPhase=o}constructPath(t,o){const l=this.current;let s=l.x,p=l.y,T=[],r=0;for(const O of t)switch(O|0){case S.OPS.rectangle:s=o[r++],p=o[r++];const X=o[r++],Y=o[r++],Z=s+X,rt=p+Y;T.push("M",n(s),n(p),"L",n(Z),n(p),"L",n(Z),n(rt),"L",n(s),n(rt),"Z");break;case S.OPS.moveTo:s=o[r++],p=o[r++],T.push("M",n(s),n(p));break;case S.OPS.lineTo:s=o[r++],p=o[r++],T.push("L",n(s),n(p));break;case S.OPS.curveTo:s=o[r+4],p=o[r+5],T.push("C",n(o[r]),n(o[r+1]),n(o[r+2]),n(o[r+3]),n(s),n(p)),r+=6;break;case S.OPS.curveTo2:T.push("C",n(s),n(p),n(o[r]),n(o[r+1]),n(o[r+2]),n(o[r+3])),s=o[r+2],p=o[r+3],r+=4;break;case S.OPS.curveTo3:s=o[r+2],p=o[r+3],T.push("C",n(o[r]),n(o[r+1]),n(s),n(p),n(s),n(p)),r+=4;break;case S.OPS.closePath:T.push("Z");break}T=T.join(" "),l.path&&t.length>0&&t[0]!==S.OPS.rectangle&&t[0]!==S.OPS.moveTo?T=l.path.getAttributeNS(null,"d")+T:(l.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(l.path)),l.path.setAttributeNS(null,"d",T),l.path.setAttributeNS(null,"fill","none"),l.element=l.path,l.setCurrentPoint(s,p)}endPath(){const t=this.current;if(t.path=null,!this.pendingClip)return;if(!t.element){this.pendingClip=null;return}const o=`clippath${P++}`,l=this.svgFactory.createElement("svg:clipPath");l.setAttributeNS(null,"id",o),l.setAttributeNS(null,"transform",i(this.transformMatrix));const s=t.element.cloneNode(!0);if(this.pendingClip==="evenodd"?s.setAttributeNS(null,"clip-rule","evenodd"):s.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,l.append(s),this.defs.append(l),t.activeClipUrl){t.clipGroup=null;for(const p of this.extraStack)p.clipGroup=null;l.setAttributeNS(null,"clip-path",t.activeClipUrl)}t.activeClipUrl=`url(#${o})`,this.tgrp=null}clip(t){this.pendingClip=t}closePath(){const t=this.current;if(t.path){const o=`${t.path.getAttributeNS(null,"d")}Z`;t.path.setAttributeNS(null,"d",o)}}setLeading(t){this.current.leading=-t}setTextRise(t){this.current.textRise=t}setTextRenderingMode(t){this.current.textRenderingMode=t}setHScale(t){this.current.textHScale=t/100}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[o,l]of t)switch(o){case"LW":this.setLineWidth(l);break;case"LC":this.setLineCap(l);break;case"LJ":this.setLineJoin(l);break;case"ML":this.setMiterLimit(l);break;case"D":this.setDash(l[0],l[1]);break;case"RI":this.setRenderingIntent(l);break;case"FL":this.setFlatness(l);break;case"Font":this.setFont(l);break;case"CA":this.setStrokeAlpha(l);break;case"ca":this.setFillAlpha(l);break;default:(0,S.warn)(`Unimplemented graphic state operator ${o}`);break}}fill(){const t=this.current;t.element&&(t.element.setAttributeNS(null,"fill",t.fillColor),t.element.setAttributeNS(null,"fill-opacity",t.fillAlpha),this.endPath())}stroke(){const t=this.current;t.element&&(this._setStrokeAttributes(t.element),t.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(t,o=1){const l=this.current;let s=l.dashArray;o!==1&&s.length>0&&(s=s.map(function(p){return o*p})),t.setAttributeNS(null,"stroke",l.strokeColor),t.setAttributeNS(null,"stroke-opacity",l.strokeAlpha),t.setAttributeNS(null,"stroke-miterlimit",n(l.miterLimit)),t.setAttributeNS(null,"stroke-linecap",l.lineCap),t.setAttributeNS(null,"stroke-linejoin",l.lineJoin),t.setAttributeNS(null,"stroke-width",n(o*l.lineWidth)+"px"),t.setAttributeNS(null,"stroke-dasharray",s.map(n).join(" ")),t.setAttributeNS(null,"stroke-dashoffset",n(o*l.dashPhase)+"px")}eoFill(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const t=this.svgFactory.createElement("svg:rect");t.setAttributeNS(null,"x","0"),t.setAttributeNS(null,"y","0"),t.setAttributeNS(null,"width","1px"),t.setAttributeNS(null,"height","1px"),t.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(t)}paintImageXObject(t){const o=this.getObject(t);if(!o){(0,S.warn)(`Dependent image with object ID ${t} is not ready yet`);return}this.paintInlineImageXObject(o)}paintInlineImageXObject(t,o){const l=t.width,s=t.height,p=A(t,this.forceDataSchema,!!o),T=this.svgFactory.createElement("svg:rect");T.setAttributeNS(null,"x","0"),T.setAttributeNS(null,"y","0"),T.setAttributeNS(null,"width",n(l)),T.setAttributeNS(null,"height",n(s)),this.current.element=T,this.clip("nonzero");const r=this.svgFactory.createElement("svg:image");r.setAttributeNS(E,"xlink:href",p),r.setAttributeNS(null,"x","0"),r.setAttributeNS(null,"y",n(-s)),r.setAttributeNS(null,"width",n(l)+"px"),r.setAttributeNS(null,"height",n(s)+"px"),r.setAttributeNS(null,"transform",`scale(${n(1/l)} ${n(-1/s)})`),o?o.append(r):this._ensureTransformGroup().append(r)}paintImageMaskXObject(t){const o=this.getObject(t.data,t);if(o.bitmap){(0,S.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const l=this.current,s=o.width,p=o.height,T=l.fillColor;l.maskId=`mask${F++}`;const r=this.svgFactory.createElement("svg:mask");r.setAttributeNS(null,"id",l.maskId);const O=this.svgFactory.createElement("svg:rect");O.setAttributeNS(null,"x","0"),O.setAttributeNS(null,"y","0"),O.setAttributeNS(null,"width",n(s)),O.setAttributeNS(null,"height",n(p)),O.setAttributeNS(null,"fill",T),O.setAttributeNS(null,"mask",`url(#${l.maskId})`),this.defs.append(r),this._ensureTransformGroup().append(O),this.paintInlineImageXObject(o,r)}paintFormXObjectBegin(t,o){if(Array.isArray(t)&&t.length===6&&this.transform(t[0],t[1],t[2],t[3],t[4],t[5]),o){const l=o[2]-o[0],s=o[3]-o[1],p=this.svgFactory.createElement("svg:rect");p.setAttributeNS(null,"x",o[0]),p.setAttributeNS(null,"y",o[1]),p.setAttributeNS(null,"width",n(l)),p.setAttributeNS(null,"height",n(s)),this.current.element=p,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(t){const o=this.svgFactory.create(t.width,t.height),l=this.svgFactory.createElement("svg:defs");o.append(l),this.defs=l;const s=this.svgFactory.createElement("svg:g");return s.setAttributeNS(null,"transform",i(t.transform)),o.append(s),this.svg=s,o}_ensureClipGroup(){if(!this.current.clipGroup){const t=this.svgFactory.createElement("svg:g");t.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(t),this.current.clipGroup=t}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",i(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}}],__webpack_module_cache__={};function __w_pdfjs_require__(it){var c=__webpack_module_cache__[it];if(c!==void 0)return c.exports;var H=__webpack_module_cache__[it]={exports:{}};return __webpack_modules__[it](H,H.exports,__w_pdfjs_require__),H.exports}var __webpack_exports__={};return(()=>{var it=__webpack_exports__;Object.defineProperty(it,"__esModule",{value:!0}),Object.defineProperty(it,"AbortException",{enumerable:!0,get:function(){return c.AbortException}}),Object.defineProperty(it,"AnnotationEditorLayer",{enumerable:!0,get:function(){return G.AnnotationEditorLayer}}),Object.defineProperty(it,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return c.AnnotationEditorParamsType}}),Object.defineProperty(it,"AnnotationEditorType",{enumerable:!0,get:function(){return c.AnnotationEditorType}}),Object.defineProperty(it,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return V.AnnotationEditorUIManager}}),Object.defineProperty(it,"AnnotationLayer",{enumerable:!0,get:function(){return Q.AnnotationLayer}}),Object.defineProperty(it,"AnnotationMode",{enumerable:!0,get:function(){return c.AnnotationMode}}),Object.defineProperty(it,"CMapCompressionType",{enumerable:!0,get:function(){return c.CMapCompressionType}}),Object.defineProperty(it,"FeatureTest",{enumerable:!0,get:function(){return c.FeatureTest}}),Object.defineProperty(it,"GlobalWorkerOptions",{enumerable:!0,get:function(){return M.GlobalWorkerOptions}}),Object.defineProperty(it,"InvalidPDFException",{enumerable:!0,get:function(){return c.InvalidPDFException}}),Object.defineProperty(it,"MissingPDFException",{enumerable:!0,get:function(){return c.MissingPDFException}}),Object.defineProperty(it,"OPS",{enumerable:!0,get:function(){return c.OPS}}),Object.defineProperty(it,"PDFDataRangeTransport",{enumerable:!0,get:function(){return H.PDFDataRangeTransport}}),Object.defineProperty(it,"PDFDateString",{enumerable:!0,get:function(){return f.PDFDateString}}),Object.defineProperty(it,"PDFWorker",{enumerable:!0,get:function(){return H.PDFWorker}}),Object.defineProperty(it,"PasswordResponses",{enumerable:!0,get:function(){return c.PasswordResponses}}),Object.defineProperty(it,"PermissionFlag",{enumerable:!0,get:function(){return c.PermissionFlag}}),Object.defineProperty(it,"PixelsPerInch",{enumerable:!0,get:function(){return f.PixelsPerInch}}),Object.defineProperty(it,"RenderingCancelledException",{enumerable:!0,get:function(){return f.RenderingCancelledException}}),Object.defineProperty(it,"SVGGraphics",{enumerable:!0,get:function(){return E.SVGGraphics}}),Object.defineProperty(it,"UnexpectedResponseException",{enumerable:!0,get:function(){return c.UnexpectedResponseException}}),Object.defineProperty(it,"Util",{enumerable:!0,get:function(){return c.Util}}),Object.defineProperty(it,"VerbosityLevel",{enumerable:!0,get:function(){return c.VerbosityLevel}}),Object.defineProperty(it,"XfaLayer",{enumerable:!0,get:function(){return _.XfaLayer}}),Object.defineProperty(it,"build",{enumerable:!0,get:function(){return H.build}}),Object.defineProperty(it,"createPromiseCapability",{enumerable:!0,get:function(){return c.createPromiseCapability}}),Object.defineProperty(it,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return c.createValidAbsoluteUrl}}),Object.defineProperty(it,"getDocument",{enumerable:!0,get:function(){return H.getDocument}}),Object.defineProperty(it,"getFilenameFromUrl",{enumerable:!0,get:function(){return f.getFilenameFromUrl}}),Object.defineProperty(it,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return f.getPdfFilenameFromUrl}}),Object.defineProperty(it,"getXfaPageViewport",{enumerable:!0,get:function(){return f.getXfaPageViewport}}),Object.defineProperty(it,"isDataScheme",{enumerable:!0,get:function(){return f.isDataScheme}}),Object.defineProperty(it,"isPdfFile",{enumerable:!0,get:function(){return f.isPdfFile}}),Object.defineProperty(it,"loadScript",{enumerable:!0,get:function(){return f.loadScript}}),Object.defineProperty(it,"renderTextLayer",{enumerable:!0,get:function(){return S.renderTextLayer}}),Object.defineProperty(it,"setLayerDimensions",{enumerable:!0,get:function(){return f.setLayerDimensions}}),Object.defineProperty(it,"shadow",{enumerable:!0,get:function(){return c.shadow}}),Object.defineProperty(it,"updateTextLayer",{enumerable:!0,get:function(){return S.updateTextLayer}}),Object.defineProperty(it,"version",{enumerable:!0,get:function(){return H.version}});var c=__w_pdfjs_require__(1),H=__w_pdfjs_require__(2),f=__w_pdfjs_require__(6),S=__w_pdfjs_require__(26),G=__w_pdfjs_require__(27),V=__w_pdfjs_require__(5),Q=__w_pdfjs_require__(32),M=__w_pdfjs_require__(14),E=__w_pdfjs_require__(35),_=__w_pdfjs_require__(34)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;const PdfViewer_svelte_svelte_type_style_lang="";function create_fragment$1(it){let c,H;return{c(){c=element("div"),H=element("div"),this.h()},l(f){c=claim_element(f,"DIV",{class:!0});var S=children(c);H=claim_element(S,"DIV",{class:!0,style:!0}),children(H).forEach(detach),S.forEach(detach),this.h()},h(){attr(H,"class","pdf-wrapper svelte-r9i6p1"),set_style(H,"--scale-factor","1.2"),attr(c,"class","pdf-container svelte-r9i6p1")},m(f,S){insert_hydration(f,c,S),append_hydration(c,H),it[2](H)},p:noop,i:noop,o:noop,d(f){f&&detach(c),it[2](null)}}}function instance$1(it,c,H){pdfExports.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.5.141/pdf.worker.min.js";let{url:f=""}=c,S;async function G(M){const E=M.getViewport({scale:1.2}),_=document.createElement("div");_.style.marginBottom="16px",_.style.position="relative",_.id=`page-${M._pageIndex+1}`;const w=document.createElement("canvas"),C=w.getContext("2d");if(!C)return;w.height=E.height,w.width=E.width,_.appendChild(w),S.appendChild(_),M.render({canvasContext:C,viewport:E});const A=document.createElement("div");A.className="textLayer";const u=await M.getTextContent();pdfExports.renderTextLayer({textContentSource:u,viewport:M.getViewport(),container:A}),_.appendChild(A)}let V=!1;onMount(async()=>{const M=await pdfExports.getDocument(f).promise;if(!V)for(let E=1;E<=M.numPages;E++)M.getPage(E).then(G)}),onDestroy(()=>{V=!0});function Q(M){binding_callbacks[M?"unshift":"push"](()=>{S=M,H(0,S)})}return it.$$set=M=>{"url"in M&&H(1,f=M.url)},[S,f,Q]}class PdfViewer extends SvelteComponent{constructor(c){super(),init(this,c,instance$1,create_fragment$1,safe_not_equal,{url:1})}}function create_else_block(it){let c,H,f,S,G,V,Q,M,E,_,w,C,A,u,g;return u=new Button({props:{variant:"primary",$$slots:{default:[create_default_slot_2]},$$scope:{ctx:it}}}),{c(){c=element("div"),H=element("div"),f=element("div"),S=element("span"),G=text("search"),V=space(),Q=element("h2"),M=text("Document Not Found"),E=space(),_=element("p"),w=text("The document you're looking for doesn't exist or has been removed."),C=space(),A=element("a"),create_component(u.$$.fragment),this.h()},l(n){c=claim_element(n,"DIV",{class:!0});var i=children(c);H=claim_element(i,"DIV",{class:!0});var P=children(H);f=claim_element(P,"DIV",{class:!0});var F=children(f);S=claim_element(F,"SPAN",{class:!0});var y=children(S);G=claim_text(y,"search"),y.forEach(detach),F.forEach(detach),V=claim_space(P),Q=claim_element(P,"H2",{class:!0});var t=children(Q);M=claim_text(t,"Document Not Found"),t.forEach(detach),E=claim_space(P),_=claim_element(P,"P",{class:!0});var o=children(_);w=claim_text(o,"The document you're looking for doesn't exist or has been removed."),o.forEach(detach),C=claim_space(P),A=claim_element(P,"A",{href:!0});var l=children(A);claim_component(u.$$.fragment,l),l.forEach(detach),P.forEach(detach),i.forEach(detach),this.h()},h(){attr(S,"class","material-icons text-white text-2xl"),attr(f,"class","w-16 h-16 bg-neutral-500 rounded-2xl flex items-center justify-center mx-auto mb-4"),attr(Q,"class","text-2xl font-semibold text-neutral-800 dark:text-neutral-200 mb-2"),attr(_,"class","text-neutral-600 dark:text-neutral-400 mb-6"),attr(A,"href","/documents"),attr(H,"class","text-center"),attr(c,"class","min-h-screen flex items-center justify-center")},m(n,i){insert_hydration(n,c,i),append_hydration(c,H),append_hydration(H,f),append_hydration(f,S),append_hydration(S,G),append_hydration(H,V),append_hydration(H,Q),append_hydration(Q,M),append_hydration(H,E),append_hydration(H,_),append_hydration(_,w),append_hydration(H,C),append_hydration(H,A),mount_component(u,A,null),g=!0},p(n,i){const P={};i&16&&(P.$$scope={dirty:i,ctx:n}),u.$set(P)},i(n){g||(transition_in(u.$$.fragment,n),g=!0)},o(n){transition_out(u.$$.fragment,n),g=!1},d(n){n&&detach(c),destroy_component(u)}}}function create_if_block_1(it){let c,H,f,S,G,V,Q,M,E,_,w,C,A,u,g,n,i,P=it[1].name+"",F,y,t,o,l=it[1].id+"",s,p,T,r,O,X,Y,Z,rt,ft,ot,dt,bt,yt,B,h,d,v,j,D,$,q,K,z,L;return O=new Button({props:{variant:"secondary",size:"sm",$$slots:{default:[create_default_slot_1]},$$scope:{ctx:it}}}),ft=new ChatPanel({props:{documentId:it[1].id,onSubmit:it[3]}}),z=new PdfViewer({props:{url:it[2]}}),{c(){c=element("div"),H=element("div"),f=element("div"),S=element("div"),G=element("div"),V=element("a"),Q=element("div"),M=element("span"),E=text("arrow_back"),_=space(),w=element("div"),C=element("div"),A=element("span"),u=text("description"),g=space(),n=element("div"),i=element("h1"),F=text(P),y=space(),t=element("p"),o=text("Document ID: "),s=text(l),p=space(),T=element("div"),r=element("a"),create_component(O.$$.fragment),X=space(),Y=element("div"),Z=element("div"),rt=element("div"),create_component(ft.$$.fragment),ot=space(),dt=element("div"),bt=element("div"),yt=element("div"),B=element("div"),h=element("div"),d=element("span"),v=text("picture_as_pdf"),j=space(),D=element("h3"),$=text("PDF Viewer"),q=space(),K=element("div"),create_component(z.$$.fragment),this.h()},l(k){c=claim_element(k,"DIV",{class:!0});var e=children(c);H=claim_element(e,"DIV",{class:!0});var a=children(H);f=claim_element(a,"DIV",{class:!0});var b=children(f);S=claim_element(b,"DIV",{class:!0});var x=children(S);G=claim_element(x,"DIV",{class:!0});var I=children(G);V=claim_element(I,"A",{href:!0,class:!0});var N=children(V);Q=claim_element(N,"DIV",{class:!0});var nt=children(Q);M=claim_element(nt,"SPAN",{class:!0});var tt=children(M);E=claim_text(tt,"arrow_back"),tt.forEach(detach),nt.forEach(detach),N.forEach(detach),_=claim_space(I),w=claim_element(I,"DIV",{class:!0});var st=children(w);C=claim_element(st,"DIV",{class:!0});var at=children(C);A=claim_element(at,"SPAN",{class:!0});var ut=children(A);u=claim_text(ut,"description"),ut.forEach(detach),at.forEach(detach),g=claim_space(st),n=claim_element(st,"DIV",{});var ct=children(n);i=claim_element(ct,"H1",{class:!0});var _t=children(i);F=claim_text(_t,P),_t.forEach(detach),y=claim_space(ct),t=claim_element(ct,"P",{class:!0});var pt=children(t);o=claim_text(pt,"Document ID: "),s=claim_text(pt,l),pt.forEach(detach),ct.forEach(detach),st.forEach(detach),I.forEach(detach),p=claim_space(x),T=claim_element(x,"DIV",{class:!0});var Et=children(T);r=claim_element(Et,"A",{href:!0});var At=children(r);claim_component(O.$$.fragment,At),At.forEach(detach),Et.forEach(detach),x.forEach(detach),b.forEach(detach),a.forEach(detach),X=claim_space(e),Y=claim_element(e,"DIV",{class:!0});var Tt=children(Y);Z=claim_element(Tt,"DIV",{class:!0});var R=children(Z);rt=claim_element(R,"DIV",{class:!0});var U=children(rt);claim_component(ft.$$.fragment,U),U.forEach(detach),ot=claim_space(R),dt=claim_element(R,"DIV",{class:!0});var W=children(dt);bt=claim_element(W,"DIV",{class:!0});var gt=children(bt);yt=claim_element(gt,"DIV",{class:!0});var Ct=children(yt);B=claim_element(Ct,"DIV",{class:!0});var J=children(B);h=claim_element(J,"DIV",{class:!0});var ht=children(h);d=claim_element(ht,"SPAN",{class:!0});var vt=children(d);v=claim_text(vt,"picture_as_pdf"),vt.forEach(detach),ht.forEach(detach),j=claim_space(J),D=claim_element(J,"H3",{class:!0});var St=children(D);$=claim_text(St,"PDF Viewer"),St.forEach(detach),J.forEach(detach),Ct.forEach(detach),q=claim_space(gt),K=claim_element(gt,"DIV",{class:!0});var kt=children(K);claim_component(z.$$.fragment,kt),kt.forEach(detach),gt.forEach(detach),W.forEach(detach),R.forEach(detach),Tt.forEach(detach),e.forEach(detach),this.h()},h(){attr(M,"class","material-icons text-white text-sm"),attr(Q,"class","w-8 h-8 bg-gradient-to-r from-neutral-500 to-neutral-600 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-200"),attr(V,"href","/documents"),attr(V,"class","group"),attr(A,"class","material-icons text-white text-lg"),attr(C,"class","w-10 h-10 bg-gradient-to-r from-primary-500 to-secondary-500 rounded-xl flex items-center justify-center"),attr(i,"class","text-xl font-display font-bold text-neutral-800 dark:text-neutral-200"),attr(t,"class","text-sm text-neutral-600 dark:text-neutral-400"),attr(w,"class","flex items-center space-x-3"),attr(G,"class","flex items-center space-x-4"),attr(r,"href","/chat?document="+it[1].id),attr(T,"class","flex items-center space-x-3"),attr(S,"class","flex items-center justify-between"),attr(f,"class","container mx-auto px-4 py-4"),attr(H,"class","sticky top-0 z-40 glass-effect border-b border-white/20 dark:border-neutral-700/20"),attr(rt,"class","lg:col-span-1"),attr(d,"class","material-icons text-white text-sm"),attr(h,"class","w-6 h-6 bg-gradient-to-r from-accent-500 to-accent-600 rounded-lg flex items-center justify-center"),attr(D,"class","font-semibold text-neutral-800 dark:text-neutral-200"),attr(B,"class","flex items-center space-x-2"),attr(yt,"class","p-4 border-b border-white/20 dark:border-neutral-700/20"),attr(K,"class","flex-1 h-full"),attr(bt,"class","card h-full overflow-hidden"),attr(dt,"class","lg:col-span-2"),attr(Z,"class","grid grid-cols-1 lg:grid-cols-3 gap-6 h-[calc(100vh-140px)]"),attr(Y,"class","container mx-auto px-4 py-6"),attr(c,"class","min-h-screen bg-gradient-to-br from-neutral-50 via-white to-neutral-100 dark:from-neutral-900 dark:via-neutral-800 dark:to-neutral-900")},m(k,e){insert_hydration(k,c,e),append_hydration(c,H),append_hydration(H,f),append_hydration(f,S),append_hydration(S,G),append_hydration(G,V),append_hydration(V,Q),append_hydration(Q,M),append_hydration(M,E),append_hydration(G,_),append_hydration(G,w),append_hydration(w,C),append_hydration(C,A),append_hydration(A,u),append_hydration(w,g),append_hydration(w,n),append_hydration(n,i),append_hydration(i,F),append_hydration(n,y),append_hydration(n,t),append_hydration(t,o),append_hydration(t,s),append_hydration(S,p),append_hydration(S,T),append_hydration(T,r),mount_component(O,r,null),append_hydration(c,X),append_hydration(c,Y),append_hydration(Y,Z),append_hydration(Z,rt),mount_component(ft,rt,null),append_hydration(Z,ot),append_hydration(Z,dt),append_hydration(dt,bt),append_hydration(bt,yt),append_hydration(yt,B),append_hydration(B,h),append_hydration(h,d),append_hydration(d,v),append_hydration(B,j),append_hydration(B,D),append_hydration(D,$),append_hydration(bt,q),append_hydration(bt,K),mount_component(z,K,null),L=!0},p(k,e){const a={};e&16&&(a.$$scope={dirty:e,ctx:k}),O.$set(a)},i(k){L||(transition_in(O.$$.fragment,k),transition_in(ft.$$.fragment,k),transition_in(z.$$.fragment,k),L=!0)},o(k){transition_out(O.$$.fragment,k),transition_out(ft.$$.fragment,k),transition_out(z.$$.fragment,k),L=!1},d(k){k&&detach(c),destroy_component(O),destroy_component(ft),destroy_component(z)}}}function create_if_block(it){let c,H,f,S,G,V,Q,M,E,_,w=it[0].error+"",C,A,u,g,n;return g=new Button({props:{variant:"primary",$$slots:{default:[create_default_slot]},$$scope:{ctx:it}}}),{c(){c=element("div"),H=element("div"),f=element("div"),S=element("span"),G=text("error"),V=space(),Q=element("h2"),M=text("Error Loading Document"),E=space(),_=element("p"),C=text(w),A=space(),u=element("a"),create_component(g.$$.fragment),this.h()},l(i){c=claim_element(i,"DIV",{class:!0});var P=children(c);H=claim_element(P,"DIV",{class:!0});var F=children(H);f=claim_element(F,"DIV",{class:!0});var y=children(f);S=claim_element(y,"SPAN",{class:!0});var t=children(S);G=claim_text(t,"error"),t.forEach(detach),y.forEach(detach),V=claim_space(F),Q=claim_element(F,"H2",{class:!0});var o=children(Q);M=claim_text(o,"Error Loading Document"),o.forEach(detach),E=claim_space(F),_=claim_element(F,"P",{class:!0});var l=children(_);C=claim_text(l,w),l.forEach(detach),A=claim_space(F),u=claim_element(F,"A",{href:!0});var s=children(u);claim_component(g.$$.fragment,s),s.forEach(detach),F.forEach(detach),P.forEach(detach),this.h()},h(){attr(S,"class","material-icons text-white text-2xl"),attr(f,"class","w-16 h-16 bg-red-500 rounded-2xl flex items-center justify-center mx-auto mb-4"),attr(Q,"class","text-2xl font-semibold text-neutral-800 dark:text-neutral-200 mb-2"),attr(_,"class","text-neutral-600 dark:text-neutral-400 mb-6"),attr(u,"href","/documents"),attr(H,"class","text-center"),attr(c,"class","min-h-screen flex items-center justify-center")},m(i,P){insert_hydration(i,c,P),append_hydration(c,H),append_hydration(H,f),append_hydration(f,S),append_hydration(S,G),append_hydration(H,V),append_hydration(H,Q),append_hydration(Q,M),append_hydration(H,E),append_hydration(H,_),append_hydration(_,C),append_hydration(H,A),append_hydration(H,u),mount_component(g,u,null),n=!0},p(i,P){(!n||P&1)&&w!==(w=i[0].error+"")&&set_data(C,w);const F={};P&16&&(F.$$scope={dirty:P,ctx:i}),g.$set(F)},i(i){n||(transition_in(g.$$.fragment,i),n=!0)},o(i){transition_out(g.$$.fragment,i),n=!1},d(i){i&&detach(c),destroy_component(g)}}}function create_default_slot_2(it){let c,H,f;return{c(){c=element("span"),H=text("arrow_back"),f=text(`\r
					Back to Documents`),this.h()},l(S){c=claim_element(S,"SPAN",{class:!0});var G=children(c);H=claim_text(G,"arrow_back"),G.forEach(detach),f=claim_text(S,`\r
					Back to Documents`),this.h()},h(){attr(c,"class","material-icons mr-2")},m(S,G){insert_hydration(S,c,G),append_hydration(c,H),insert_hydration(S,f,G)},p:noop,d(S){S&&detach(c),S&&detach(f)}}}function create_default_slot_1(it){let c,H,f;return{c(){c=element("span"),H=text("chat"),f=text(`\r
								Chat`),this.h()},l(S){c=claim_element(S,"SPAN",{class:!0});var G=children(c);H=claim_text(G,"chat"),G.forEach(detach),f=claim_text(S,`\r
								Chat`),this.h()},h(){attr(c,"class","material-icons text-sm mr-1")},m(S,G){insert_hydration(S,c,G),append_hydration(c,H),insert_hydration(S,f,G)},p:noop,d(S){S&&detach(c),S&&detach(f)}}}function create_default_slot(it){let c,H,f;return{c(){c=element("span"),H=text("arrow_back"),f=text(`\r
					Back to Documents`),this.h()},l(S){c=claim_element(S,"SPAN",{class:!0});var G=children(c);H=claim_text(G,"arrow_back"),G.forEach(detach),f=claim_text(S,`\r
					Back to Documents`),this.h()},h(){attr(c,"class","material-icons mr-2")},m(S,G){insert_hydration(S,c,G),append_hydration(c,H),insert_hydration(S,f,G)},p:noop,d(S){S&&detach(c),S&&detach(f)}}}function create_fragment(it){let c,H,f,S;const G=[create_if_block,create_if_block_1,create_else_block],V=[];function Q(M,E){return M[0].error?0:M[1]?1:2}return c=Q(it),H=V[c]=G[c](it),{c(){H.c(),f=empty()},l(M){H.l(M),f=empty()},m(M,E){V[c].m(M,E),insert_hydration(M,f,E),S=!0},p(M,[E]){let _=c;c=Q(M),c===_?V[c].p(M,E):(group_outros(),transition_out(V[_],1,1,()=>{V[_]=null}),check_outros(),H=V[c],H?H.p(M,E):(H=V[c]=G[c](M),H.c()),transition_in(H,1),H.m(f.parentNode,f))},i(M){S||(transition_in(H),S=!0)},o(M){transition_out(H),S=!1},d(M){V[c].d(M),M&&detach(f)}}}function instance(it,c,H){let{data:f}=c;const S=f.document,G=f.documentUrl;function V(Q,M){sendMessage({role:"user",content:Q},{useStreaming:M,documentId:S.id})}return beforeNavigate(resetAll),it.$$set=Q=>{"data"in Q&&H(0,f=Q.data)},[f,S,G,V]}class Page extends SvelteComponent{constructor(c){super(),init(this,c,instance,create_fragment,safe_not_equal,{data:0})}}export{Page as default};
